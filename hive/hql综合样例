create external table IF NOT EXISTS tdl_mro_basetable_${seq_id} (
omc_id string,
vendor_id int,
reporttime string,
starttime string,
endtime string,
userlabel string,
mmecode string,
mmegroupid string,
mmeues1apid string,
enb_id int,
cid int,
time_stamp string,
m_int_id bigint,
ltescrsrp int,
ltescrsrq int,
ltescearfcn int,
ltescpci int,
ltescrttd int,
ltesctadv int,
ltescphr int,
ltescrip int,
ltescaoa int,
ltescplrulqci1 int,
ltescplrulqci2 int,
ltescplrulqci3 int,
ltescplrulqci4 int,
ltescplrulqci5 int,
ltescplrulqci6 int,
ltescplrulqci7 int,
ltescplrulqci8 int,
ltescplrulqci9 int,
ltescplrdlqci1 int,
ltescplrdlqci2 int,
ltescplrdlqci3 int,
ltescplrdlqci4 int,
ltescplrdlqci5 int,
ltescplrdlqci6 int,
ltescplrdlqci7 int,
ltescplrdlqci8 int,
ltescplrdlqci9 int,
ltescsinrul int,
ltescri1 int,
ltescri2 int,
ltescri4 int,
ltescri8 int,
ltescpuschprbnum int,
ltescpdschprbnum int,
ltescbsr int,
ltescenbrxtxtimediff int,
scfreq_type int,
n_int_id bigint,
n_enb_id int,
n_cid int,
ltencrsrp int,
ltencrsrq int,
ltencearfcn int,
ltencpci int,
gsmncellbcch int,
gsmncellcarrierrssi int,
gsmncellncc int,
gsmncellbcc int,
tdspccpchrscp int,
tdsncelluarfcn int,
tdscellparameterid int,
overlap_condi1 int,
overlap_condi2 int,
is_nrsrp_threshold int,
is_effective int,
ncfreq_type int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_basetable';

create external table IF NOT EXISTS tdl_mro_grid_ue_${seq_id} (
uuid string,
omc_id string,
vendor_id int,
reporttime string,
starttime string,
endtime string,
userlabel string,
mmecode string,
mmegroupid string,
mmeues1apid string,
time_stamp string,
enodebid int,
celllocalid int,
m_int_id bigint,
grid_id1 string,
latitude_gridld1 float,
longitude_gridld1 float,
latitude_gridru1 float,
longitude_gridru1 float,
latitude_gridrd1 float,
longitude_gridrd1 float,
latitude_gridlu1 float,
longitude_gridlu1 float,
geohash1 string,
grid_id2 string,
latitude_gridld2 float,
longitude_gridld2 float,
latitude_gridru2 float,
longitude_gridru2 float,
latitude_gridrd2 float,
longitude_gridrd2 float,
latitude_gridlu2 float,
longitude_gridlu2 float,
geohash2 string,
grid_id3 string,
latitude_gridld3 float,
longitude_gridld3 float,
latitude_gridru3 float,
longitude_gridru3 float,
latitude_gridrd3 float,
longitude_gridrd3 float,
latitude_gridlu3 float,
longitude_gridlu3 float,
geohash3 string,
grid_id4 string,
latitude_gridld4 float,
longitude_gridld4 float,
latitude_gridru4 float,
longitude_gridru4 float,
latitude_gridrd4 float,
longitude_gridrd4 float,
latitude_gridlu4 float,
longitude_gridlu4 float,
geohash4 string,
grid_id5 string,
latitude_gridld5 float,
longitude_gridld5 float,
latitude_gridru5 float,
longitude_gridru5 float,
latitude_gridrd5 float,
longitude_gridrd5 float,
latitude_gridlu5 float,
longitude_gridlu5 float,
geohash5 string,
grid_id6 string,
latitude_gridld6 float,
longitude_gridld6 float,
latitude_gridru6 float,
longitude_gridru6 float,
latitude_gridrd6 float,
longitude_gridrd6 float,
latitude_gridlu6 float,
longitude_gridlu6 float,
geohash6 string,
grid_id7 string,
latitude_gridld7 float,
longitude_gridld7 float,
latitude_gridru7 float,
longitude_gridru7 float,
latitude_gridrd7 float,
longitude_gridrd7 float,
latitude_gridlu7 float,
longitude_gridlu7 float,
geohash7 string,
grid_id8 string,
latitude_gridld8 float,
longitude_gridld8 float,
latitude_gridru8 float,
longitude_gridru8 float,
latitude_gridrd8 float,
longitude_gridrd8 float,
latitude_gridlu8 float,
longitude_gridlu8 float,
geohash8 string,
latitude float,
longitude float,
user_type int,
locate_category int,
ltescrsrp int,
ltescrsrq int,
ltesctadv int,
ltescaoa int,
ltescearfcn int,
ltescpci int,
ltescsinrul int,
ltescphr int,
maxrsrp int,
max_rsrp_earfcn int,
max_rsrp_pci int,
un_maxrsrp int,
un_max_rsrp_earfcn int,
un_max_rsrp_pci int,
te_maxrsrp int,
te_max_rsrp_earfcn int,
te_max_rsrp_pci int,
diff_6_num int,
diff_10_num int,
rsrp1 int,
ltencearfcn1 int,
ltencpci1 int,
rsrp2 int,
ltencearfcn2 int,
ltencpci2 int,
rsrp3 int,
ltencearfcn3 int,
ltencpci3 int,
rsrp4 int,
ltencearfcn4 int,
ltencpci4 int,
rsrp5 int,
ltencearfcn5 int,
ltencpci5 int,
rsrp6 int,
ltencearfcn6 int,
ltencpci6 int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_grid_ue';

create external table IF NOT EXISTS tdl_mro_maxrsrp_eutr_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
enb_id int,
m_celllocalid int,
maxrsrp_0 int,
maxrsrp_1 int,
maxrsrp_2 int,
maxrsrp_3 int,
maxrsrp_4 int,
maxrsrp_5 int,
maxrsrp_6 int,
maxrsrp_7 int,
maxrsrp_8 int,
maxrsrp_9 int,
maxrsrp_10 int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_maxrsrp_eutr';

create external table IF NOT EXISTS tdl_mro_rsrpdiff_eutr_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
enb_id int,
m_celllocalid int,
rsrpdiff_0 int,
rsrpdiff_1 int,
rsrpdiff_2 int,
rsrpdiff_3 int,
rsrpdiff_4 int,
rsrpdiff_5 int,
rsrpdiff_6 int,
rsrpdiff_7 int,
rsrpdiff_8 int,
rsrpdiff_9 int,
rsrpdiff_10 int,
rsrpdiff_11 int,
rsrpdiff_12 int,
rsrpdiff_13 int,
rsrpdiff_14 int,
rsrpdiff_15 int,
rsrpdiff_16 int,
rsrpdiff_17 int,
rsrpdiff_18 int,
rsrpdiff_19 int,
rsrpdiff_20 int,
rsrpdiff_21 int,
rsrpdiff_22 int,
rsrpdiff_23 int,
rsrpdiff_24 int,
rsrpdiff_25 int,
rsrpdiff_26 int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_rsrpdiff_eutr';

create external table IF NOT EXISTS tdl_mro_overlap_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
enb_id int,
m_celllocalid int,
diffdbm_0 int,
diffdbm_1 int,
diffdbm_2 int,
diffdbm_3 int,
diffdbm_4 int,
diffdbm_5 int,
diffdbm_6 int,
diffdbm_7 int,
diffdbm_8 int,
diffdbm_9 int,
diffdbm_10 int,
diffdbm_11 int,
diffdbm_12 int,
diffdbm_13 int,
diffdbm_14 int,
diffdbm_15 int,
diffdbm_16 int,
diffdbm_17 int,
diffdbm_18 int,
diffdbm_19 int,
diffdbm_20 int,
diffdbm_21 int,
diffdbm_22 int,
diffdbm_23 int,
diffdbm_24 int,
diffdbm_25 int,
diffdbm_26 int,
diffdbm_27 int,
diffdbm_28 int,
diffdbm_29 int,
diffdbm_30 int,
diffdbm_31 int,
diffdbm_32 int,
diffdbm_33 int,
diffdbm_34 int,
diffdbm_35 int,
diffdbm_36 int,
diffdbm_37 int,
diffdbm_38 int,
diffdbm_39 int,
diffdbm_40 int,
diffdbm_41 int,
diffdbm_42 int
) partitioned by (omcpart STRING,datepart STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_overlap';

create external table IF NOT EXISTS tdl_mro_numofadj_eutr_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
name string,
enb_id int,
celllocalid int,
num0diff0 int,
num1diff0 int,
num2diff0 int,
num3diff0 int,
num4diff0 int,
num5diff0 int,
num6diff0 int,
num7diff0 int,
num8diff0 int,
num9diff0 int,
num10diff0 int,
num11diff0 int,
num12diff0 int,
num13diff0 int,
num14diff0 int,
num15diff0 int,
num16diff0 int,
num17diff0 int,
num18diff0 int,
num19diff0 int,
num20diff0 int,
num0diff1 int,
num1diff1 int,
num2diff1 int,
num3diff1 int,
num4diff1 int,
num5diff1 int,
num6diff1 int,
num7diff1 int,
num8diff1 int,
num9diff1 int,
num10diff1 int,
num11diff1 int,
num12diff1 int,
num13diff1 int,
num14diff1 int,
num15diff1 int,
num16diff1 int,
num17diff1 int,
num18diff1 int,
num19diff1 int,
num20diff1 int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_numofadj_eutr';

create external table IF NOT EXISTS tdl_mro_numofadj_freq_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
name string,
enb_id int,
celllocalid int,
freqtype int,
num0diff0 int,
num1diff0 int,
num2diff0 int,
num3diff0 int,
num4diff0 int,
num5diff0 int,
num6diff0 int,
num7diff0 int,
num8diff0 int,
num9diff0 int,
num10diff0 int,
num11diff0 int,
num12diff0 int,
num13diff0 int,
num14diff0 int,
num15diff0 int,
num16diff0 int,
num17diff0 int,
num18diff0 int,
num19diff0 int,
num20diff0 int,
num0diff1 int,
num1diff1 int,
num2diff1 int,
num3diff1 int,
num4diff1 int,
num5diff1 int,
num6diff1 int,
num7diff1 int,
num8diff1 int,
num9diff1 int,
num10diff1 int,
num11diff1 int,
num12diff1 int,
num13diff1 int,
num14diff1 int,
num15diff1 int,
num16diff1 int,
num17diff1 int,
num18diff1 int,
num19diff1 int,
num20diff1 int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_numofadj_freq';

create external table IF NOT EXISTS tdl_mro_numofadj_freqband_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
name string,
enb_id int,
celllocalid int,
freqtype int,
num0diff0 int,
num1diff0 int,
num2diff0 int,
num3diff0 int,
num4diff0 int,
num5diff0 int,
num6diff0 int,
num7diff0 int,
num8diff0 int,
num9diff0 int,
num10diff0 int,
num11diff0 int,
num12diff0 int,
num13diff0 int,
num14diff0 int,
num15diff0 int,
num16diff0 int,
num17diff0 int,
num18diff0 int,
num19diff0 int,
num20diff0 int,
num0diff1 int,
num1diff1 int,
num2diff1 int,
num3diff1 int,
num4diff1 int,
num5diff1 int,
num6diff1 int,
num7diff1 int,
num8diff1 int,
num9diff1 int,
num10diff1 int,
num11diff1 int,
num12diff1 int,
num13diff1 int,
num14diff1 int,
num15diff1 int,
num16diff1 int,
num17diff1 int,
num18diff1 int,
num19diff1 int,
num20diff1 int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_numofadj_freqband';

create external table IF NOT EXISTS tdl_mro_rsrp_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
enb_id int,
eutrancell_id int,
rsrp_0 int,
rsrp_1 int,
rsrp_2 int,
rsrp_3 int,
rsrp_4 int,
rsrp_5 int,
rsrp_6 int,
rsrp_7 int,
rsrp_8 int,
rsrp_9 int,
rsrp_10 int,
rsrp_11 int,
rsrp_sum float,
rsrp_count int,
rsrp_avg float,
rsrp_lt_f110 int,
rsrp_lt_f113 int,
rsrp_lt_f115 int,
un_maxrsrp_0 int,
un_maxrsrp_1 int,
un_maxrsrp_2 int,
un_maxrsrp_3 int,
un_maxrsrp_4 int,
un_maxrsrp_5 int,
un_maxrsrp_6 int,
un_maxrsrp_7 int,
un_maxrsrp_8 int,
un_maxrsrp_9 int,
un_maxrsrp_10 int,
un_maxrsrp_11 int,
un_maxrsrp_sum float,
un_maxrsrp_count int,
un_maxrsrp_avg float,
un_maxrsrp_lt_f110 int,
un_maxrsrp_f113 int,
un_maxrsrp_f115 int,
te_maxrsrp_0 int,
te_maxrsrp_1 int,
te_maxrsrp_2 int,
te_maxrsrp_3 int,
te_maxrsrp_4 int,
te_maxrsrp_5 int,
te_maxrsrp_6 int,
te_maxrsrp_7 int,
te_maxrsrp_8 int,
te_maxrsrp_9 int,
te_maxrsrp_10 int,
te_maxrsrp_11 int,
te_maxrsrp_sum float,
te_maxrsrp_count int,
te_maxrsrp_avg float,
te_maxrsrp_lt_f110 int,
te_maxrsrp_f113 int,
te_maxrsrp_f115 int,
inter_maxrsrp_0 int,
inter_maxrsrp_1 int,
inter_maxrsrp_2 int,
inter_maxrsrp_3 int,
inter_maxrsrp_4 int,
inter_maxrsrp_5 int,
inter_maxrsrp_6 int,
inter_maxrsrp_7 int,
inter_maxrsrp_8 int,
inter_maxrsrp_9 int,
inter_maxrsrp_10 int,
inter_maxrsrp_11 int,
inter_maxrsrp_sum float,
inter_maxrsrp_count int,
inter_maxrsrp_avg float,
inter_maxrsrp_lt_f110 int,
inter_maxrsrp_f113 int,
inter_maxrsrp_f115 int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_rsrp';

create external table IF NOT EXISTS tdl_mro_rip_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
enb_id int,
eutrancell_id int,
rip_00 int,
rip_01 int,
rip_02 int,
rip_03 int,
rip_04 int,
rip_05 int,
rip_06 int,
rip_07 int,
rip_08 int,
rip_09 int,
rip_10 int,
rip_11 int,
rip_12 int,
rip_13 int,
rip_14 int,
rip_15 int,
rip_16 int,
rip_17 int,
rip_18 int,
rip_19 int,
rip_20 int,
rip_21 int,
rip_22 int,
rip_23 int,
rip_24 int,
rip_25 int,
rip_26 int,
rip_27 int,
rip_28 int,
rip_29 int,
rip_30 int,
rip_31 int,
rip_32 int,
rip_33 int,
rip_34 int,
rip_35 int,
rip_36 int,
rip_37 int,
rip_38 int,
rip_39 int,
rip_40 int,
rip_41 int,
rip_42 int,
rip_43 int,
rip_44 int,
rip_45 int,
rip_46 int,
rip_47 int,
rip_48 int,
rip_49 int,
rip_50 int,
rip_51 int,
rip_52 int,
rip_53 int,
rip_54 int,
rip_55 int,
rip_56 int,
rip_57 int,
rip_58 int,
rip_59 int,
rip_60 int,
rip_61 int,
rip_62 int,
rip_63 int,
rip_64 int,
rip_65 int,
rip_66 int,
rip_67 int,
rip_68 int,
rip_69 int,
rip_70 int,
rip_71 int,
rip_72 int,
rip_73 int,
rip_74 int,
rip_75 int,
rip_76 int,
rip_77 int,
rip_78 int,
rip_79 int,
rip_80 int,
rip_81 int,
rip_82 int,
rip_83 int,
rip_84 int,
rip_85 int,
rip_86 int,
rip_87 int,
rip_88 int,
rip_89 int,
rip_90 int,
rip_91 int,
rip_92 int,
rip_93 int,
rip_94 int,
rip_95 int,
rip_96 int,
rip_97 int,
rip_98 int,
rip_99 int,
rip_100 int,
rip_101 int,
rip_102 int,
rip_103 int,
rip_sum float,
rip_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_rip';

create external table IF NOT EXISTS tdl_mro_sinrul_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
enb_id int,
eutrancell_id int,
sinrul_00 int,
sinrul_01 int,
sinrul_02 int,
sinrul_03 int,
sinrul_04 int,
sinrul_05 int,
sinrul_06 int,
sinrul_07 int,
sinrul_08 int,
sinrul_09 int,
sinrul_10 int,
sinrul_11 int,
sinrul_12 int,
sinrul_13 int,
sinrul_14 int,
sinrul_15 int,
sinrul_16 int,
sinrul_17 int,
sinrul_18 int,
sinrul_19 int,
sinrul_20 int,
sinrul_21 int,
sinrul_22 int,
sinrul_23 int,
sinrul_24 int,
sinrul_25 int,
sinrul_26 int,
sinrul_27 int,
sinrul_28 int,
sinrul_29 int,
sinrul_30 int,
sinrul_31 int,
sinrul_32 int,
sinrul_33 int,
sinrul_34 int,
sinrul_35 int,
sinrul_36 int,
sinrul_sum float,
sinrul_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_sinrul';

create external table IF NOT EXISTS tdl_mro_aoa_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
related_enodeb bigint,
enodeb_name string,
enb_id int,
eutrancell_id int,
aoa_000 int,
aoa_001 int,
aoa_002 int,
aoa_003 int,
aoa_004 int,
aoa_005 int,
aoa_006 int,
aoa_007 int,
aoa_008 int,
aoa_009 int,
aoa_010 int,
aoa_011 int,
aoa_012 int,
aoa_013 int,
aoa_014 int,
aoa_015 int,
aoa_016 int,
aoa_017 int,
aoa_018 int,
aoa_019 int,
aoa_020 int,
aoa_021 int,
aoa_022 int,
aoa_023 int,
aoa_024 int,
aoa_025 int,
aoa_026 int,
aoa_027 int,
aoa_028 int,
aoa_029 int,
aoa_030 int,
aoa_031 int,
aoa_032 int,
aoa_033 int,
aoa_034 int,
aoa_035 int,
aoa_036 int,
aoa_037 int,
aoa_038 int,
aoa_039 int,
aoa_040 int,
aoa_041 int,
aoa_042 int,
aoa_043 int,
aoa_044 int,
aoa_045 int,
aoa_046 int,
aoa_047 int,
aoa_048 int,
aoa_049 int,
aoa_050 int,
aoa_051 int,
aoa_052 int,
aoa_053 int,
aoa_054 int,
aoa_055 int,
aoa_056 int,
aoa_057 int,
aoa_058 int,
aoa_059 int,
aoa_060 int,
aoa_061 int,
aoa_062 int,
aoa_063 int,
aoa_064 int,
aoa_065 int,
aoa_066 int,
aoa_067 int,
aoa_068 int,
aoa_069 int,
aoa_070 int,
aoa_071 int,
aoa_072 int,
aoa_073 int,
aoa_074 int,
aoa_075 int,
aoa_076 int,
aoa_077 int,
aoa_078 int,
aoa_079 int,
aoa_080 int,
aoa_081 int,
aoa_082 int,
aoa_083 int,
aoa_084 int,
aoa_085 int,
aoa_086 int,
aoa_087 int,
aoa_088 int,
aoa_089 int,
aoa_090 int,
aoa_091 int,
aoa_092 int,
aoa_093 int,
aoa_094 int,
aoa_095 int,
aoa_096 int,
aoa_097 int,
aoa_098 int,
aoa_099 int,
aoa_100 int,
aoa_101 int,
aoa_102 int,
aoa_103 int,
aoa_104 int,
aoa_105 int,
aoa_106 int,
aoa_107 int,
aoa_108 int,
aoa_109 int,
aoa_110 int,
aoa_111 int,
aoa_112 int,
aoa_113 int,
aoa_114 int,
aoa_115 int,
aoa_116 int,
aoa_117 int,
aoa_118 int,
aoa_119 int,
aoa_120 int,
aoa_121 int,
aoa_122 int,
aoa_123 int,
aoa_124 int,
aoa_125 int,
aoa_126 int,
aoa_127 int,
aoa_128 int,
aoa_129 int,
aoa_130 int,
aoa_131 int,
aoa_132 int,
aoa_133 int,
aoa_134 int,
aoa_135 int,
aoa_136 int,
aoa_137 int,
aoa_138 int,
aoa_139 int,
aoa_140 int,
aoa_141 int,
aoa_142 int,
aoa_143 int,
aoa_144 int,
aoa_145 int,
aoa_146 int,
aoa_147 int,
aoa_148 int,
aoa_149 int,
aoa_150 int,
aoa_151 int,
aoa_152 int,
aoa_153 int,
aoa_154 int,
aoa_155 int,
aoa_156 int,
aoa_157 int,
aoa_158 int,
aoa_159 int,
aoa_160 int,
aoa_161 int,
aoa_162 int,
aoa_163 int,
aoa_164 int,
aoa_165 int,
aoa_166 int,
aoa_167 int,
aoa_168 int,
aoa_169 int,
aoa_170 int,
aoa_171 int,
aoa_172 int,
aoa_173 int,
aoa_174 int,
aoa_175 int,
aoa_176 int,
aoa_177 int,
aoa_178 int,
aoa_179 int,
aoa_180 int,
aoa_181 int,
aoa_182 int,
aoa_183 int,
aoa_184 int,
aoa_185 int,
aoa_186 int,
aoa_187 int,
aoa_188 int,
aoa_189 int,
aoa_190 int,
aoa_191 int,
aoa_192 int,
aoa_193 int,
aoa_194 int,
aoa_195 int,
aoa_196 int,
aoa_197 int,
aoa_198 int,
aoa_199 int,
aoa_200 int,
aoa_201 int,
aoa_202 int,
aoa_203 int,
aoa_204 int,
aoa_205 int,
aoa_206 int,
aoa_207 int,
aoa_208 int,
aoa_209 int,
aoa_210 int,
aoa_211 int,
aoa_212 int,
aoa_213 int,
aoa_214 int,
aoa_215 int,
aoa_216 int,
aoa_217 int,
aoa_218 int,
aoa_219 int,
aoa_220 int,
aoa_221 int,
aoa_222 int,
aoa_223 int,
aoa_224 int,
aoa_225 int,
aoa_226 int,
aoa_227 int,
aoa_228 int,
aoa_229 int,
aoa_230 int,
aoa_231 int,
aoa_232 int,
aoa_233 int,
aoa_234 int,
aoa_235 int,
aoa_236 int,
aoa_237 int,
aoa_238 int,
aoa_239 int,
aoa_240 int,
aoa_241 int,
aoa_242 int,
aoa_243 int,
aoa_244 int,
aoa_245 int,
aoa_246 int,
aoa_247 int,
aoa_248 int,
aoa_249 int,
aoa_250 int,
aoa_251 int,
aoa_252 int,
aoa_253 int,
aoa_254 int,
aoa_255 int,
aoa_256 int,
aoa_257 int,
aoa_258 int,
aoa_259 int,
aoa_260 int,
aoa_261 int,
aoa_262 int,
aoa_263 int,
aoa_264 int,
aoa_265 int,
aoa_266 int,
aoa_267 int,
aoa_268 int,
aoa_269 int,
aoa_270 int,
aoa_271 int,
aoa_272 int,
aoa_273 int,
aoa_274 int,
aoa_275 int,
aoa_276 int,
aoa_277 int,
aoa_278 int,
aoa_279 int,
aoa_280 int,
aoa_281 int,
aoa_282 int,
aoa_283 int,
aoa_284 int,
aoa_285 int,
aoa_286 int,
aoa_287 int,
aoa_288 int,
aoa_289 int,
aoa_290 int,
aoa_291 int,
aoa_292 int,
aoa_293 int,
aoa_294 int,
aoa_295 int,
aoa_296 int,
aoa_297 int,
aoa_298 int,
aoa_299 int,
aoa_300 int,
aoa_301 int,
aoa_302 int,
aoa_303 int,
aoa_304 int,
aoa_305 int,
aoa_306 int,
aoa_307 int,
aoa_308 int,
aoa_309 int,
aoa_310 int,
aoa_311 int,
aoa_312 int,
aoa_313 int,
aoa_314 int,
aoa_315 int,
aoa_316 int,
aoa_317 int,
aoa_318 int,
aoa_319 int,
aoa_320 int,
aoa_321 int,
aoa_322 int,
aoa_323 int,
aoa_324 int,
aoa_325 int,
aoa_326 int,
aoa_327 int,
aoa_328 int,
aoa_329 int,
aoa_330 int,
aoa_331 int,
aoa_332 int,
aoa_333 int,
aoa_334 int,
aoa_335 int,
aoa_336 int,
aoa_337 int,
aoa_338 int,
aoa_339 int,
aoa_340 int,
aoa_341 int,
aoa_342 int,
aoa_343 int,
aoa_344 int,
aoa_345 int,
aoa_346 int,
aoa_347 int,
aoa_348 int,
aoa_349 int,
aoa_350 int,
aoa_351 int,
aoa_352 int,
aoa_353 int,
aoa_354 int,
aoa_355 int,
aoa_356 int,
aoa_357 int,
aoa_358 int,
aoa_359 int,
aoa_360 int,
aoa_361 int,
aoa_362 int,
aoa_363 int,
aoa_364 int,
aoa_365 int,
aoa_366 int,
aoa_367 int,
aoa_368 int,
aoa_369 int,
aoa_370 int,
aoa_371 int,
aoa_372 int,
aoa_373 int,
aoa_374 int,
aoa_375 int,
aoa_376 int,
aoa_377 int,
aoa_378 int,
aoa_379 int,
aoa_380 int,
aoa_381 int,
aoa_382 int,
aoa_383 int,
aoa_384 int,
aoa_385 int,
aoa_386 int,
aoa_387 int,
aoa_388 int,
aoa_389 int,
aoa_390 int,
aoa_391 int,
aoa_392 int,
aoa_393 int,
aoa_394 int,
aoa_395 int,
aoa_396 int,
aoa_397 int,
aoa_398 int,
aoa_399 int,
aoa_400 int,
aoa_401 int,
aoa_402 int,
aoa_403 int,
aoa_404 int,
aoa_405 int,
aoa_406 int,
aoa_407 int,
aoa_408 int,
aoa_409 int,
aoa_410 int,
aoa_411 int,
aoa_412 int,
aoa_413 int,
aoa_414 int,
aoa_415 int,
aoa_416 int,
aoa_417 int,
aoa_418 int,
aoa_419 int,
aoa_420 int,
aoa_421 int,
aoa_422 int,
aoa_423 int,
aoa_424 int,
aoa_425 int,
aoa_426 int,
aoa_427 int,
aoa_428 int,
aoa_429 int,
aoa_430 int,
aoa_431 int,
aoa_432 int,
aoa_433 int,
aoa_434 int,
aoa_435 int,
aoa_436 int,
aoa_437 int,
aoa_438 int,
aoa_439 int,
aoa_440 int,
aoa_441 int,
aoa_442 int,
aoa_443 int,
aoa_444 int,
aoa_445 int,
aoa_446 int,
aoa_447 int,
aoa_448 int,
aoa_449 int,
aoa_450 int,
aoa_451 int,
aoa_452 int,
aoa_453 int,
aoa_454 int,
aoa_455 int,
aoa_456 int,
aoa_457 int,
aoa_458 int,
aoa_459 int,
aoa_460 int,
aoa_461 int,
aoa_462 int,
aoa_463 int,
aoa_464 int,
aoa_465 int,
aoa_466 int,
aoa_467 int,
aoa_468 int,
aoa_469 int,
aoa_470 int,
aoa_471 int,
aoa_472 int,
aoa_473 int,
aoa_474 int,
aoa_475 int,
aoa_476 int,
aoa_477 int,
aoa_478 int,
aoa_479 int,
aoa_480 int,
aoa_481 int,
aoa_482 int,
aoa_483 int,
aoa_484 int,
aoa_485 int,
aoa_486 int,
aoa_487 int,
aoa_488 int,
aoa_489 int,
aoa_490 int,
aoa_491 int,
aoa_492 int,
aoa_493 int,
aoa_494 int,
aoa_495 int,
aoa_496 int,
aoa_497 int,
aoa_498 int,
aoa_499 int,
aoa_500 int,
aoa_501 int,
aoa_502 int,
aoa_503 int,
aoa_504 int,
aoa_505 int,
aoa_506 int,
aoa_507 int,
aoa_508 int,
aoa_509 int,
aoa_510 int,
aoa_511 int,
aoa_512 int,
aoa_513 int,
aoa_514 int,
aoa_515 int,
aoa_516 int,
aoa_517 int,
aoa_518 int,
aoa_519 int,
aoa_520 int,
aoa_521 int,
aoa_522 int,
aoa_523 int,
aoa_524 int,
aoa_525 int,
aoa_526 int,
aoa_527 int,
aoa_528 int,
aoa_529 int,
aoa_530 int,
aoa_531 int,
aoa_532 int,
aoa_533 int,
aoa_534 int,
aoa_535 int,
aoa_536 int,
aoa_537 int,
aoa_538 int,
aoa_539 int,
aoa_540 int,
aoa_541 int,
aoa_542 int,
aoa_543 int,
aoa_544 int,
aoa_545 int,
aoa_546 int,
aoa_547 int,
aoa_548 int,
aoa_549 int,
aoa_550 int,
aoa_551 int,
aoa_552 int,
aoa_553 int,
aoa_554 int,
aoa_555 int,
aoa_556 int,
aoa_557 int,
aoa_558 int,
aoa_559 int,
aoa_560 int,
aoa_561 int,
aoa_562 int,
aoa_563 int,
aoa_564 int,
aoa_565 int,
aoa_566 int,
aoa_567 int,
aoa_568 int,
aoa_569 int,
aoa_570 int,
aoa_571 int,
aoa_572 int,
aoa_573 int,
aoa_574 int,
aoa_575 int,
aoa_576 int,
aoa_577 int,
aoa_578 int,
aoa_579 int,
aoa_580 int,
aoa_581 int,
aoa_582 int,
aoa_583 int,
aoa_584 int,
aoa_585 int,
aoa_586 int,
aoa_587 int,
aoa_588 int,
aoa_589 int,
aoa_590 int,
aoa_591 int,
aoa_592 int,
aoa_593 int,
aoa_594 int,
aoa_595 int,
aoa_596 int,
aoa_597 int,
aoa_598 int,
aoa_599 int,
aoa_600 int,
aoa_601 int,
aoa_602 int,
aoa_603 int,
aoa_604 int,
aoa_605 int,
aoa_606 int,
aoa_607 int,
aoa_608 int,
aoa_609 int,
aoa_610 int,
aoa_611 int,
aoa_612 int,
aoa_613 int,
aoa_614 int,
aoa_615 int,
aoa_616 int,
aoa_617 int,
aoa_618 int,
aoa_619 int,
aoa_620 int,
aoa_621 int,
aoa_622 int,
aoa_623 int,
aoa_624 int,
aoa_625 int,
aoa_626 int,
aoa_627 int,
aoa_628 int,
aoa_629 int,
aoa_630 int,
aoa_631 int,
aoa_632 int,
aoa_633 int,
aoa_634 int,
aoa_635 int,
aoa_636 int,
aoa_637 int,
aoa_638 int,
aoa_639 int,
aoa_640 int,
aoa_641 int,
aoa_642 int,
aoa_643 int,
aoa_644 int,
aoa_645 int,
aoa_646 int,
aoa_647 int,
aoa_648 int,
aoa_649 int,
aoa_650 int,
aoa_651 int,
aoa_652 int,
aoa_653 int,
aoa_654 int,
aoa_655 int,
aoa_656 int,
aoa_657 int,
aoa_658 int,
aoa_659 int,
aoa_660 int,
aoa_661 int,
aoa_662 int,
aoa_663 int,
aoa_664 int,
aoa_665 int,
aoa_666 int,
aoa_667 int,
aoa_668 int,
aoa_669 int,
aoa_670 int,
aoa_671 int,
aoa_672 int,
aoa_673 int,
aoa_674 int,
aoa_675 int,
aoa_676 int,
aoa_677 int,
aoa_678 int,
aoa_679 int,
aoa_680 int,
aoa_681 int,
aoa_682 int,
aoa_683 int,
aoa_684 int,
aoa_685 int,
aoa_686 int,
aoa_687 int,
aoa_688 int,
aoa_689 int,
aoa_690 int,
aoa_691 int,
aoa_692 int,
aoa_693 int,
aoa_694 int,
aoa_695 int,
aoa_696 int,
aoa_697 int,
aoa_698 int,
aoa_699 int,
aoa_700 int,
aoa_701 int,
aoa_702 int,
aoa_703 int,
aoa_704 int,
aoa_705 int,
aoa_706 int,
aoa_707 int,
aoa_708 int,
aoa_709 int,
aoa_710 int,
aoa_711 int,
aoa_712 int,
aoa_713 int,
aoa_714 int,
aoa_715 int,
aoa_716 int,
aoa_717 int,
aoa_718 int,
aoa_719 int,
aoa_sum float,
aoa_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_aoa';

create external table IF NOT EXISTS tdl_mro_diff_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
m_int_id bigint,
related_enodeb bigint,
enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
n_name string,
n_enb_id int,
n_celllocalid int,
distince float,
sc0diff0 int,
sc1diff0 int,
sc2diff0 int,
sc3diff0 int,
sc4diff0 int,
sc5diff0 int,
sc6diff0 int,
sc7diff0 int,
sc8diff0 int,
sc9diff0 int,
sc10diff0 int,
sc0diff1 int,
sc1diff1 int,
sc2diff1 int,
sc3diff1 int,
sc4diff1 int,
sc5diff1 int,
sc6diff1 int,
sc7diff1 int,
sc8diff1 int,
sc9diff1 int,
sc10diff1 int,
sc0diff2 int,
sc1diff2 int,
sc2diff2 int,
sc3diff2 int,
sc4diff2 int,
sc5diff2 int,
sc6diff2 int,
sc7diff2 int,
sc8diff2 int,
sc9diff2 int,
sc10diff2 int,
sc0diff3 int,
sc1diff3 int,
sc2diff3 int,
sc3diff3 int,
sc4diff3 int,
sc5diff3 int,
sc6diff3 int,
sc7diff3 int,
sc8diff3 int,
sc9diff3 int,
sc10diff3 int,
sc0diff4 int,
sc1diff4 int,
sc2diff4 int,
sc3diff4 int,
sc4diff4 int,
sc5diff4 int,
sc6diff4 int,
sc7diff4 int,
sc8diff4 int,
sc9diff4 int,
sc10diff4 int,
sc0diff5 int,
sc1diff5 int,
sc2diff5 int,
sc3diff5 int,
sc4diff5 int,
sc5diff5 int,
sc6diff5 int,
sc7diff5 int,
sc8diff5 int,
sc9diff5 int,
sc10diff5 int,
sc0diff6 int,
sc1diff6 int,
sc2diff6 int,
sc3diff6 int,
sc4diff6 int,
sc5diff6 int,
sc6diff6 int,
sc7diff6 int,
sc8diff6 int,
sc9diff6 int,
sc10diff6 int,
sc0diff7 int,
sc1diff7 int,
sc2diff7 int,
sc3diff7 int,
sc4diff7 int,
sc5diff7 int,
sc6diff7 int,
sc7diff7 int,
sc8diff7 int,
sc9diff7 int,
sc10diff7 int,
sc0diff8 int,
sc1diff8 int,
sc2diff8 int,
sc3diff8 int,
sc4diff8 int,
sc5diff8 int,
sc6diff8 int,
sc7diff8 int,
sc8diff8 int,
sc9diff8 int,
sc10diff8 int,
sc0diff9 int,
sc1diff9 int,
sc2diff9 int,
sc3diff9 int,
sc4diff9 int,
sc5diff9 int,
sc6diff9 int,
sc7diff9 int,
sc8diff9 int,
sc9diff9 int,
sc10diff9 int,
sc0diff10 int,
sc1diff10 int,
sc2diff10 int,
sc3diff10 int,
sc4diff10 int,
sc5diff10 int,
sc6diff10 int,
sc7diff10 int,
sc8diff10 int,
sc9diff10 int,
sc10diff10 int,
ncrsrp0 int,
ncrsrp1 int,
ncrsrp2 int,
ncrsrp3 int,
ncrsrp4 int,
ncrsrp5 int,
ncrsrp6 int,
ncrsrp7 int,
ncrsrp8 int,
ncrsrp9 int,
ncrsrp10 int,
nc_total_num int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_diff';

create external table IF NOT EXISTS tdl_mro_diff_freq_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
m_int_id bigint,
related_enodeb bigint,
enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
n_name string,
n_enb_id int,
n_celllocalid int,
freqtype int,
distince float,
sc0diff0 int,
sc1diff0 int,
sc2diff0 int,
sc3diff0 int,
sc4diff0 int,
sc5diff0 int,
sc6diff0 int,
sc7diff0 int,
sc8diff0 int,
sc9diff0 int,
sc10diff0 int,
sc0diff1 int,
sc1diff1 int,
sc2diff1 int,
sc3diff1 int,
sc4diff1 int,
sc5diff1 int,
sc6diff1 int,
sc7diff1 int,
sc8diff1 int,
sc9diff1 int,
sc10diff1 int,
sc0diff2 int,
sc1diff2 int,
sc2diff2 int,
sc3diff2 int,
sc4diff2 int,
sc5diff2 int,
sc6diff2 int,
sc7diff2 int,
sc8diff2 int,
sc9diff2 int,
sc10diff2 int,
sc0diff3 int,
sc1diff3 int,
sc2diff3 int,
sc3diff3 int,
sc4diff3 int,
sc5diff3 int,
sc6diff3 int,
sc7diff3 int,
sc8diff3 int,
sc9diff3 int,
sc10diff3 int,
sc0diff4 int,
sc1diff4 int,
sc2diff4 int,
sc3diff4 int,
sc4diff4 int,
sc5diff4 int,
sc6diff4 int,
sc7diff4 int,
sc8diff4 int,
sc9diff4 int,
sc10diff4 int,
sc0diff5 int,
sc1diff5 int,
sc2diff5 int,
sc3diff5 int,
sc4diff5 int,
sc5diff5 int,
sc6diff5 int,
sc7diff5 int,
sc8diff5 int,
sc9diff5 int,
sc10diff5 int,
sc0diff6 int,
sc1diff6 int,
sc2diff6 int,
sc3diff6 int,
sc4diff6 int,
sc5diff6 int,
sc6diff6 int,
sc7diff6 int,
sc8diff6 int,
sc9diff6 int,
sc10diff6 int,
sc0diff7 int,
sc1diff7 int,
sc2diff7 int,
sc3diff7 int,
sc4diff7 int,
sc5diff7 int,
sc6diff7 int,
sc7diff7 int,
sc8diff7 int,
sc9diff7 int,
sc10diff7 int,
sc0diff8 int,
sc1diff8 int,
sc2diff8 int,
sc3diff8 int,
sc4diff8 int,
sc5diff8 int,
sc6diff8 int,
sc7diff8 int,
sc8diff8 int,
sc9diff8 int,
sc10diff8 int,
sc0diff9 int,
sc1diff9 int,
sc2diff9 int,
sc3diff9 int,
sc4diff9 int,
sc5diff9 int,
sc6diff9 int,
sc7diff9 int,
sc8diff9 int,
sc9diff9 int,
sc10diff9 int,
sc0diff10 int,
sc1diff10 int,
sc2diff10 int,
sc3diff10 int,
sc4diff10 int,
sc5diff10 int,
sc6diff10 int,
sc7diff10 int,
sc8diff10 int,
sc9diff10 int,
sc10diff10 int,
ncrsrp0 int,
ncrsrp1 int,
ncrsrp2 int,
ncrsrp3 int,
ncrsrp4 int,
ncrsrp5 int,
ncrsrp6 int,
ncrsrp7 int,
ncrsrp8 int,
ncrsrp9 int,
ncrsrp10 int,
nc_total_num int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_diff_freq';

create external table IF NOT EXISTS tdl_mro_diff_freqband_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
m_int_id bigint,
related_enodeb bigint,
enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
n_name string,
n_enb_id int,
n_celllocalid int,
freqtype int,
distince float,
sc0diff0 int,
sc1diff0 int,
sc2diff0 int,
sc3diff0 int,
sc4diff0 int,
sc5diff0 int,
sc6diff0 int,
sc7diff0 int,
sc8diff0 int,
sc9diff0 int,
sc10diff0 int,
sc0diff1 int,
sc1diff1 int,
sc2diff1 int,
sc3diff1 int,
sc4diff1 int,
sc5diff1 int,
sc6diff1 int,
sc7diff1 int,
sc8diff1 int,
sc9diff1 int,
sc10diff1 int,
sc0diff2 int,
sc1diff2 int,
sc2diff2 int,
sc3diff2 int,
sc4diff2 int,
sc5diff2 int,
sc6diff2 int,
sc7diff2 int,
sc8diff2 int,
sc9diff2 int,
sc10diff2 int,
sc0diff3 int,
sc1diff3 int,
sc2diff3 int,
sc3diff3 int,
sc4diff3 int,
sc5diff3 int,
sc6diff3 int,
sc7diff3 int,
sc8diff3 int,
sc9diff3 int,
sc10diff3 int,
sc0diff4 int,
sc1diff4 int,
sc2diff4 int,
sc3diff4 int,
sc4diff4 int,
sc5diff4 int,
sc6diff4 int,
sc7diff4 int,
sc8diff4 int,
sc9diff4 int,
sc10diff4 int,
sc0diff5 int,
sc1diff5 int,
sc2diff5 int,
sc3diff5 int,
sc4diff5 int,
sc5diff5 int,
sc6diff5 int,
sc7diff5 int,
sc8diff5 int,
sc9diff5 int,
sc10diff5 int,
sc0diff6 int,
sc1diff6 int,
sc2diff6 int,
sc3diff6 int,
sc4diff6 int,
sc5diff6 int,
sc6diff6 int,
sc7diff6 int,
sc8diff6 int,
sc9diff6 int,
sc10diff6 int,
sc0diff7 int,
sc1diff7 int,
sc2diff7 int,
sc3diff7 int,
sc4diff7 int,
sc5diff7 int,
sc6diff7 int,
sc7diff7 int,
sc8diff7 int,
sc9diff7 int,
sc10diff7 int,
sc0diff8 int,
sc1diff8 int,
sc2diff8 int,
sc3diff8 int,
sc4diff8 int,
sc5diff8 int,
sc6diff8 int,
sc7diff8 int,
sc8diff8 int,
sc9diff8 int,
sc10diff8 int,
sc0diff9 int,
sc1diff9 int,
sc2diff9 int,
sc3diff9 int,
sc4diff9 int,
sc5diff9 int,
sc6diff9 int,
sc7diff9 int,
sc8diff9 int,
sc9diff9 int,
sc10diff9 int,
sc0diff10 int,
sc1diff10 int,
sc2diff10 int,
sc3diff10 int,
sc4diff10 int,
sc5diff10 int,
sc6diff10 int,
sc7diff10 int,
sc8diff10 int,
sc9diff10 int,
sc10diff10 int,
ncrsrp0 int,
ncrsrp1 int,
ncrsrp2 int,
ncrsrp3 int,
ncrsrp4 int,
ncrsrp5 int,
ncrsrp6 int,
ncrsrp7 int,
ncrsrp8 int,
ncrsrp9 int,
ncrsrp10 int,
nc_total_num int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_diff_freqband';

create external table IF NOT EXISTS tdl_mro_adjtdl_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
m_int_id bigint,
related_enodeb bigint,
enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
n_name string,
n_enb_id int,
n_celllocalid int,
distince float,
diff0 int,
diff1 int,
diff2 int,
diff3 int,
diff4 int,
diff5 int,
diff6 int,
diff7 int,
diff8 int,
diff9 int,
diff10 int,
nc_total_num int,
nc_sc_overf6 int,
nc_sc_overf3 int,
nc_sc_overf12 int,
ncrsrp0 int,
ncrsrp1 int,
ncrsrp2 int,
ncrsrp3 int,
ncrsrp4 int,
ncrsrp5 int,
ncrsrp6 int,
ncrsrp7 int,
ncrsrp8 int,
ncrsrp9 int,
ncrsrp10 int,
total_num int,
nc_sc_overf6_rate float
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_adjtdl';

create external table IF NOT EXISTS tdl_mro_adjtdl_freq_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
m_int_id bigint,
related_enodeb bigint,
enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
n_name string,
n_enb_id int,
n_celllocalid int,
freqtype int,
distince float,
diff0 int,
diff1 int,
diff2 int,
diff3 int,
diff4 int,
diff5 int,
diff6 int,
diff7 int,
diff8 int,
diff9 int,
diff10 int,
nc_total_num int,
nc_sc_overf6 int,
nc_sc_overf3 int,
nc_sc_overf12 int,
ncrsrp0 int,
ncrsrp1 int,
ncrsrp2 int,
ncrsrp3 int,
ncrsrp4 int,
ncrsrp5 int,
ncrsrp6 int,
ncrsrp7 int,
ncrsrp8 int,
ncrsrp9 int,
ncrsrp10 int,
total_num int,
nc_sc_overf6_rate float
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_adjtdl_freq';

create external table IF NOT EXISTS tdl_mro_adjtdl_freqband_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
m_int_id bigint,
related_enodeb bigint,
enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
n_name string,
n_enb_id int,
n_celllocalid int,
freqtype int,
distince float,
diff0 int,
diff1 int,
diff2 int,
diff3 int,
diff4 int,
diff5 int,
diff6 int,
diff7 int,
diff8 int,
diff9 int,
diff10 int,
nc_total_num int,
nc_sc_overf6 int,
nc_sc_overf3 int,
nc_sc_overf12 int,
ncrsrp0 int,
ncrsrp1 int,
ncrsrp2 int,
ncrsrp3 int,
ncrsrp4 int,
ncrsrp5 int,
ncrsrp6 int,
ncrsrp7 int,
ncrsrp8 int,
ncrsrp9 int,
ncrsrp10 int,
total_num int,
nc_sc_overf6_rate float
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_adjtdl_freqband';

create external table IF NOT EXISTS tdl_mro_pol_adj_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
m_int_id bigint,
city_id bigint,
region_id bigint,
scearfcn int,
scpci int,
related_enodeb bigint,
enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
ncearfcn int,
ncpci int,
n_name string,
n_enb_id int,
n_celllocalid int,
distince float,
tdl_ave_rscp_sc float,
tdl_ave_rsrp_sc_all float,
tdl_tim int,
tdl_ave_rscp_nc float,
tdl_tim_alone int,
nrsrp_threshold_count int,
tdl_tim_max int,
tdl_tim_ncrsrp float,
tdl_tim1 int,
tdl_tim2 int,
tdl_tim3 int,
tdl_tim4 int,
tdl_tim5 int,
tdl_tim6 int,
tdl_tim1_ncrsrp float,
tdl_tim2_ncrsrp float,
tdl_tim3_ncrsrp float,
tdl_tim4_ncrsrp float,
tdl_tim5_ncrsrp float,
tdl_tim6_ncrsrp float,
overlap_count1 int,
overlap_count2 int,
tdl_ave_rscp_nc_overlap_condi1 float,
tdl_tim1_overlap_condi1 int,
tdl_tim2_overlap_condi1 int,
tdl_tim3_overlap_condi1 int,
tdl_tim4_overlap_condi1 int,
tdl_tim5_overlap_condi1 int,
tdl_tim6_overlap_condi1 int,
tdl_tim1_overlap_condi1_ncrsrp float,
tdl_tim2_overlap_condi1_ncrsrp float,
tdl_tim3_overlap_condi1_ncrsrp float,
tdl_tim4_overlap_condi1_ncrsrp float,
tdl_tim5_overlap_condi1_ncrsrp float,
tdl_tim6_overlap_condi1_ncrsrp float,
tdl_ave_rscp_nc_overlap_condi2 float,
tdl_tim1_overlap_condi2 int,
tdl_tim2_overlap_condi2 int,
tdl_tim3_overlap_condi2 int,
tdl_tim4_overlap_condi2 int,
tdl_tim5_overlap_condi2 int,
tdl_tim6_overlap_condi2 int,
tdl_tim1_overlap_condi2_ncrsrp float,
tdl_tim2_overlap_condi2_ncrsrp float,
tdl_tim3_overlap_condi2_ncrsrp float,
tdl_tim4_overlap_condi2_ncrsrp float,
tdl_tim5_overlap_condi2_ncrsrp float,
tdl_tim6_overlap_condi2_ncrsrp float,
scrsrp_sum float,
rsrpdiff_abssum float,
rsrpdiff_absavg float,
ncrsrp_0 int,
ncrsrp_1 int,
ncrsrp_2 int,
ncrsrp_3 int,
ncrsrp_4 int,
ncrsrp_5 int,
ncrsrp_6 int,
ncrsrp_7 int,
ncrsrp_8 int,
ncrsrp_9 int,
ncrsrp_10 int,
ncrsrp_11 int,
ncrsrp_12 int,
ncrsrp_13 int,
ncrsrp_14 int,
ncrsrp_15 int,
ncrsrp_16 int,
ncrsrp_17 int,
ncrsrp_18 int,
ncrsrp_19 int,
ncrsrp_20 int,
ncrsrp_21 int,
ncrsrp_22 int,
ncrsrp_23 int,
ncrsrp_24 int,
ncrsrp_25 int,
ncrsrp_26 int,
ncrsrp_27 int,
ncrsrp_28 int,
ncrsrp_29 int,
ncrsrp_30 int,
ncrsrp_31 int,
ncrsrp_32 int,
ncrsrp_33 int,
ncrsrp_34 int,
ncrsrp_35 int,
ncrsrp_36 int,
ncrsrp_37 int,
ncrsrp_38 int,
ncrsrp_39 int,
ncrsrp_40 int,
ncrsrp_41 int,
ncrsrp_42 int,
ncrsrp_43 int,
ncrsrp_44 int,
ncrsrp_45 int,
ncrsrp_46 int,
ncrsrp_47 int,
ncrsrp_48 int,
ncrsrp_49 int,
ncrsrp_50 int,
ncrsrp_51 int,
ncrsrp_52 int,
ncrsrp_53 int,
ncrsrp_54 int,
ncrsrp_55 int,
ncrsrp_56 int,
ncrsrp_57 int,
ncrsrp_58 int,
ncrsrp_59 int,
ncrsrp_60 int,
ncrsrp_61 int,
ncrsrp_62 int,
ncrsrp_63 int,
ncrsrp_64 int,
ncrsrp_65 int,
ncrsrp_66 int,
ncrsrp_67 int,
ncrsrp_68 int,
ncrsrp_69 int,
ncrsrp_70 int,
ncrsrp_71 int,
ncrsrp_72 int,
ncrsrp_73 int,
ncrsrp_74 int,
ncrsrp_75 int,
ncrsrp_76 int,
ncrsrp_77 int,
ncrsrp_78 int,
ncrsrp_79 int,
ncrsrp_80 int,
ncrsrp_81 int,
ncrsrp_82 int,
ncrsrp_83 int,
ncrsrp_84 int,
ncrsrp_85 int,
ncrsrp_86 int,
ncrsrp_87 int,
ncrsrp_88 int,
ncrsrp_89 int,
ncrsrp_90 int,
ncrsrp_91 int,
ncrsrp_92 int,
ncrsrp_93 int,
ncrsrp_94 int,
ncrsrp_95 int,
ncrsrp_96 int,
ncrsrp_97 int,
ncrsrp_sum float,
ncrsrp_count int,
nc_netype int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_pol_adj';

create external table IF NOT EXISTS tdl_mro_rsrprssi_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
m_int_id bigint,
related_enodeb bigint,
enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
ncc int,
bcc int,
bcch int,
n_name string,
n_lac int,
n_ci int,
distince float,
sc0rssi0 int,
sc0rssi1 int,
sc0rssi2 int,
sc0rssi3 int,
sc0rssi4 int,
sc0rssi5 int,
sc0rssi6 int,
sc0rssi7 int,
sc0rssi8 int,
sc0rssi9 int,
sc1rssi0 int,
sc1rssi1 int,
sc1rssi2 int,
sc1rssi3 int,
sc1rssi4 int,
sc1rssi5 int,
sc1rssi6 int,
sc1rssi7 int,
sc1rssi8 int,
sc1rssi9 int,
sc2rssi0 int,
sc2rssi1 int,
sc2rssi2 int,
sc2rssi3 int,
sc2rssi4 int,
sc2rssi5 int,
sc2rssi6 int,
sc2rssi7 int,
sc2rssi8 int,
sc2rssi9 int,
sc3rssi0 int,
sc3rssi1 int,
sc3rssi2 int,
sc3rssi3 int,
sc3rssi4 int,
sc3rssi5 int,
sc3rssi6 int,
sc3rssi7 int,
sc3rssi8 int,
sc3rssi9 int,
sc4rssi0 int,
sc4rssi1 int,
sc4rssi2 int,
sc4rssi3 int,
sc4rssi4 int,
sc4rssi5 int,
sc4rssi6 int,
sc4rssi7 int,
sc4rssi8 int,
sc4rssi9 int,
sc5rssi0 int,
sc5rssi1 int,
sc5rssi2 int,
sc5rssi3 int,
sc5rssi4 int,
sc5rssi5 int,
sc5rssi6 int,
sc5rssi7 int,
sc5rssi8 int,
sc5rssi9 int,
sc6rssi0 int,
sc6rssi1 int,
sc6rssi2 int,
sc6rssi3 int,
sc6rssi4 int,
sc6rssi5 int,
sc6rssi6 int,
sc6rssi7 int,
sc6rssi8 int,
sc6rssi9 int,
sc7rssi0 int,
sc7rssi1 int,
sc7rssi2 int,
sc7rssi3 int,
sc7rssi4 int,
sc7rssi5 int,
sc7rssi6 int,
sc7rssi7 int,
sc7rssi8 int,
sc7rssi9 int,
sc8rssi0 int,
sc8rssi1 int,
sc8rssi2 int,
sc8rssi3 int,
sc8rssi4 int,
sc8rssi5 int,
sc8rssi6 int,
sc8rssi7 int,
sc8rssi8 int,
sc8rssi9 int,
sc9rssi0 int,
sc9rssi1 int,
sc9rssi2 int,
sc9rssi3 int,
sc9rssi4 int,
sc9rssi5 int,
sc9rssi6 int,
sc9rssi7 int,
sc9rssi8 int,
sc9rssi9 int,
sc10rssi0 int,
sc10rssi1 int,
sc10rssi2 int,
sc10rssi3 int,
sc10rssi4 int,
sc10rssi5 int,
sc10rssi6 int,
sc10rssi7 int,
sc10rssi8 int,
sc10rssi9 int,
ncrssi0 int,
ncrssi1 int,
ncrssi2 int,
ncrssi3 int,
ncrssi4 int,
ncrssi5 int,
ncrssi6 int,
ncrssi7 int,
ncrssi8 int,
ncrssi9 int,
nc_total_num int,
total_num_85 int,
total_num_90 int,
total_num_95 int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_rsrprssi';

create external table IF NOT EXISTS tdl_mro_adjtdl_gsm_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
m_int_id bigint,
related_enodeb bigint,
enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
ncc int,
bcc int,
bcch int,
n_name string,
n_lac int,
n_ci int,
distince float,
rssiov85_rsrpls85 int,
rssiov90_rsrpls90 int,
rssiov95_rsrpls95 int,
nc_total_num int,
total_num_85 int,
total_num_90 int,
total_num_95 int,
correlation_85 float,
correlation_90 float,
correlation_95 float,
gsm_ave_rsrp_sc float,
ncrssi0 int,
ncrssi1 int,
ncrssi2 int,
ncrssi3 int,
ncrssi4 int,
ncrssi5 int,
ncrssi6 int,
ncrssi7 int,
ncrssi8 int,
ncrssi9 int,
total_num int,
gsm_ave_rsrp_sc_all float
) partitioned by (omcpart STRING, datepart STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_adjtdl_gsm';

create external table IF NOT EXISTS tdl_mro_mgrs_numofadj_eutr_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
num0diff0 int,
num1diff0 int,
num2diff0 int,
num3diff0 int,
num4diff0 int,
num5diff0 int,
num6diff0 int,
num7diff0 int,
num8diff0 int,
num9diff0 int,
num10diff0 int,
num11diff0 int,
num12diff0 int,
num13diff0 int,
num14diff0 int,
num15diff0 int,
num16diff0 int,
num17diff0 int,
num18diff0 int,
num19diff0 int,
num20diff0 int,
num0diff1 int,
num1diff1 int,
num2diff1 int,
num3diff1 int,
num4diff1 int,
num5diff1 int,
num6diff1 int,
num7diff1 int,
num8diff1 int,
num9diff1 int,
num10diff1 int,
num11diff1 int,
num12diff1 int,
num13diff1 int,
num14diff1 int,
num15diff1 int,
num16diff1 int,
num17diff1 int,
num18diff1 int,
num19diff1 int,
num20diff1 int,
total_num int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_numofadj_eutr';

create external table IF NOT EXISTS tdl_mro_mgrs_user_rsrp_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
user_type int,
rsrp_0 int,
rsrp_1 int,
rsrp_2 int,
rsrp_3 int,
rsrp_4 int,
rsrp_5 int,
rsrp_6 int,
rsrp_7 int,
rsrp_8 int,
rsrp_9 int,
rsrp_10 int,
rsrp_11 int,
rsrp_sum float,
rsrp_count int,
rsrp_weak int,
maxrsrp_0 int,
maxrsrp_1 int,
maxrsrp_2 int,
maxrsrp_3 int,
maxrsrp_4 int,
maxrsrp_5 int,
maxrsrp_6 int,
maxrsrp_7 int,
maxrsrp_8 int,
maxrsrp_9 int,
maxrsrp_10 int,
maxrsrp_11 int,
maxrsrp_sum float,
maxrsrp_count int,
maxrsrp_weak int,
un_maxrsrp_0 int,
un_maxrsrp_1 int,
un_maxrsrp_2 int,
un_maxrsrp_3 int,
un_maxrsrp_4 int,
un_maxrsrp_5 int,
un_maxrsrp_6 int,
un_maxrsrp_7 int,
un_maxrsrp_8 int,
un_maxrsrp_9 int,
un_maxrsrp_10 int,
un_maxrsrp_11 int,
un_maxrsrp_sum float,
un_maxrsrp_count int,
un_maxrsrp_weak int,
te_maxrsrp_0 int,
te_maxrsrp_1 int,
te_maxrsrp_2 int,
te_maxrsrp_3 int,
te_maxrsrp_4 int,
te_maxrsrp_5 int,
te_maxrsrp_6 int,
te_maxrsrp_7 int,
te_maxrsrp_8 int,
te_maxrsrp_9 int,
te_maxrsrp_10 int,
te_maxrsrp_11 int,
te_maxrsrp_sum float,
te_maxrsrp_count int,
te_maxrsrp_weak int,
inter_maxrsrp_0 int,
inter_maxrsrp_1 int,
inter_maxrsrp_2 int,
inter_maxrsrp_3 int,
inter_maxrsrp_4 int,
inter_maxrsrp_5 int,
inter_maxrsrp_6 int,
inter_maxrsrp_7 int,
inter_maxrsrp_8 int,
inter_maxrsrp_9 int,
inter_maxrsrp_10 int,
inter_maxrsrp_11 int,
inter_maxrsrp_sum float,
inter_maxrsrp_count int,
inter_maxrsrp_weak int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_user_rsrp';

create external table IF NOT EXISTS tdl_mro_mgrs_user_rsrq_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
user_type int,
rsrq_00 int,
rsrq_01 int,
rsrq_02 int,
rsrq_03 int,
rsrq_04 int,
rsrq_05 int,
rsrq_06 int,
rsrq_07 int,
rsrq_sum float,
rsrq_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_user_rsrq';

create external table IF NOT EXISTS tdl_mro_mgrs_user_sinrul_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
user_type int,
sinrul_0 int,
sinrul_1 int,
sinrul_2 int,
sinrul_3 int,
sinrul_4 int,
sinrul_5 int,
sinrul_6 int,
sinrul_sum float,
sinrul_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_user_sinrul';

create external table IF NOT EXISTS tdl_mro_mgrs_user_phr_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
user_type int,
phr_00 int,
phr_01 int,
phr_02 int,
phr_03 int,
phr_04 int,
phr_05 int,
phr_sum float,
phr_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_user_phr';

create external table IF NOT EXISTS tdl_mro_mgrs_user_sinrdl_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
user_type int,
sinrdl_0 int,
sinrdl_1 int,
sinrdl_2 int,
sinrdl_3 int,
sinrdl_4 int,
sinrdl_5 int,
sinrdl_6 int,
sinrdl_7 int,
sinrdl_8 int,
sinrdl_9 int,
sinrdl_10 int,
sinrdl_11 int,
sinrdl_12 int,
sinrdl_13 int,
sinrdl_14 int,
sinrdl_15 int,
sinrdl_16 int,
sinrdl_17 int,
sinrdl_18 int,
sinrdl_19 int,
sinrdl_20 int,
sinrdl_21 int,
sinrdl_22 int,
sinrdl_23 int,
sinrdl_24 int,
sinrdl_25 int,
sinrdl_26 int,
sinrdl_27 int,
sinrdl_28 int,
sinrdl_29 int,
sinrdl_30 int,
sinrdl_31 int,
sinrdl_32 int,
sinrdl_33 int,
sinrdl_34 int,
sinrdl_35 int,
sinrdl_36 int,
sinrdl_37 int,
sinrdl_38 int,
sinrdl_39 int,
sinrdl_40 int,
sinrdl_41 int,
sinrdl_42 int,
sinrdl_43 int,
sinrdl_44 int,
sinrdl_45 int,
sinrdl_46 int,
sinrdl_47 int,
sinrdl_48 int,
sinrdl_49 int,
sinrdl_50 int,
sinrdl_51 int,
sinrdl_52 int,
sinrdl_53 int,
sinrdl_54 int,
sinrdl_55 int,
sinrdl_56 int,
sinrdl_sum float,
sinrdl_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_user_sinrdl';

create external table IF NOT EXISTS tdl_mro_mgrs_user_maxrsrp_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
user_type int,
m_int_id bigint,
city_id bigint,
region_id bigint,
scearfcn int,
scpci int,
m_related_enodeb bigint,
m_enodeb_name string,
m_name string,
enb_id int,
m_celllocalid int,
n_int_id bigint,
ncearfcn int,
ncpci int,
n_related_enodeb bigint,
n_enodeb_name string,
n_name string,
n_enb_id int,
n_celllocalid int,
rsrp_0 int,
rsrp_1 int,
rsrp_2 int,
rsrp_3 int,
rsrp_4 int,
rsrp_5 int,
rsrp_6 int,
rsrp_7 int,
rsrp_8 int,
rsrp_9 int,
rsrp_10 int,
rsrp_11 int,
rsrp_sum float,
rsrp_count int,
rsrp_weak int,
nc_netype int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_user_maxrsrp';

create external table IF NOT EXISTS tdl_mro_mgrs_rsrp_eutr_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
rsrp_0 int,
rsrp_1 int,
rsrp_2 int,
rsrp_3 int,
rsrp_4 int,
rsrp_5 int,
rsrp_6 int,
rsrp_7 int,
rsrp_8 int,
rsrp_9 int,
rsrp_10 int,
rsrp_11 int,
rsrp_sum float,
rsrp_count int,
rsrp_weak int,
rsrp_avg float,
rsrp_weak_rate float,
total_gridnum int,
effective_gridnum int,
weak_cover_gridnum int,
maxrsrp_0 int,
maxrsrp_1 int,
maxrsrp_2 int,
maxrsrp_3 int,
maxrsrp_4 int,
maxrsrp_5 int,
maxrsrp_6 int,
maxrsrp_7 int,
maxrsrp_8 int,
maxrsrp_9 int,
maxrsrp_10 int,
maxrsrp_11 int,
maxrsrp_sum float,
maxrsrp_count int,
maxrsrp_weak int,
maxrsrp_avg float,
maxrsrp_weak_rate float,
maxrsrp_effective_gridnum int,
maxrsrp_weak_cover_gridnum int,
un_maxrsrp_0 int,
un_maxrsrp_1 int,
un_maxrsrp_2 int,
un_maxrsrp_3 int,
un_maxrsrp_4 int,
un_maxrsrp_5 int,
un_maxrsrp_6 int,
un_maxrsrp_7 int,
un_maxrsrp_8 int,
un_maxrsrp_9 int,
un_maxrsrp_10 int,
un_maxrsrp_11 int,
un_maxrsrp_sum float,
un_maxrsrp_count int,
un_maxrsrp_weak int,
un_maxrsrp_avg float,
un_maxrsrp_weak_rate float,
un_maxrsrp_effective_gridnum int,
un_maxrsrp_weak_cover_gridnum int,
te_maxrsrp_0 int,
te_maxrsrp_1 int,
te_maxrsrp_2 int,
te_maxrsrp_3 int,
te_maxrsrp_4 int,
te_maxrsrp_5 int,
te_maxrsrp_6 int,
te_maxrsrp_7 int,
te_maxrsrp_8 int,
te_maxrsrp_9 int,
te_maxrsrp_10 int,
te_maxrsrp_11 int,
te_maxrsrp_sum float,
te_maxrsrp_count int,
te_maxrsrp_weak int,
te_maxrsrp_avg float,
te_maxrsrp_weak_rate float,
te_maxrsrp_effective_gridnum int,
te_maxrsrp_weak_cover_gridnum int,
inter_maxrsrp_0 int,
inter_maxrsrp_1 int,
inter_maxrsrp_2 int,
inter_maxrsrp_3 int,
inter_maxrsrp_4 int,
inter_maxrsrp_5 int,
inter_maxrsrp_6 int,
inter_maxrsrp_7 int,
inter_maxrsrp_8 int,
inter_maxrsrp_9 int,
inter_maxrsrp_10 int,
inter_maxrsrp_11 int,
inter_maxrsrp_sum float,
inter_maxrsrp_count int,
inter_maxrsrp_weak int,
inter_maxrsrp_avg float,
inter_maxrsrp_weak_rate float,
inter_maxrsrp_effective_gridnum int,
inter_maxrsrp_weak_cover_gridnum int,
rsrp_weak_l2 int,
rsrp_weak_rate_l2 float,
weak_cover_gridnum_l2 int,
maxrsrp_weak_l2 int,
maxrsrp_weak_rate_l2 float,
maxrsrp_weak_cover_gridnum_l2 int,
un_maxrsrp_weak_l2 int,
un_maxrsrp_weak_rate_l2 float,
un_maxrsrp_weak_cover_gridnum_l2 int,
te_maxrsrp_weak_l2 int,
te_maxrsrp_weak_rate_l2 float,
te_maxrsrp_weak_cover_gridnum_l2 int,
inter_maxrsrp_weak_l2 int,
inter_maxrsrp_weak_rate_l2 float,
inter_maxrsrp_weak_cover_gridnum_l2 int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_rsrp_eutr';

create external table IF NOT EXISTS tdl_mro_mgrs_rsrp_eutr_u_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
rsrp_0 int,
rsrp_1 int,
rsrp_2 int,
rsrp_3 int,
rsrp_4 int,
rsrp_5 int,
rsrp_6 int,
rsrp_7 int,
rsrp_8 int,
rsrp_9 int,
rsrp_10 int,
rsrp_11 int,
rsrp_sum float,
rsrp_count int,
rsrp_weak int,
rsrp_avg float,
rsrp_weak_rate float,
rsrp_count_type0 int,
rsrp_weak_type0 int,
rsrp_count_type1 int,
rsrp_weak_type1 int,
rsrp_count_type2 int,
rsrp_weak_type2 int,
rsrp_count_type3 int,
rsrp_weak_type3 int,
maxrsrp_0 int,
maxrsrp_1 int,
maxrsrp_2 int,
maxrsrp_3 int,
maxrsrp_4 int,
maxrsrp_5 int,
maxrsrp_6 int,
maxrsrp_7 int,
maxrsrp_8 int,
maxrsrp_9 int,
maxrsrp_10 int,
maxrsrp_11 int,
maxrsrp_sum float,
maxrsrp_count int,
maxrsrp_weak int,
maxrsrp_avg float,
maxrsrp_weak_rate float,
maxrsrp_count_type0 int,
maxrsrp_weak_type0 int,
maxrsrp_count_type1 int,
maxrsrp_weak_type1 int,
maxrsrp_count_type2 int,
maxrsrp_weak_type2 int,
maxrsrp_count_type3 int,
maxrsrp_weak_type3 int,
un_maxrsrp_0 int,
un_maxrsrp_1 int,
un_maxrsrp_2 int,
un_maxrsrp_3 int,
un_maxrsrp_4 int,
un_maxrsrp_5 int,
un_maxrsrp_6 int,
un_maxrsrp_7 int,
un_maxrsrp_8 int,
un_maxrsrp_9 int,
un_maxrsrp_10 int,
un_maxrsrp_11 int,
un_maxrsrp_sum float,
un_maxrsrp_count int,
un_maxrsrp_weak int,
un_maxrsrp_avg float,
un_maxrsrp_weak_rate float,
un_maxrsrp_count_type0 int,
un_maxrsrp_weak_type0 int,
un_maxrsrp_count_type1 int,
un_maxrsrp_weak_type1 int,
un_maxrsrp_count_type2 int,
un_maxrsrp_weak_type2 int,
un_maxrsrp_count_type3 int,
un_maxrsrp_weak_type3 int,
te_maxrsrp_0 int,
te_maxrsrp_1 int,
te_maxrsrp_2 int,
te_maxrsrp_3 int,
te_maxrsrp_4 int,
te_maxrsrp_5 int,
te_maxrsrp_6 int,
te_maxrsrp_7 int,
te_maxrsrp_8 int,
te_maxrsrp_9 int,
te_maxrsrp_10 int,
te_maxrsrp_11 int,
te_maxrsrp_sum float,
te_maxrsrp_count int,
te_maxrsrp_weak int,
te_maxrsrp_avg float,
te_maxrsrp_weak_rate float,
te_maxrsrp_count_type0 int,
te_maxrsrp_weak_type0 int,
te_maxrsrp_count_type1 int,
te_maxrsrp_weak_type1 int,
te_maxrsrp_count_type2 int,
te_maxrsrp_weak_type2 int,
te_maxrsrp_count_type3 int,
te_maxrsrp_weak_type3 int,
inter_maxrsrp_0 int,
inter_maxrsrp_1 int,
inter_maxrsrp_2 int,
inter_maxrsrp_3 int,
inter_maxrsrp_4 int,
inter_maxrsrp_5 int,
inter_maxrsrp_6 int,
inter_maxrsrp_7 int,
inter_maxrsrp_8 int,
inter_maxrsrp_9 int,
inter_maxrsrp_10 int,
inter_maxrsrp_11 int,
inter_maxrsrp_sum float,
inter_maxrsrp_count int,
inter_maxrsrp_weak int,
inter_maxrsrp_avg float,
inter_maxrsrp_weak_rate float,
inter_maxrsrp_count_type0 int,
inter_maxrsrp_weak_type0 int,
inter_maxrsrp_count_type1 int,
inter_maxrsrp_weak_type1 int,
inter_maxrsrp_count_type2 int,
inter_maxrsrp_weak_type2 int,
inter_maxrsrp_count_type3 int,
inter_maxrsrp_weak_type3 int,
rsrp_weak_l2 int,
rsrp_weak_rate_l2 float,
maxrsrp_weak_l2 int,
maxrsrp_weak_rate_l2 float,
un_maxrsrp_weak_l2 int,
un_maxrsrp_weak_rate_l2 float,
te_maxrsrp_weak_l2 int,
te_maxrsrp_weak_rate_l2 float,
inter_maxrsrp_weak_l2 int,
inter_maxrsrp_weak_rate_l2 float
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_rsrp_eutr_u';

create external table IF NOT EXISTS tdl_mro_mgrs_rsrq_eutr_u_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
rsrq_00 int,
rsrq_01 int,
rsrq_02 int,
rsrq_03 int,
rsrq_04 int,
rsrq_05 int,
rsrq_06 int,
rsrq_07 int,
rsrq_sum float,
rsrq_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_rsrq_eutr_u';

create external table IF NOT EXISTS tdl_mro_mgrs_sinru_eutr_u_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
sinrul_0 int,
sinrul_1 int,
sinrul_2 int,
sinrul_3 int,
sinrul_4 int,
sinrul_5 int,
sinrul_6 int,
sinrul_sum float,
sinrul_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_sinru_eutr_u';

create external table IF NOT EXISTS tdl_mro_mgrs_phr_eutr_u_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
phr_00 int,
phr_01 int,
phr_02 int,
phr_03 int,
phr_04 int,
phr_05 int,
phr_sum float,
phr_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_phr_eutr_u';

create external table IF NOT EXISTS tdl_mro_mgrs_sinrd_eutr_u_${seq_id} (
omc_id string,
vendor_id int,
scan_start_time string,
scan_stop_time string,
int_id bigint,
city_id bigint,
region_id bigint,
earfcn int,
pci int,
related_enodeb bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
grid_id string,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
latituderd float,
longituderd float,
latitudelu float,
longitudelu float,
gis_level string,
geohash int,
sinrdl_0 int,
sinrdl_1 int,
sinrdl_2 int,
sinrdl_3 int,
sinrdl_4 int,
sinrdl_5 int,
sinrdl_6 int,
sinrdl_7 int,
sinrdl_8 int,
sinrdl_9 int,
sinrdl_10 int,
sinrdl_11 int,
sinrdl_12 int,
sinrdl_13 int,
sinrdl_14 int,
sinrdl_15 int,
sinrdl_16 int,
sinrdl_17 int,
sinrdl_18 int,
sinrdl_19 int,
sinrdl_20 int,
sinrdl_21 int,
sinrdl_22 int,
sinrdl_23 int,
sinrdl_24 int,
sinrdl_25 int,
sinrdl_26 int,
sinrdl_27 int,
sinrdl_28 int,
sinrdl_29 int,
sinrdl_30 int,
sinrdl_31 int,
sinrdl_32 int,
sinrdl_33 int,
sinrdl_34 int,
sinrdl_35 int,
sinrdl_36 int,
sinrdl_37 int,
sinrdl_38 int,
sinrdl_39 int,
sinrdl_40 int,
sinrdl_41 int,
sinrdl_42 int,
sinrdl_43 int,
sinrdl_44 int,
sinrdl_45 int,
sinrdl_46 int,
sinrdl_47 int,
sinrdl_48 int,
sinrdl_49 int,
sinrdl_50 int,
sinrdl_51 int,
sinrdl_52 int,
sinrdl_53 int,
sinrdl_54 int,
sinrdl_55 int,
sinrdl_56 int,
sinrdl_sum float,
sinrdl_count int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_mgrs_sinrd_eutr_u';

create external table IF NOT EXISTS tdl_mro_intefere_${seq_id} (
int_id	bigint,
omc_id	int,
vendor_id	int,
m_name	string,
m_int_id	bigint,
m_celllocalid	int,
enodeb_name	string,
related_enodeb	int,
n_name	string,
n_int_id	bigint,
n_celllocalid	int,
enb_id	int,
n_enb_id	int,
scan_start_time	string,
scan_stop_time	string,
scearfcn	int,
scpci	int,
ncearfcn	int,
ncpci	int,
insert_time	string,
ne_type	int,
sum_level	int,
defined_ncell	int,
distince	float,
sc_freq_type	int,
nc_freq_type	int,
interfere_up	float,
interfere_down	float,
nc_interfere_up	float,
nc_interfere_down	float,
nc_interfere_up_freq	float,
nc_interfere_down_freq	float,
sc_total_num	int,
nc_total_num	int
) partitioned by (omcpart bigint, datepart bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE LOCATION '${ParseInput}/tdl_mro_intefere';drop table ${houroozie};
create external table IF NOT EXISTS ${houroozie}
( 
 p_omc_id  string,
 p_date    string
)  ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|' STORED AS TEXTFILE location '${hoursql}';
create table if not exists  tpl_mro_ncrsrp_day  
(
int_id    bigint,
omc_id    int,
vendor_id    int,
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
ne_type    int,
sum_level    int,
city_id    bigint,
region_id    bigint,
enodeb_id    int,
eutrancell_id    int,
rsrp_0    int,
rsrp_1    int,
rsrp_2    int,
rsrp_3    int,
rsrp_4    int,
rsrp_5    int,
rsrp_6    int,
rsrp_7    int,
rsrp_8    int,
rsrp_9    int,
rsrp_10    int,
rsrp_11    int,
rsrp_12    int,
rsrp_13    int,
rsrp_14    int,
rsrp_15    int,
rsrp_16    int,
rsrp_17    int,
rsrp_18    int,
rsrp_19    int,
rsrp_20    int,
rsrp_21    int,
rsrp_22    int,
rsrp_23    int,
rsrp_24    int,
rsrp_25    int,
rsrp_26    int,
rsrp_27    int,
rsrp_28    int,
rsrp_29    int,
rsrp_30    int,
rsrp_31    int,
rsrp_32    int,
rsrp_33    int,
rsrp_34    int,
rsrp_35    int,
rsrp_36    int,
rsrp_37    int,
rsrp_38    int,
rsrp_39    int,
rsrp_40    int,
rsrp_41    int,
rsrp_42    int,
rsrp_43    int,
rsrp_44    int,
rsrp_45    int,
rsrp_46    int,
rsrp_47    int,
rsrp_48    int,
rsrp_49    int,
rsrp_50    int,
rsrp_51    int,
rsrp_52    int,
rsrp_53    int,
rsrp_54    int,
rsrp_55    int,
rsrp_56    int,
rsrp_57    int,
rsrp_58    int,
rsrp_59    int,
rsrp_60    int,
rsrp_61    int,
rsrp_62    int,
rsrp_63    int,
rsrp_64    int,
rsrp_65    int,
rsrp_66    int,
rsrp_67    int,
rsrp_68    int,
rsrp_69    int,
rsrp_70    int,
rsrp_71    int,
rsrp_72    int,
rsrp_73    int,
rsrp_74    int,
rsrp_75    int,
rsrp_76    int,
rsrp_77    int,
rsrp_78    int,
rsrp_79    int,
rsrp_80    int,
rsrp_81    int,
rsrp_82    int,
rsrp_83    int,
rsrp_84    int,
rsrp_85    int,
rsrp_86    int,
rsrp_87    int,
rsrp_88    int,
rsrp_89    int,
rsrp_90    int,
rsrp_91    int,
rsrp_92    int,
rsrp_93    int,
rsrp_94    int,
rsrp_95    int,
rsrp_96    int,
rsrp_97    int,
rsrp_sum    float,
rsrp_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists  tpl_mro_un_ncrsrp_day  
(
int_id    bigint,
omc_id    int,
vendor_id    int,
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
ne_type    int,
sum_level    int,
city_id    bigint,
region_id    bigint,
enodeb_id    int,
eutrancell_id    int,
rsrp_0    int,
rsrp_1    int,
rsrp_2    int,
rsrp_3    int,
rsrp_4    int,
rsrp_5    int,
rsrp_6    int,
rsrp_7    int,
rsrp_8    int,
rsrp_9    int,
rsrp_10    int,
rsrp_11    int,
rsrp_12    int,
rsrp_13    int,
rsrp_14    int,
rsrp_15    int,
rsrp_16    int,
rsrp_17    int,
rsrp_18    int,
rsrp_19    int,
rsrp_20    int,
rsrp_21    int,
rsrp_22    int,
rsrp_23    int,
rsrp_24    int,
rsrp_25    int,
rsrp_26    int,
rsrp_27    int,
rsrp_28    int,
rsrp_29    int,
rsrp_30    int,
rsrp_31    int,
rsrp_32    int,
rsrp_33    int,
rsrp_34    int,
rsrp_35    int,
rsrp_36    int,
rsrp_37    int,
rsrp_38    int,
rsrp_39    int,
rsrp_40    int,
rsrp_41    int,
rsrp_42    int,
rsrp_43    int,
rsrp_44    int,
rsrp_45    int,
rsrp_46    int,
rsrp_47    int,
rsrp_48    int,
rsrp_49    int,
rsrp_50    int,
rsrp_51    int,
rsrp_52    int,
rsrp_53    int,
rsrp_54    int,
rsrp_55    int,
rsrp_56    int,
rsrp_57    int,
rsrp_58    int,
rsrp_59    int,
rsrp_60    int,
rsrp_61    int,
rsrp_62    int,
rsrp_63    int,
rsrp_64    int,
rsrp_65    int,
rsrp_66    int,
rsrp_67    int,
rsrp_68    int,
rsrp_69    int,
rsrp_70    int,
rsrp_71    int,
rsrp_72    int,
rsrp_73    int,
rsrp_74    int,
rsrp_75    int,
rsrp_76    int,
rsrp_77    int,
rsrp_78    int,
rsrp_79    int,
rsrp_80    int,
rsrp_81    int,
rsrp_82    int,
rsrp_83    int,
rsrp_84    int,
rsrp_85    int,
rsrp_86    int,
rsrp_87    int,
rsrp_88    int,
rsrp_89    int,
rsrp_90    int,
rsrp_91    int,
rsrp_92    int,
rsrp_93    int,
rsrp_94    int,
rsrp_95    int,
rsrp_96    int,
rsrp_97    int,
rsrp_sum    float,
rsrp_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists  tpl_mro_te_ncrsrp_day  
(
int_id    bigint,
omc_id    int,
vendor_id    int,
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
ne_type    int,
sum_level    int,
city_id    bigint,
region_id    bigint,
enodeb_id    int,
eutrancell_id    int,
rsrp_0    int,
rsrp_1    int,
rsrp_2    int,
rsrp_3    int,
rsrp_4    int,
rsrp_5    int,
rsrp_6    int,
rsrp_7    int,
rsrp_8    int,
rsrp_9    int,
rsrp_10    int,
rsrp_11    int,
rsrp_12    int,
rsrp_13    int,
rsrp_14    int,
rsrp_15    int,
rsrp_16    int,
rsrp_17    int,
rsrp_18    int,
rsrp_19    int,
rsrp_20    int,
rsrp_21    int,
rsrp_22    int,
rsrp_23    int,
rsrp_24    int,
rsrp_25    int,
rsrp_26    int,
rsrp_27    int,
rsrp_28    int,
rsrp_29    int,
rsrp_30    int,
rsrp_31    int,
rsrp_32    int,
rsrp_33    int,
rsrp_34    int,
rsrp_35    int,
rsrp_36    int,
rsrp_37    int,
rsrp_38    int,
rsrp_39    int,
rsrp_40    int,
rsrp_41    int,
rsrp_42    int,
rsrp_43    int,
rsrp_44    int,
rsrp_45    int,
rsrp_46    int,
rsrp_47    int,
rsrp_48    int,
rsrp_49    int,
rsrp_50    int,
rsrp_51    int,
rsrp_52    int,
rsrp_53    int,
rsrp_54    int,
rsrp_55    int,
rsrp_56    int,
rsrp_57    int,
rsrp_58    int,
rsrp_59    int,
rsrp_60    int,
rsrp_61    int,
rsrp_62    int,
rsrp_63    int,
rsrp_64    int,
rsrp_65    int,
rsrp_66    int,
rsrp_67    int,
rsrp_68    int,
rsrp_69    int,
rsrp_70    int,
rsrp_71    int,
rsrp_72    int,
rsrp_73    int,
rsrp_74    int,
rsrp_75    int,
rsrp_76    int,
rsrp_77    int,
rsrp_78    int,
rsrp_79    int,
rsrp_80    int,
rsrp_81    int,
rsrp_82    int,
rsrp_83    int,
rsrp_84    int,
rsrp_85    int,
rsrp_86    int,
rsrp_87    int,
rsrp_88    int,
rsrp_89    int,
rsrp_90    int,
rsrp_91    int,
rsrp_92    int,
rsrp_93    int,
rsrp_94    int,
rsrp_95    int,
rsrp_96    int,
rsrp_97    int,
rsrp_sum    float,
rsrp_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create table if not exists tpl_mro_mgrs_rsrq_u_day
(
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
Ne_type    int,
Sum_level    int,
City_id    bigint,
Region_id    bigint,
Grid_id    string,
GIS_level    int,
GeoHash    string,
LatitudeLD    float,
LongitudeLD    float,
LatitudeRU    float,
LongitudeRU    float,
RSRQ_00    int,
RSRQ_01    int,
RSRQ_02    int,
RSRQ_03    int,
RSRQ_04    int,
RSRQ_05    int,
RSRQ_06    int,
RSRQ_07    int,
RSRQ_SUM    float,
RSRQ_count    int,
RSRQ_avg    float,
RSRQ_count_type0    int,
RSRQ_sum_type0    float,
RSRQ_avg_type0    float,
RSRQ_count_type1   int, 
RSRQ_sum_type1    float,
RSRQ_avg_type1    float,
RSRQ_count_type2   int, 
RSRQ_sum_type2    float,
RSRQ_avg_type2    float,
RSRQ_count_type3    int,
RSRQ_sum_type3    float,
RSRQ_avg_type3    float
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create table if not exists tpl_mro_mgrs_rsrq_user_u_day
(
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
Ne_type    int,
Sum_level    int,
City_id    bigint,
Region_id    bigint,
Grid_id    string,
GIS_level    int,
GeoHash    string,
User_type    int,
LatitudeLD    float,
LongitudeLD    float,
LatitudeRU    float,
LongitudeRU    float,
RSRQ_00    int,
RSRQ_01    int,
RSRQ_02    int,
RSRQ_03    int,
RSRQ_04    int,
RSRQ_05    int,
RSRQ_06    int,
RSRQ_07    int,
RSRQ_SUM    float,
RSRQ_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists tpl_mro_mgrs_sinru_u_day
(
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
Ne_type    int,
Sum_level    int,
City_id    bigint,
Region_id    bigint,
Grid_id    string,
GIS_level    int,
GeoHash   string,
LatitudeLD    float,
LongitudeLD    float,
LatitudeRU    float,
LongitudeRU    float,
SinrUL_0    int,
SinrUL_1    int,
SinrUL_2    int,
SinrUL_3    int,
SinrUL_4    int,
SinrUL_5    int,
SinrUL_6    int,
SinrUL_SUM    float,
SinrUL_count    int,
SINRUL_avg    float,
SINRUL_count_type0    int,
SINRUL_sum_type0    float,
SINRUL_avg_type0    float,
SINRUL_count_type1    int,
SINRUL_sum_type1    float,
SINRUL_avg_type1    float,
SINRUL_count_type2    int,
SINRUL_sum_type2    float,
SINRUL_avg_type2    float,
SINRUL_count_type3    int,
SINRUL_sum_type3    float,
SINRUL_avg_type3    float
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create table if not exists tpl_mro_mgrs_sinru_user_u_day
(
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
Ne_type    int,
Sum_level    int,
City_id    bigint,
Region_id    bigint,
Grid_id    string,
GIS_level    int,
GeoHash   string,
User_type    int,
LatitudeLD    float,
LongitudeLD    float,
LatitudeRU    float,
LongitudeRU    float,
SinrUL_0    int,
SinrUL_1    int,
SinrUL_2    int,
SinrUL_3    int,
SinrUL_4    int,
SinrUL_5    int,
SinrUL_6    int,
SinrUL_SUM    float,
SinrUL_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create table if not exists tpl_mro_mgrs_phr_u_day
(
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
Ne_type    int,
Sum_level    int,
City_id    bigint,
Region_id    bigint,
Grid_id    string,
GIS_level    int,
GeoHash   string,
LatitudeLD    float,
LongitudeLD    float,
LatitudeRU    float,
LongitudeRU    float,
PHR_00    int,
PHR_01    int,
PHR_02    int,
PHR_03    int,
PHR_04    int,
PHR_05    int,
PHR_SUM    float,
PHR_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create table if not exists tpl_mro_mgrs_phr_user_u_day
(
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
Ne_type    int,
Sum_level    int,
City_id    bigint,
Region_id    bigint,
Grid_id    string,
GIS_level    int,
GeoHash   string,
User_type    int,
LatitudeLD    float,
LongitudeLD    float,
LatitudeRU    float,
LongitudeRU    float,
PHR_00    int,
PHR_01    int,
PHR_02    int,
PHR_03    int,
PHR_04    int,
PHR_05    int,
PHR_SUM    float,
PHR_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';









create table if not exists tpl_mro_mgrs_sinrd_u_day
(
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
Ne_type    int,
Sum_level    int,
City_id    bigint,
Region_id    bigint,
Grid_id    string,
GIS_level    int,
GeoHash   string,
LatitudeLD    float,
LongitudeLD    float,
LatitudeRU    float,
LongitudeRU    float,
SinrDL_0    int,
SinrDL_1    int,
SinrDL_2    int,
SinrDL_3    int,
SinrDL_4    int,
SinrDL_5    int,
SinrDL_6    int,
SinrDL_7    int,
SinrDL_8    int,
SinrDL_9    int,
SinrDL_10    int,
SinrDL_11    int,
SinrDL_12    int,
SinrDL_13    int,
SinrDL_14    int,
SinrDL_15    int,
SinrDL_16    int,
SinrDL_17    int,
SinrDL_18    int,
SinrDL_19    int,
SinrDL_20    int,
SinrDL_21    int,
SinrDL_22    int,
SinrDL_23    int,
SinrDL_24    int,
SinrDL_25    int,
SinrDL_26    int,
SinrDL_27    int,
SinrDL_28    int,
SinrDL_29    int,
SinrDL_30    int,
SinrDL_31    int,
SinrDL_32    int,
SinrDL_33    int,
SinrDL_34    int,
SinrDL_35    int,
SinrDL_36    int,
SinrDL_37    int,
SinrDL_38    int,
SinrDL_39    int,
SinrDL_40    int,
SinrDL_41    int,
SinrDL_42    int,
SinrDL_43    int,
SinrDL_44    int,
SinrDL_45    int,
SinrDL_46    int,
SinrDL_47    int,
SinrDL_48    int,
SinrDL_49    int,
SinrDL_50    int,
SinrDL_51    int,
SinrDL_52    int,
SinrDL_53    int,
SinrDL_54    int,
SinrDL_55    int,
SinrDL_56    int,
SinrDL_SUM    float,
SinrDL_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';










create table if not exists tpl_mro_mgrs_sinrd_user_u_day
(
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
Ne_type    int,
Sum_level    int,
City_id    bigint,
Region_id    bigint,
Grid_id    string,
GIS_level    int,
GeoHash   string,
User_type    int,
LatitudeLD    float,
LongitudeLD    float,
LatitudeRU    float,
LongitudeRU    float,
SinrDL_0    int,
SinrDL_1    int,
SinrDL_2    int,
SinrDL_3    int,
SinrDL_4    int,
SinrDL_5    int,
SinrDL_6    int,
SinrDL_7    int,
SinrDL_8    int,
SinrDL_9    int,
SinrDL_10    int,
SinrDL_11    int,
SinrDL_12    int,
SinrDL_13    int,
SinrDL_14    int,
SinrDL_15    int,
SinrDL_16    int,
SinrDL_17    int,
SinrDL_18    int,
SinrDL_19    int,
SinrDL_20    int,
SinrDL_21    int,
SinrDL_22    int,
SinrDL_23    int,
SinrDL_24    int,
SinrDL_25    int,
SinrDL_26    int,
SinrDL_27    int,
SinrDL_28    int,
SinrDL_29    int,
SinrDL_30    int,
SinrDL_31    int,
SinrDL_32    int,
SinrDL_33    int,
SinrDL_34    int,
SinrDL_35    int,
SinrDL_36    int,
SinrDL_37    int,
SinrDL_38    int,
SinrDL_39    int,
SinrDL_40    int,
SinrDL_41    int,
SinrDL_42    int,
SinrDL_43    int,
SinrDL_44    int,
SinrDL_45    int,
SinrDL_46    int,
SinrDL_47    int,
SinrDL_48    int,
SinrDL_49    int,
SinrDL_50    int,
SinrDL_51    int,
SinrDL_52    int,
SinrDL_53    int,
SinrDL_54    int,
SinrDL_55    int,
SinrDL_56    int,
SinrDL_SUM    float,
SinrDL_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';






create table if not exists tpl_mro_mgrs_rsrp_user_u_day
(
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
Ne_type    int,
Sum_level    int,
City_id    bigint,
Region_id    bigint,
Grid_id    string,
User_type    int,
LatitudeLD    float,
LongitudeLD    float,
LatitudeRU    float,
LongitudeRU    float,
RSRP_0    int,
RSRP_1    int,
RSRP_2    int,
RSRP_3    int,
RSRP_4    int,
RSRP_5    int,
RSRP_6    int,
RSRP_7    int,
RSRP_8    int,
RSRP_9    int,
RSRP_10    int,
RSRP_11    int,
RSRP_SUM    float,
RSRP_count    int,
Rsrp_weak    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create table if not exists tpl_mro_adjtdl_day
(
int_id  bigint,
omc_id  int,
vendor_id  int,
m_name  string,
m_int_id  bigint,
m_celllocalid  int,
enodeb_name  string,
related_enodeb  int,
n_name  string,
n_int_id  bigint,
n_celllocalid  int,
enb_id  int,
n_enb_id  int,
scan_start_time  string,
scan_stop_time  string,
insert_time  string,
ne_type  int,
sum_level  int,
distince  float,
defined_ncell  int,
error_flag  int,
diff0  int,
diff1  int,
diff2  int,
diff3  int,
diff4  int,
diff5  int,
diff6  int,
diff7  int,
diff8  int,
diff9  int,
diff10  int,
total_num  int,
nc_total_num int,
nc_sc_overf6  int,
nc_sc_overf3  int,
nc_sc_overf12  int,
nc_sc_overf6_rate  float,
ncrsrp0  int,
ncrsrp1  int,
ncrsrp2  int,
ncrsrp3  int,
ncrsrp4  int,
ncrsrp5  int,
ncrsrp6  int,
ncrsrp7  int,
ncrsrp8  int,
ncrsrp9  int,
ncrsrp10    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';




create table if not exists tpl_mro_adjtdl_freq_day
(
int_id bigint,
omc_id int,
vendor_id int,
m_name  string,
m_int_id bigint,
m_celllocalid int,
enodeb_name  string,
related_enodeb int,
n_name  string,
n_int_id bigint,
n_celllocalid int,
enb_id int,
n_enb_id int,
scan_start_time  string,
scan_stop_time  string,
insert_time  string,
ne_type int,
sum_level int,
distince float,
defined_ncell int,
error_flag int,
diff0 int,
diff1 int,
diff2 int,
diff3 int,
diff4 int,
diff5 int,
diff6 int,
diff7 int,
diff8 int,
diff9 int,
diff10 int,
freqtype int,
total_num int,
nc_total_num int,
nc_sc_overf6 int,
nc_sc_overf3 int,
nc_sc_overf12 int,
nc_sc_overf6_rate float,
ncrsrp0  int,
ncrsrp1  int,
ncrsrp2  int,
ncrsrp3  int,
ncrsrp4  int,
ncrsrp5  int,
ncrsrp6  int,
ncrsrp7  int,
ncrsrp8  int,
ncrsrp9  int,
ncrsrp10    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create table if not exists tpl_mro_adjtdl_freqband_day
(
int_id bigint,
omc_id int,
vendor_id int,
m_name  string,
m_int_id bigint,
m_celllocalid int,
enodeb_name  string,
related_enodeb int,
n_name  string,
n_int_id bigint,
n_celllocalid int,
enb_id int,
n_enb_id int,
scan_start_time  string,
scan_stop_time  string,
insert_time  string,
ne_type int,
sum_level int,
distince float,
defined_ncell int,
error_flag int,
diff0 int,
diff1 int,
diff2 int,
diff3 int,
diff4 int,
diff5 int,
diff6 int,
diff7 int,
diff8 int,
diff9 int,
diff10 int,
freqtype int,
total_num int,
nc_total_num int,
nc_sc_overf6 int,
nc_sc_overf3 int,
nc_sc_overf12 int,
nc_sc_overf6_rate float,
ncrsrp0  int,
ncrsrp1  int,
ncrsrp2  int,
ncrsrp3  int,
ncrsrp4  int,
ncrsrp5  int,
ncrsrp6  int,
ncrsrp7  int,
ncrsrp8  int,
ncrsrp9  int,
ncrsrp10    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';




create table if not exists tpl_mro_adjtdl_gsm_day (
int_id  bigint,
omc_id  int,
vendor_id  int,
m_name  string,
m_int_id  bigint,
m_celllocalid  int,
enodeb_name  string,
related_enodeb  int,
n_name  string,
n_int_id  bigint,
n_lac  int,
n_ci  int,
n_cgi  string,
ncc  int,
bcc  int,
bcch  int,
enb_id  int,
scan_start_time  string,
scan_stop_time  string,
insert_time  string,
ne_type  int,
sum_level  int,
distince  float,
defined_ncell  int,
error_flag  int,
rssiov85_rsrpls85  int,
rssiov90_rsrpls90  int,
rssiov95_rsrpls95  int,
total_num  int,
nc_total_num  int,
total_num_85  int,
total_num_90  int,
total_num_95  int,
correlation_85  float,
correlation_90  float,
correlation_95  float,
gsm_ave_rsrp_sc  float,
gsm_ave_rsrp_sc_all  float,
ncrssi0  int,
ncrssi1  int,
ncrssi2  int,
ncrssi3  int,
ncrssi4  int,
ncrssi5  int,
ncrssi6  int,
ncrssi7  int,
ncrssi8  int,
ncrssi9  int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';




create  table if not exists tpl_mro_aoa_day
(
int_id  bigint,
omc_id  int,
vendor_id  int,
scan_start_time  string,
scan_stop_time  string,
insert_time  string,
ne_type  int,
sum_level  int,
related_enodeb  int,
enodeb_name  string,
enodeb_id  int,
eutrancell_id  int,
aoa_000  int,
aoa_001  int,
aoa_002  int,
aoa_003  int,
aoa_004  int,
aoa_005  int,
aoa_006  int,
aoa_007  int,
aoa_008  int,
aoa_009  int,
aoa_010  int,
aoa_011  int,
aoa_012  int,
aoa_013  int,
aoa_014  int,
aoa_015  int,
aoa_016  int,
aoa_017  int,
aoa_018  int,
aoa_019  int,
aoa_020  int,
aoa_021  int,
aoa_022  int,
aoa_023  int,
aoa_024  int,
aoa_025  int,
aoa_026  int,
aoa_027  int,
aoa_028  int,
aoa_029  int,
aoa_030  int,
aoa_031  int,
aoa_032  int,
aoa_033  int,
aoa_034  int,
aoa_035  int,
aoa_036  int,
aoa_037  int,
aoa_038  int,
aoa_039  int,
aoa_040  int,
aoa_041  int,
aoa_042  int,
aoa_043  int,
aoa_044  int,
aoa_045  int,
aoa_046  int,
aoa_047  int,
aoa_048  int,
aoa_049  int,
aoa_050  int,
aoa_051  int,
aoa_052  int,
aoa_053  int,
aoa_054  int,
aoa_055  int,
aoa_056  int,
aoa_057  int,
aoa_058  int,
aoa_059  int,
aoa_060  int,
aoa_061  int,
aoa_062  int,
aoa_063  int,
aoa_064  int,
aoa_065  int,
aoa_066  int,
aoa_067  int,
aoa_068  int,
aoa_069  int,
aoa_070  int,
aoa_071  int,
aoa_072  int,
aoa_073  int,
aoa_074  int,
aoa_075  int,
aoa_076  int,
aoa_077  int,
aoa_078  int,
aoa_079  int,
aoa_080  int,
aoa_081  int,
aoa_082  int,
aoa_083  int,
aoa_084  int,
aoa_085  int,
aoa_086  int,
aoa_087  int,
aoa_088  int,
aoa_089  int,
aoa_090  int,
aoa_091  int,
aoa_092  int,
aoa_093  int,
aoa_094  int,
aoa_095  int,
aoa_096  int,
aoa_097  int,
aoa_098  int,
aoa_099  int,
aoa_100  int,
aoa_101  int,
aoa_102  int,
aoa_103  int,
aoa_104  int,
aoa_105  int,
aoa_106  int,
aoa_107  int,
aoa_108  int,
aoa_109  int,
aoa_110  int,
aoa_111  int,
aoa_112  int,
aoa_113  int,
aoa_114  int,
aoa_115  int,
aoa_116  int,
aoa_117  int,
aoa_118  int,
aoa_119  int,
aoa_120  int,
aoa_121  int,
aoa_122  int,
aoa_123  int,
aoa_124  int,
aoa_125  int,
aoa_126  int,
aoa_127  int,
aoa_128  int,
aoa_129  int,
aoa_130  int,
aoa_131  int,
aoa_132  int,
aoa_133  int,
aoa_134  int,
aoa_135  int,
aoa_136  int,
aoa_137  int,
aoa_138  int,
aoa_139  int,
aoa_140  int,
aoa_141  int,
aoa_142  int,
aoa_143  int,
aoa_144  int,
aoa_145  int,
aoa_146  int,
aoa_147  int,
aoa_148  int,
aoa_149  int,
aoa_150  int,
aoa_151  int,
aoa_152  int,
aoa_153  int,
aoa_154  int,
aoa_155  int,
aoa_156  int,
aoa_157  int,
aoa_158  int,
aoa_159  int,
aoa_160  int,
aoa_161  int,
aoa_162  int,
aoa_163  int,
aoa_164  int,
aoa_165  int,
aoa_166  int,
aoa_167  int,
aoa_168  int,
aoa_169  int,
aoa_170  int,
aoa_171  int,
aoa_172  int,
aoa_173  int,
aoa_174  int,
aoa_175  int,
aoa_176  int,
aoa_177  int,
aoa_178  int,
aoa_179  int,
aoa_180  int,
aoa_181  int,
aoa_182  int,
aoa_183  int,
aoa_184  int,
aoa_185  int,
aoa_186  int,
aoa_187  int,
aoa_188  int,
aoa_189  int,
aoa_190  int,
aoa_191  int,
aoa_192  int,
aoa_193  int,
aoa_194  int,
aoa_195  int,
aoa_196  int,
aoa_197  int,
aoa_198  int,
aoa_199  int,
aoa_200  int,
aoa_201  int,
aoa_202  int,
aoa_203  int,
aoa_204  int,
aoa_205  int,
aoa_206  int,
aoa_207  int,
aoa_208  int,
aoa_209  int,
aoa_210  int,
aoa_211  int,
aoa_212  int,
aoa_213  int,
aoa_214  int,
aoa_215  int,
aoa_216  int,
aoa_217  int,
aoa_218  int,
aoa_219  int,
aoa_220  int,
aoa_221  int,
aoa_222  int,
aoa_223  int,
aoa_224  int,
aoa_225  int,
aoa_226  int,
aoa_227  int,
aoa_228  int,
aoa_229  int,
aoa_230  int,
aoa_231  int,
aoa_232  int,
aoa_233  int,
aoa_234  int,
aoa_235  int,
aoa_236  int,
aoa_237  int,
aoa_238  int,
aoa_239  int,
aoa_240  int,
aoa_241  int,
aoa_242  int,
aoa_243  int,
aoa_244  int,
aoa_245  int,
aoa_246  int,
aoa_247  int,
aoa_248  int,
aoa_249  int,
aoa_250  int,
aoa_251  int,
aoa_252  int,
aoa_253  int,
aoa_254  int,
aoa_255  int,
aoa_256  int,
aoa_257  int,
aoa_258  int,
aoa_259  int,
aoa_260  int,
aoa_261  int,
aoa_262  int,
aoa_263  int,
aoa_264  int,
aoa_265  int,
aoa_266  int,
aoa_267  int,
aoa_268  int,
aoa_269  int,
aoa_270  int,
aoa_271  int,
aoa_272  int,
aoa_273  int,
aoa_274  int,
aoa_275  int,
aoa_276  int,
aoa_277  int,
aoa_278  int,
aoa_279  int,
aoa_280  int,
aoa_281  int,
aoa_282  int,
aoa_283  int,
aoa_284  int,
aoa_285  int,
aoa_286  int,
aoa_287  int,
aoa_288  int,
aoa_289  int,
aoa_290  int,
aoa_291  int,
aoa_292  int,
aoa_293  int,
aoa_294  int,
aoa_295  int,
aoa_296  int,
aoa_297  int,
aoa_298  int,
aoa_299  int,
aoa_300  int,
aoa_301  int,
aoa_302  int,
aoa_303  int,
aoa_304  int,
aoa_305  int,
aoa_306  int,
aoa_307  int,
aoa_308  int,
aoa_309  int,
aoa_310  int,
aoa_311  int,
aoa_312  int,
aoa_313  int,
aoa_314  int,
aoa_315  int,
aoa_316  int,
aoa_317  int,
aoa_318  int,
aoa_319  int,
aoa_320  int,
aoa_321  int,
aoa_322  int,
aoa_323  int,
aoa_324  int,
aoa_325  int,
aoa_326  int,
aoa_327  int,
aoa_328  int,
aoa_329  int,
aoa_330  int,
aoa_331  int,
aoa_332  int,
aoa_333  int,
aoa_334  int,
aoa_335  int,
aoa_336  int,
aoa_337  int,
aoa_338  int,
aoa_339  int,
aoa_340  int,
aoa_341  int,
aoa_342  int,
aoa_343  int,
aoa_344  int,
aoa_345  int,
aoa_346  int,
aoa_347  int,
aoa_348  int,
aoa_349  int,
aoa_350  int,
aoa_351  int,
aoa_352  int,
aoa_353  int,
aoa_354  int,
aoa_355  int,
aoa_356  int,
aoa_357  int,
aoa_358  int,
aoa_359  int,
aoa_360  int,
aoa_361  int,
aoa_362  int,
aoa_363  int,
aoa_364  int,
aoa_365  int,
aoa_366  int,
aoa_367  int,
aoa_368  int,
aoa_369  int,
aoa_370  int,
aoa_371  int,
aoa_372  int,
aoa_373  int,
aoa_374  int,
aoa_375  int,
aoa_376  int,
aoa_377  int,
aoa_378  int,
aoa_379  int,
aoa_380  int,
aoa_381  int,
aoa_382  int,
aoa_383  int,
aoa_384  int,
aoa_385  int,
aoa_386  int,
aoa_387  int,
aoa_388  int,
aoa_389  int,
aoa_390  int,
aoa_391  int,
aoa_392  int,
aoa_393  int,
aoa_394  int,
aoa_395  int,
aoa_396  int,
aoa_397  int,
aoa_398  int,
aoa_399  int,
aoa_400  int,
aoa_401  int,
aoa_402  int,
aoa_403  int,
aoa_404  int,
aoa_405  int,
aoa_406  int,
aoa_407  int,
aoa_408  int,
aoa_409  int,
aoa_410  int,
aoa_411  int,
aoa_412  int,
aoa_413  int,
aoa_414  int,
aoa_415  int,
aoa_416  int,
aoa_417  int,
aoa_418  int,
aoa_419  int,
aoa_420  int,
aoa_421  int,
aoa_422  int,
aoa_423  int,
aoa_424  int,
aoa_425  int,
aoa_426  int,
aoa_427  int,
aoa_428  int,
aoa_429  int,
aoa_430  int,
aoa_431  int,
aoa_432  int,
aoa_433  int,
aoa_434  int,
aoa_435  int,
aoa_436  int,
aoa_437  int,
aoa_438  int,
aoa_439  int,
aoa_440  int,
aoa_441  int,
aoa_442  int,
aoa_443  int,
aoa_444  int,
aoa_445  int,
aoa_446  int,
aoa_447  int,
aoa_448  int,
aoa_449  int,
aoa_450  int,
aoa_451  int,
aoa_452  int,
aoa_453  int,
aoa_454  int,
aoa_455  int,
aoa_456  int,
aoa_457  int,
aoa_458  int,
aoa_459  int,
aoa_460  int,
aoa_461  int,
aoa_462  int,
aoa_463  int,
aoa_464  int,
aoa_465  int,
aoa_466  int,
aoa_467  int,
aoa_468  int,
aoa_469  int,
aoa_470  int,
aoa_471  int,
aoa_472  int,
aoa_473  int,
aoa_474  int,
aoa_475  int,
aoa_476  int,
aoa_477  int,
aoa_478  int,
aoa_479  int,
aoa_480  int,
aoa_481  int,
aoa_482  int,
aoa_483  int,
aoa_484  int,
aoa_485  int,
aoa_486  int,
aoa_487  int,
aoa_488  int,
aoa_489  int,
aoa_490  int,
aoa_491  int,
aoa_492  int,
aoa_493  int,
aoa_494  int,
aoa_495  int,
aoa_496  int,
aoa_497  int,
aoa_498  int,
aoa_499  int,
aoa_500  int,
aoa_501  int,
aoa_502  int,
aoa_503  int,
aoa_504  int,
aoa_505  int,
aoa_506  int,
aoa_507  int,
aoa_508  int,
aoa_509  int,
aoa_510  int,
aoa_511  int,
aoa_512  int,
aoa_513  int,
aoa_514  int,
aoa_515  int,
aoa_516  int,
aoa_517  int,
aoa_518  int,
aoa_519  int,
aoa_520  int,
aoa_521  int,
aoa_522  int,
aoa_523  int,
aoa_524  int,
aoa_525  int,
aoa_526  int,
aoa_527  int,
aoa_528  int,
aoa_529  int,
aoa_530  int,
aoa_531  int,
aoa_532  int,
aoa_533  int,
aoa_534  int,
aoa_535  int,
aoa_536  int,
aoa_537  int,
aoa_538  int,
aoa_539  int,
aoa_540  int,
aoa_541  int,
aoa_542  int,
aoa_543  int,
aoa_544  int,
aoa_545  int,
aoa_546  int,
aoa_547  int,
aoa_548  int,
aoa_549  int,
aoa_550  int,
aoa_551  int,
aoa_552  int,
aoa_553  int,
aoa_554  int,
aoa_555  int,
aoa_556  int,
aoa_557  int,
aoa_558  int,
aoa_559  int,
aoa_560  int,
aoa_561  int,
aoa_562  int,
aoa_563  int,
aoa_564  int,
aoa_565  int,
aoa_566  int,
aoa_567  int,
aoa_568  int,
aoa_569  int,
aoa_570  int,
aoa_571  int,
aoa_572  int,
aoa_573  int,
aoa_574  int,
aoa_575  int,
aoa_576  int,
aoa_577  int,
aoa_578  int,
aoa_579  int,
aoa_580  int,
aoa_581  int,
aoa_582  int,
aoa_583  int,
aoa_584  int,
aoa_585  int,
aoa_586  int,
aoa_587  int,
aoa_588  int,
aoa_589  int,
aoa_590  int,
aoa_591  int,
aoa_592  int,
aoa_593  int,
aoa_594  int,
aoa_595  int,
aoa_596  int,
aoa_597  int,
aoa_598  int,
aoa_599  int,
aoa_600  int,
aoa_601  int,
aoa_602  int,
aoa_603  int,
aoa_604  int,
aoa_605  int,
aoa_606  int,
aoa_607  int,
aoa_608  int,
aoa_609  int,
aoa_610  int,
aoa_611  int,
aoa_612  int,
aoa_613  int,
aoa_614  int,
aoa_615  int,
aoa_616  int,
aoa_617  int,
aoa_618  int,
aoa_619  int,
aoa_620  int,
aoa_621  int,
aoa_622  int,
aoa_623  int,
aoa_624  int,
aoa_625  int,
aoa_626  int,
aoa_627  int,
aoa_628  int,
aoa_629  int,
aoa_630  int,
aoa_631  int,
aoa_632  int,
aoa_633  int,
aoa_634  int,
aoa_635  int,
aoa_636  int,
aoa_637  int,
aoa_638  int,
aoa_639  int,
aoa_640  int,
aoa_641  int,
aoa_642  int,
aoa_643  int,
aoa_644  int,
aoa_645  int,
aoa_646  int,
aoa_647  int,
aoa_648  int,
aoa_649  int,
aoa_650  int,
aoa_651  int,
aoa_652  int,
aoa_653  int,
aoa_654  int,
aoa_655  int,
aoa_656  int,
aoa_657  int,
aoa_658  int,
aoa_659  int,
aoa_660  int,
aoa_661  int,
aoa_662  int,
aoa_663  int,
aoa_664  int,
aoa_665  int,
aoa_666  int,
aoa_667  int,
aoa_668  int,
aoa_669  int,
aoa_670  int,
aoa_671  int,
aoa_672  int,
aoa_673  int,
aoa_674  int,
aoa_675  int,
aoa_676  int,
aoa_677  int,
aoa_678  int,
aoa_679  int,
aoa_680  int,
aoa_681  int,
aoa_682  int,
aoa_683  int,
aoa_684  int,
aoa_685  int,
aoa_686  int,
aoa_687  int,
aoa_688  int,
aoa_689  int,
aoa_690  int,
aoa_691  int,
aoa_692  int,
aoa_693  int,
aoa_694  int,
aoa_695  int,
aoa_696  int,
aoa_697  int,
aoa_698  int,
aoa_699  int,
aoa_700  int,
aoa_701  int,
aoa_702  int,
aoa_703  int,
aoa_704  int,
aoa_705  int,
aoa_706  int,
aoa_707  int,
aoa_708  int,
aoa_709  int,
aoa_710  int,
aoa_711  int,
aoa_712  int,
aoa_713  int,
aoa_714  int,
aoa_715  int,
aoa_716  int,
aoa_717  int,
aoa_718  int,
aoa_719  int,
aoa_sum   float,
aoa_count  int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create EXTERNAL table IF NOT EXISTS tpl_mro_basetable_hour (
omc_id    string                  ,
vendor_id    int                  ,
M_CGI    string                   ,
M_int_id    bigint                , 
N_CGI    string                   ,
N_int_id    bigint                , 
reportTime    string              ,
startTime    string               ,
endTime    string                 ,
eNB_id    int                     ,
cid    int                        ,
userLabel    string               ,
LteScRSRP    int                  ,
LteNcRSRP    int                  ,
LteScRSRQ    int                  ,
LteNcRSRQ    int                  ,
LteScEarfcn    int                ,
LteScPci    int                   ,
LteNcEarfcn    int                ,
LteNcPci    int                   ,
LteScRTTD    int                  ,
LteScTadv    int                  ,
LteScPHR    int                   ,
LteScRIP    int                   ,
LteScAOA    int                   ,
LteScPlrULQci1    int             ,
LteScPlrULQci2    int             ,
LteScPlrULQci3    int             ,
LteScPlrULQci4    int             ,
LteScPlrULQci5    int             ,
LteScPlrULQci6    int             ,
LteScPlrULQci7    int             ,
LteScPlrULQci8    int             ,
LteScPlrULQci9    int             ,
LteScPlrDLQci1    int             ,
LteScPlrDLQci2    int             ,
LteScPlrDLQci3    int             ,
LteScPlrDLQci4    int             ,
LteScPlrDLQci5    int             ,
LteScPlrDLQci6    int             ,
LteScPlrDLQci7    int             ,
LteScPlrDLQci8    int             ,
LteScPlrDLQci9    int             ,
LteScSinrUL    int                ,
LteScRI1    int                   ,
LteScRI2    int                   ,
LteScRI4    int                   ,
LteScRI8    int                   ,
LteScPUSCHPRBNum    int           ,
LteScPDSCHPRBNum    int           ,
LteScBSR    int                   ,
LteSceNBRxTxTimeDiff    int       ,
GsmNcellBcch    int               ,
GsmNcellCarrierRSSI    int        ,
GsmNcellNcc    int                ,
GsmNcellBcc    int                ,
TdsPccpchRSCP    int              ,
TdsNcellUarfcn    int             ,
TdsCellParameterId    int         ,
MmeCode    string                 ,
MmeGroupId    string              ,
MmeUeS1apId    string             ,
Time_Stamp    string              ,
eutrancell_id    string           ,
Overlap_condi1    int             ,
Overlap_condi2    int             ,
Is_nRsrp_threshold    int         ,
Is_effective    int               ,
scfreq_type    int                ,
ncfreq_type    int                
) partitioned by (datepart bigint,omcpart bigint ) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\|';


create table if not exists tpl_mro_diff_day
(
m_int_id          bigint ,
n_int_id          bigint ,
m_name            string ,
n_name            string ,
enodeb_name       string ,
related_enodeb    bigint ,
omc_id           string ,
enb_id            bigint ,
vendor_id         int ,
n_enb_id          bigint ,
m_eutrancell_id   string ,
m_celllocalid   int,
n_eutrancell_id   string ,
n_celllocalid   int,
scan_start_time   string ,
scan_stop_time    string ,
insert_time       string ,
ne_type   int,
sum_level int,
distince          string ,
defined_ncell     int ,
error_flag        int ,
sc0diff0          int ,
sc1diff0          int ,
sc2diff0          int ,
sc3diff0          int ,
sc4diff0          int ,
sc5diff0          int ,
sc6diff0          int ,
sc7diff0          int ,
sc8diff0          int ,
sc9diff0          int ,
sc10diff0         int ,
sc0diff1          int ,
sc1diff1          int ,
sc2diff1          int ,
sc3diff1          int ,
sc4diff1          int ,
sc5diff1          int ,
sc6diff1          int ,
sc7diff1          int ,
sc8diff1          int ,
sc9diff1          int ,
sc10diff1         int ,
sc0diff2          int ,
sc1diff2          int ,
sc2diff2          int ,
sc3diff2          int ,
sc4diff2          int ,
sc5diff2          int ,
sc6diff2          int ,
sc7diff2          int ,
sc8diff2          int ,
sc9diff2          int ,
sc10diff2         int ,
sc0diff3          int ,
sc1diff3          int ,
sc2diff3          int ,
sc3diff3          int ,
sc4diff3          int ,
sc5diff3          int ,
sc6diff3          int ,
sc7diff3          int ,
sc8diff3          int ,
sc9diff3          int ,
sc10diff3         int ,
sc0diff4          int ,
sc1diff4          int ,
sc2diff4          int ,
sc3diff4          int ,
sc4diff4          int ,
sc5diff4          int ,
sc6diff4          int ,
sc7diff4          int ,
sc8diff4          int ,
sc9diff4          int ,
sc10diff4         int ,
sc0diff5          int ,
sc1diff5          int ,
sc2diff5          int ,
sc3diff5          int ,
sc4diff5          int ,
sc5diff5          int ,
sc6diff5          int ,
sc7diff5          int ,
sc8diff5          int ,
sc9diff5          int ,
sc10diff5         int ,
sc0diff6          int ,
sc1diff6          int ,
sc2diff6          int ,
sc3diff6          int ,
sc4diff6          int ,
sc5diff6          int ,
sc6diff6          int ,
sc7diff6          int ,
sc8diff6          int ,
sc9diff6          int ,
sc10diff6         int ,
sc0diff7          int ,
sc1diff7          int ,
sc2diff7          int ,
sc3diff7          int ,
sc4diff7          int ,
sc5diff7          int ,
sc6diff7          int ,
sc7diff7          int ,
sc8diff7          int ,
sc9diff7          int ,
sc10diff7         int ,
sc0diff8          int ,
sc1diff8          int ,
sc2diff8          int ,
sc3diff8          int ,
sc4diff8          int ,
sc5diff8          int ,
sc6diff8          int ,
sc7diff8          int ,
sc8diff8          int ,
sc9diff8          int ,
sc10diff8         int ,
sc0diff9          int ,
sc1diff9          int ,
sc2diff9          int ,
sc3diff9          int ,
sc4diff9          int ,
sc5diff9          int ,
sc6diff9          int ,
sc7diff9          int ,
sc8diff9          int ,
sc9diff9          int ,
sc10diff9         int ,
sc0diff10         int ,
sc1diff10         int ,
sc2diff10         int ,
sc3diff10         int ,
sc4diff10         int ,
sc5diff10         int ,
sc6diff10         int ,
sc7diff10         int ,
sc8diff10         int ,
sc9diff10         int ,
sc10diff10        int ,
ncrsrp0 int,
ncrsrp1 int,
ncrsrp2 int,
ncrsrp3 int,
ncrsrp4 int,
ncrsrp5 int,
ncrsrp6 int,
ncrsrp7 int,
ncrsrp8 int,
ncrsrp9 int,
ncrsrp10 int,
total_num int,
nc_total_num int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create table if not exists tpl_mro_diff_freq_day
(
m_int_id bigint,
n_int_id bigint,
m_name string,
n_name string,
enodeb_name string,
related_enodeb int,
omc_id int,
enb_id int,
vendor_id int,
n_enb_id int,
m_eutrancell_id string,
m_celllocalid int,
n_eutrancell_id string,
n_celllocalid int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
distince float,
defined_ncell int,
error_flag int,
freqtype int,
sc0diff0 int,
sc1diff0 int,
sc2diff0 int,
sc3diff0 int,
sc4diff0 int,
sc5diff0 int,
sc6diff0 int,
sc7diff0 int,
sc8diff0 int,
sc9diff0 int,
sc10diff0 int,
sc0diff1 int,
sc1diff1 int,
sc2diff1 int,
sc3diff1 int,
sc4diff1 int,
sc5diff1 int,
sc6diff1 int,
sc7diff1 int,
sc8diff1 int,
sc9diff1 int,
sc10diff1 int,
sc0diff2 int,
sc1diff2 int,
sc2diff2 int,
sc3diff2 int,
sc4diff2 int,
sc5diff2 int,
sc6diff2 int,
sc7diff2 int,
sc8diff2 int,
sc9diff2 int,
sc10diff2 int,
sc0diff3 int,
sc1diff3 int,
sc2diff3 int,
sc3diff3 int,
sc4diff3 int,
sc5diff3 int,
sc6diff3 int,
sc7diff3 int,
sc8diff3 int,
sc9diff3 int,
sc10diff3 int,
sc0diff4 int,
sc1diff4 int,
sc2diff4 int,
sc3diff4 int,
sc4diff4 int,
sc5diff4 int,
sc6diff4 int,
sc7diff4 int,
sc8diff4 int,
sc9diff4 int,
sc10diff4 int,
sc0diff5 int,
sc1diff5 int,
sc2diff5 int,
sc3diff5 int,
sc4diff5 int,
sc5diff5 int,
sc6diff5 int,
sc7diff5 int,
sc8diff5 int,
sc9diff5 int,
sc10diff5 int,
sc0diff6 int,
sc1diff6 int,
sc2diff6 int,
sc3diff6 int,
sc4diff6 int,
sc5diff6 int,
sc6diff6 int,
sc7diff6 int,
sc8diff6 int,
sc9diff6 int,
sc10diff6 int,
sc0diff7 int,
sc1diff7 int,
sc2diff7 int,
sc3diff7 int,
sc4diff7 int,
sc5diff7 int,
sc6diff7 int,
sc7diff7 int,
sc8diff7 int,
sc9diff7 int,
sc10diff7 int,
sc0diff8 int,
sc1diff8 int,
sc2diff8 int,
sc3diff8 int,
sc4diff8 int,
sc5diff8 int,
sc6diff8 int,
sc7diff8 int,
sc8diff8 int,
sc9diff8 int,
sc10diff8 int,
sc0diff9 int,
sc1diff9 int,
sc2diff9 int,
sc3diff9 int,
sc4diff9 int,
sc5diff9 int,
sc6diff9 int,
sc7diff9 int,
sc8diff9 int,
sc9diff9 int,
sc10diff9 int,
sc0diff10 int,
sc1diff10 int,
sc2diff10 int,
sc3diff10 int,
sc4diff10 int,
sc5diff10 int,
sc6diff10 int,
sc7diff10 int,
sc8diff10 int,
sc9diff10 int,
sc10diff10 int,
ncrsrp0 int,
ncrsrp1 int,
ncrsrp2 int,
ncrsrp3 int,
ncrsrp4 int,
ncrsrp5 int,
ncrsrp6 int,
ncrsrp7 int,
ncrsrp8 int,
ncrsrp9 int,
ncrsrp10 int,
total_num int,
nc_total_num int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create table if not exists tpl_mro_diff_freqband_day
(
m_int_id bigint,
n_int_id bigint,
m_name string,
n_name string,
enodeb_name string,
related_enodeb int,
omc_id int,
enb_id int,
vendor_id int,
n_enb_id int,
m_eutrancell_id string,
m_celllocalid int,
n_eutrancell_id string,
n_celllocalid int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
distince float,
defined_ncell int,
error_flag int,
freqtype int,
sc0diff0 int,
sc1diff0 int,
sc2diff0 int,
sc3diff0 int,
sc4diff0 int,
sc5diff0 int,
sc6diff0 int,
sc7diff0 int,
sc8diff0 int,
sc9diff0 int,
sc10diff0 int,
sc0diff1 int,
sc1diff1 int,
sc2diff1 int,
sc3diff1 int,
sc4diff1 int,
sc5diff1 int,
sc6diff1 int,
sc7diff1 int,
sc8diff1 int,
sc9diff1 int,
sc10diff1 int,
sc0diff2 int,
sc1diff2 int,
sc2diff2 int,
sc3diff2 int,
sc4diff2 int,
sc5diff2 int,
sc6diff2 int,
sc7diff2 int,
sc8diff2 int,
sc9diff2 int,
sc10diff2 int,
sc0diff3 int,
sc1diff3 int,
sc2diff3 int,
sc3diff3 int,
sc4diff3 int,
sc5diff3 int,
sc6diff3 int,
sc7diff3 int,
sc8diff3 int,
sc9diff3 int,
sc10diff3 int,
sc0diff4 int,
sc1diff4 int,
sc2diff4 int,
sc3diff4 int,
sc4diff4 int,
sc5diff4 int,
sc6diff4 int,
sc7diff4 int,
sc8diff4 int,
sc9diff4 int,
sc10diff4 int,
sc0diff5 int,
sc1diff5 int,
sc2diff5 int,
sc3diff5 int,
sc4diff5 int,
sc5diff5 int,
sc6diff5 int,
sc7diff5 int,
sc8diff5 int,
sc9diff5 int,
sc10diff5 int,
sc0diff6 int,
sc1diff6 int,
sc2diff6 int,
sc3diff6 int,
sc4diff6 int,
sc5diff6 int,
sc6diff6 int,
sc7diff6 int,
sc8diff6 int,
sc9diff6 int,
sc10diff6 int,
sc0diff7 int,
sc1diff7 int,
sc2diff7 int,
sc3diff7 int,
sc4diff7 int,
sc5diff7 int,
sc6diff7 int,
sc7diff7 int,
sc8diff7 int,
sc9diff7 int,
sc10diff7 int,
sc0diff8 int,
sc1diff8 int,
sc2diff8 int,
sc3diff8 int,
sc4diff8 int,
sc5diff8 int,
sc6diff8 int,
sc7diff8 int,
sc8diff8 int,
sc9diff8 int,
sc10diff8 int,
sc0diff9 int,
sc1diff9 int,
sc2diff9 int,
sc3diff9 int,
sc4diff9 int,
sc5diff9 int,
sc6diff9 int,
sc7diff9 int,
sc8diff9 int,
sc9diff9 int,
sc10diff9 int,
sc0diff10 int,
sc1diff10 int,
sc2diff10 int,
sc3diff10 int,
sc4diff10 int,
sc5diff10 int,
sc6diff10 int,
sc7diff10 int,
sc8diff10 int,
sc9diff10 int,
sc10diff10 int,
ncrsrp0 int,
ncrsrp1 int,
ncrsrp2 int,
ncrsrp3 int,
ncrsrp4 int,
ncrsrp5 int,
ncrsrp6 int,
ncrsrp7 int,
ncrsrp8 int,
ncrsrp9 int,
ncrsrp10 int,
total_num int,
nc_total_num int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create EXTERNAL table if not exists tpl_mro_grid_ue_hour
(
uuid    string                    ,
grid_id1    string                ,
Latitude_GridLD1    float         ,
Longitude_GridLD1    float        ,
Latitude_GridRU1    float         ,
Longitude_GridRU1    float        ,
Latitude_GridRD1    float         ,
Longitude_GridRD1    float        ,
Latitude_GridLU1    float         ,
Longitude_GridLU1    float        ,
GeoHash1    string                ,
grid_id2    string                ,
Latitude_GridLD2    float         ,
Longitude_GridLD2    float        ,
Latitude_GridRU2    float         ,
Longitude_GridRU2    float        ,
Latitude_GridRD2    float         ,
Longitude_GridRD2    float        ,
Latitude_GridLU2    float         ,
Longitude_GridLU2    float        ,
GeoHash2    string                ,
grid_id3    string                ,
Latitude_GridLD3    float         ,
Longitude_GridLD3    float        ,
Latitude_GridRU3    float         ,
Longitude_GridRU3    float        ,
Latitude_GridRD3    float         ,
Longitude_GridRD3    float        ,
Latitude_GridLU3    float         ,
Longitude_GridLU3    float        ,
GeoHash3    string                ,
grid_id4   string                 ,
Latitude_GridLD4    float         ,
Longitude_GridLD4    float        ,
Latitude_GridRU4    float         ,
Longitude_GridRU4    float        ,
Latitude_GridRD4    float         ,
Longitude_GridRD4    float        ,
Latitude_GridLU4    float         ,
Longitude_GridLU4    float        ,
GeoHash4    string                ,
grid_id5    string                ,
Latitude_GridLD5    float         ,
Longitude_GridLD5    float        ,
Latitude_GridRU5    float         ,
Longitude_GridRU5    float        ,
Latitude_GridRD5    float         ,
Longitude_GridRD5    float        ,
Latitude_GridLU5    float         ,
Longitude_GridLU5    float        ,
GeoHash5    Varchar(16)           ,
grid_id6    Varchar(64)           ,
Latitude_GridLD6    float         ,
Longitude_GridLD6    float        ,
Latitude_GridRU6    float         ,
Longitude_GridRU6    float        ,
Latitude_GridRD6    float         ,
Longitude_GridRD6    float        ,
Latitude_GridLU6    float         ,
Longitude_GridLU6    float        ,
GeoHash6    Varchar(16)           ,
grid_id7    Varchar(64)           ,
Latitude_GridLD7    float         ,
Longitude_GridLD7    float        ,
Latitude_GridRU7    float         ,
Longitude_GridRU7    float        ,
Latitude_GridRD7    float         ,
Longitude_GridRD7    float        ,
Latitude_GridLU7    float         ,
Longitude_GridLU7    float        ,
GeoHash7    string                ,
grid_id8    string                ,
Latitude_GridLD8    float         ,
Longitude_GridLD8    float        ,
Latitude_GridRU8    float         ,
Longitude_GridRU8    float        ,
Latitude_GridRD8    float         ,
Longitude_GridRD8    float        ,
Latitude_GridLU8    float         ,
Longitude_GridLU8    float        ,
GeoHash8    Varchar(16)           ,
omc_id    varchar(64)             ,
vendor_id   int                   ,
reportTime    string              ,
startTime    string               ,
endTime    string                 ,
enb_id   bigint                   ,
userLabel    string               ,
MmeCode    string                 ,
MmeGroupId    string              ,
MmeUeS1apId    string             ,
Time_Stamp    string              ,
enodebid   int                    ,
CellLocalId   int                 ,
M_int_id   bigint                 ,
LteScRSRP   int                   ,
LteScRSRQ   int                   ,
LteNcRSRP1   int                  ,
LteNcRSRP2   int                  ,
LteScTadv   int                   ,
LteScAOA   int                    ,
LteScEarfcn   int                 ,
LteScPci   int                    ,
LteNcEarfcn1   int                ,
LteNcPci1   int                   ,
LteNcEarfcn2   int                ,
LteNcPci2   int                   ,
LteNcEarfcn3   int                ,
LteNcPci3   int                   ,
LteNcEarfcn4   int                ,
LteNcPci4   int                   ,
LteNcEarfcn5   int                ,
LteNcPci5   int                   ,
LteNcEarfcn6   int                ,
LteNcPci6   int                   ,
N_int_id_1   bigint               ,
N_int_id_2   bigint               ,
Sc_D    float                     ,
Nc_D1    float                    ,
Nc_D2    float                    ,
latitude    float                 ,
longitude    float                ,
Latitude_rsrp    float            ,
Longitude_rsrp    float           ,
Latitude_TaAoa    float           ,
Longitude_TaAoa    float          ,
Case_con   int                    ,
MAXRSRP   int                     ,
UN_MAXRSRP   int                  ,
TE_MAXRSRP   int                  ,
LteScSinrUL   int                 ,
LteScPHR   int                    ,
Diff_6_num   int                  ,
Diff_10_num   int                 ,
Max_rsrp_earfcn   int             ,
Max_rsrp_pci   int                ,
UN_Max_rsrp_earfcn   int          ,
UN_Max_rsrp_pci   int             ,
TE_Max_rsrp_earfcn   int          ,
TE_Max_rsrp_pci   int             ,
Sc_earfcn   int                   ,
Sc_pci   int                      ,
User_type   int                   ,
locate_category   int             ,
related_speed_flag   int          ,
RSRP1   int                       ,
RSRP2   int                       ,
RSRP3   int                       ,
RSRP4   int                       ,
RSRP5   int                       ,
RSRP6   int                       ,
interfere_up1	int,   
interfere_up2	int,
interfere_up3	int,
interfere_up4	int,
interfere_up5	int,
interfere_up6	int,
interfere_down1	float,
interfere_down2	float,
interfere_down3	float,
interfere_down4	float,
interfere_down5	float,
interfere_down6	float
)partitioned by (datepart bigint,omcpart bigint) row format delimited fields terminated by '\|';


create table if not exists tpl_mro_maxrsrp_eutr_day
(
omc_id          int,
int_id          bigint,
related_enodeb  bigint,
enodeb_name     string,
vendor_id       bigint,
enb_id    bigint,
m_eutrancell_id string,
m_celllocalid   int,
scan_start_time string,
scan_stop_time  string,
insert_time    string ,
ne_type        int,
sum_level    int,
maxrsrp_0       int,
maxrsrp_1       int,
maxrsrp_2       int,
maxrsrp_3       int,
maxrsrp_4       int,
maxrsrp_5       int,
maxrsrp_6       int,
maxrsrp_7       int,
maxrsrp_8       int,
maxrsrp_9       int,
maxrsrp_10      int,
total_num       int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create table if not exists tpl_mro_mgrs_numofadj_e_day
(
int_id  bigint,
omc_id  int,
vendor_id  int,
scan_start_time  string,
scan_stop_time  string,
insert_time  string,
ne_type  int,
sum_level  int,
city_id    bigint,
region_id  bigint,
related_enodeb  bigint,
enodeb_name  string,
enodeb_id  int,
eutrancell_id  int,
ecgi  string,
earfcn  int,
pci  int,
grid_id  string,
latitudeld  float,
longitudeld  float,
latituderu  float,
longituderu  float,
num0diff0  int,
num1diff0  int,
num2diff0  int,
num3diff0  int,
num4diff0  int,
num5diff0  int,
num6diff0  int,
num7diff0  int,
num8diff0  int,
num9diff0  int,
num10diff0  int,
num11diff0  int,
num12diff0  int,
num13diff0  int,
num14diff0  int,
num15diff0  int,
num16diff0  int,
num17diff0  int,
num18diff0  int,
num19diff0  int,
num20diff0  int,
num0diff1  int,
num1diff1  int,
num2diff1  int,
num3diff1  int,
num4diff1  int,
num5diff1  int,
num6diff1  int,
num7diff1  int,
num8diff1  int,
num9diff1  int,
num10diff1  int,
num11diff1  int,
num12diff1  int,
num13diff1  int,
num14diff1  int,
num15diff1  int,
num16diff1  int,
num17diff1  int,
num18diff1  int,
num19diff1  int,
num20diff1  int,
total_num  int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create  table if not exists tpl_mro_mgrs_phr_eutr_u_day
(
int_id  bigint,                  
omc_id  int,
vendor_id  int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
city_id           bigint, 
region_id         bigint,
related_enodeb  bigint,
enodeb_name string,
enodeb_id  int,
eutrancell_id  int,
ecgi string,
earfcn  int,
pci  int,
grid_id string,
gis_level string,
geohash int,
latitudeld float,
longitudeld float,
latituderu  float,
longituderu float,
phr_00 int,
phr_01 int,
phr_02 int,
phr_03 int,
phr_04 int,
phr_05 int,
phr_sum float,
phr_count int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create  table if not exists tpl_mro_mgrs_rsrp_eutr_day   
(
int_id    bigint,
vendor_id    int,
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
ne_type    int,
sum_level    int,
city_id bigint,
region_id  bigint,
gis_level    int,
RSRP_0  INT,
RSRP_1  INT,
RSRP_2  INT,
RSRP_3  INT,
RSRP_4  INT,
RSRP_5  INT,
RSRP_6  INT,
RSRP_7  INT,
RSRP_8  INT,
RSRP_9  INT,
RSRP_10 INT,
RSRP_11 INT,
RSRP_SUM FLOAT,
RSRP_count INT,
Rsrp_weak INT,
RSRP_avg FLOAT,
Rsrp_weak_rate FLOAT,
Total_gridnum INT,
Effective_gridnum INT,
Weak_cover_gridnum INT,
maxRSRP_0  INT,
maxRSRP_1  INT,
maxRSRP_2  INT,
maxRSRP_3  INT,
maxRSRP_4  INT,
maxRSRP_5  INT,
maxRSRP_6  INT,
maxRSRP_7  INT,
maxRSRP_8  INT,
maxRSRP_9  INT,
maxRSRP_10 INT,
maxRSRP_11 INT,
MAXRSRP_SUM FLOAT,
MAXRSRP_count INT,
MAXRSRP_weak INT,
MAXRSRP_avg FLOAT,
MAXRSRP_weak_rate FLOAT,
MAXRSRP_Effective_gridnum INT,
MAXRSRP_Weak_cover_gridnum INT,
un_maxRSRP_0  INT,
un_maxRSRP_1  INT,
un_maxRSRP_2  INT,
un_maxRSRP_3  INT,
un_maxRSRP_4  INT,
un_maxRSRP_5  INT,
un_maxRSRP_6  INT,
un_maxRSRP_7  INT,
un_maxRSRP_8  INT,
un_maxRSRP_9  INT,
un_maxRSRP_10 INT,
un_maxRSRP_11 INT,
UN_MAXRSRP_SUM FLOAT,
UN_MAXRSRP_count INT,
UN_MAXRSRP_weak INT,
UN_MAXRSRP_avg FLOAT,
UN_MAXRSRP_weak_rate FLOAT,
UN_MAXRSRP_Effective_gridnum INT,
UN_MAXRSRP_Weak_cover_gridnum INT,
te_maxRSRP_0  INT,
te_maxRSRP_1  INT,
te_maxRSRP_2  INT,
te_maxRSRP_3  INT,
te_maxRSRP_4  INT,
te_maxRSRP_5  INT,
te_maxRSRP_6  INT,
te_maxRSRP_7  INT,
te_maxRSRP_8  INT,
te_maxRSRP_9  INT,
te_maxRSRP_10 INT,
te_maxRSRP_11 INT,
TE_MAXRSRP_SUM FLOAT,
TE_MAXRSRP_count INT,
TE_MAXRSRP_weak INT,
TE_MAXRSRP_avg FLOAT,
TE_MAXRSRP_weak_rate FLOAT,
TE_MAXRSRP_Effective_gridnum INT,
TE_MAXRSRP_Weak_cover_gridnum INT,
inter_maxRSRP_0  INT,
inter_maxRSRP_1  INT,
inter_maxRSRP_2  INT,
inter_maxRSRP_3  INT,
inter_maxRSRP_4  INT,
inter_maxRSRP_5  INT,
inter_maxRSRP_6  INT,
inter_maxRSRP_7  INT,
inter_maxRSRP_8  INT,
inter_maxRSRP_9  INT,
inter_maxRSRP_10 INT,
inter_maxRSRP_11 INT,
INTER_MAXRSRP_SUM FLOAT,
INTER_MAXRSRP_count INT,
INTER_MAXRSRP_weak INT,
INTER_MAXRSRP_avg FLOAT,
INTER_MAXRSRP_weak_rate FLOAT,
INTER_MAXRSRP_Effective_gridnum INT,
INTER_MAXRSRP_Weak_cover_gridnum INT,
Rsrp_weak_l2 INT,
Rsrp_weak_rate_l2 FLOAT,
Weak_cover_gridnum_l2 INT,
MAXRSRP_weak_l2 INT,
MAXRSRP_weak_rate_l2 FLOAT,
MAXRSRP_Weak_cover_gridnum_l2 INT,
UN_MAXRSRP_weak_l2 INT,
UN_MAXRSRP_weak_rate_l2 FLOAT,
un_MAXRSRP_Weak_cover_gridnum_l2 INT,
TE_MAXRSRP_weak_l2 INT,
TE_MAXRSRP_weak_rate_l2 FLOAT,
TE_MAXRSRP_Weak_cover_gridnum_l2 INT,
INTER_MAXRSRP_weak_l2 INT,
INTER_MAXRSRP_weak_rate_l2 FLOAT,
INTER_MAXRSRP_Weak_cover_gridnum_l2 INT
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create  table if not exists tpl_mro_mgrs_rsrp_eutr_u_day
(
int_id   bigint,
scan_start_time   string,
scan_stop_time   string,
insert_time   string,
ne_type   int,
sum_level   int,
city_id bigint,
region_id  bigint,
related_enodeb   bigint,
enodeb_name   string,
enodeb_id   int,
eutrancell_id   int,
ecgi   string,
earfcn   int,
pci   int,
grid_id   string,
gis_level string,
geohash int,
latitudeld   float,
longitudeld   float,
latituderu   float,
longituderu   float,
RSRP_0  INT,
RSRP_1  INT,
RSRP_2  INT,
RSRP_3  INT,
RSRP_4  INT,
RSRP_5  INT,
RSRP_6  INT,
RSRP_7  INT,
RSRP_8  INT,
RSRP_9  INT,
RSRP_10 INT,
RSRP_11 INT,
RSRP_SUM FLOAT,
RSRP_count INT,
Rsrp_weak INT,
RSRP_avg FLOAT,
Rsrp_weak_rate FLOAT,
RSRP_count_type0 INT,
Rsrp_weak_type0 INT,
RSRP_count_type1 INT,
Rsrp_weak_type1 INT,
RSRP_count_type2 INT,
Rsrp_weak_type2 INT,
RSRP_count_type3 INT,
Rsrp_weak_type3 INT,
maxRSRP_0  INT,
maxRSRP_1  INT,
maxRSRP_2  INT,
maxRSRP_3  INT,
maxRSRP_4  INT,
maxRSRP_5  INT,
maxRSRP_6  INT,
maxRSRP_7  INT,
maxRSRP_8  INT,
maxRSRP_9  INT,
maxRSRP_10 INT,
maxRSRP_11 INT,
MAXRSRP_SUM FLOAT,
MAXRSRP_count INT,
MaxRSRP_weak INT,
MAXRSRP_avg FLOAT,
MaxRSRP_weak_rate FLOAT,
MAXRSRP_count_type0 INT,
MaxRSRP_weak_type0 INT,
MAXRSRP_count_type1 INT,
MaxRSRP_weak_type1 INT,
MAXRSRP_count_type2 INT,
MaxRSRP_weak_type2 INT,
MAXRSRP_count_type3 INT,
MaxRSRP_weak_type3 INT,
un_maxRSRP_0  INT,
un_maxRSRP_1  INT,
un_maxRSRP_2  INT,
un_maxRSRP_3  INT,
un_maxRSRP_4  INT,
un_maxRSRP_5  INT,
un_maxRSRP_6  INT,
un_maxRSRP_7  INT,
un_maxRSRP_8  INT,
un_maxRSRP_9  INT,
un_maxRSRP_10 INT,
un_maxRSRP_11 INT,
UN_MAXRSRP_SUM FLOAT,
UN_MAXRSRP_count INT,
UN_MAXRSRP_weak INT,
UN_MAXRSRP_avg FLOAT,
UN_MAXRSRP_weak_rate FLOAT,
UN_MAXRSRP_count_type0 INT,
UN_MAXRSRP_weak_type0 INT,
UN_MAXRSRP_count_type1 INT,
UN_MAXRSRP_weak_type1 INT,
UN_MAXRSRP_count_type2 INT,
UN_MAXRSRP_weak_type2 INT,
UN_MAXRSRP_count_type3 INT,
UN_MAXRSRP_weak_type3 INT,
te_maxRSRP_0  INT,
te_maxRSRP_1  INT,
te_maxRSRP_2  INT,
te_maxRSRP_3  INT,
te_maxRSRP_4  INT,
te_maxRSRP_5  INT,
te_maxRSRP_6  INT,
te_maxRSRP_7  INT,
te_maxRSRP_8  INT,
te_maxRSRP_9  INT,
te_maxRSRP_10 INT,
te_maxRSRP_11 INT,
TE_MAXRSRP_SUM FLOAT,
TE_MAXRSRP_count INT,
TE_MAXRSRP_weak INT,
TE_MAXRSRP_avg FLOAT,
TE_MAXRSRP_weak_rate FLOAT,
TE_MAXRSRP_count_type0 INT,
TE_MAXRSRP_weak_type0 INT,
TE_MAXRSRP_count_type1 INT,
TE_MAXRSRP_weak_type1 INT,
TE_MAXRSRP_count_type2 INT,
TE_MAXRSRP_weak_type2 INT,
TE_MAXRSRP_count_type3 INT,
TE_MAXRSRP_weak_type3 INT,
inter_maxRSRP_0  INT,
inter_maxRSRP_1  INT,
inter_maxRSRP_2  INT,
inter_maxRSRP_3  INT,
inter_maxRSRP_4  INT,
inter_maxRSRP_5  INT,
inter_maxRSRP_6  INT,
inter_maxRSRP_7  INT,
inter_maxRSRP_8  INT,
inter_maxRSRP_9  INT,
inter_maxRSRP_10 INT,
inter_maxRSRP_11 INT,
INTER_MAXRSRP_SUM FLOAT,
INTER_MAXRSRP_count INT,
INTER_MAXRSRP_weak INT,
INTER_MAXRSRP_avg FLOAT,
INTER_MAXRSRP_weak_rate FLOAT,
INTER_MAXRSRP_count_type0 INT,
INTER_MAXRSRP_weak_type0 INT,
INTER_MAXRSRP_count_type1 INT,
INTER_MAXRSRP_weak_type1 INT,
INTER_MAXRSRP_count_type2 INT,
INTER_MAXRSRP_weak_type2 INT,
INTER_MAXRSRP_count_type3 INT,
INTER_MAXRSRP_weak_type3 INT,
Rsrp_weak_l2 INT,
Rsrp_weak_rate_l2 FLOAT,
MAXRSRP_weak_l2 INT,
MAXRSRP_weak_rate_l2 FLOAT,
UN_MAXRSRP_weak_l2 INT,
UN_MAXRSRP_weak_rate_l2 FLOAT,
TE_MAXRSRP_weak_l2 INT,
TE_MAXRSRP_weak_rate_l2 FLOAT,
INTER_MAXRSRP_weak_l2 INT,
INTER_MAXRSRP_weak_rate_l2 FLOAT
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create  table if not exists tpl_mro_mgrs_rsrq_eutr_u_day
(
int_id  bigint,
scan_start_time         string,
scan_stop_time          string,
insert_time             string,
ne_type                 int,
sum_level               int,
city_id          bigint, 
region_id        bigint,
related_enodeb          bigint,
enodeb_name             string,
enodeb_id               int,
eutrancell_id           int,
ecgi                    string,
earfcn                  int,
pci                     int,
grid_id                 string,
gis_level string,
geohash int,
latitudeld  float,
longitudeld float,
latituderu  float,
longituderu float,
rsrq_00                 int,
rsrq_01                 int,
rsrq_02                 int,
rsrq_03                 int,
rsrq_04                 int,
rsrq_05                 int,
rsrq_06                 int,
rsrq_07                 int,
rsrq_sum                float,
rsrq_count              int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create  table if not exists tpl_mro_mgrs_sinrd_eutr_u_day
(
int_id  bigint,
omc_id  int,
vendor_id  int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
city_id          bigint, 
region_id        bigint,
related_enodeb  bigint,
enodeb_name string,
enodeb_id  int,
eutrancell_id  int,
ecgi string,
earfcn  int,
pci  int,
grid_id string,
gis_level string,
geohash int,
latitudeld  float,
longitudeld float,
latituderu  float,
longituderu float,
sinrdl_0 int,
sinrdl_1 int,
sinrdl_2 int,
sinrdl_3 int,
sinrdl_4 int,
sinrdl_5 int,
sinrdl_6 int,
sinrdl_7 int,
sinrdl_8 int,
sinrdl_9 int,
sinrdl_10 int,
sinrdl_11 int,
sinrdl_12 int,
sinrdl_13 int,
sinrdl_14 int,
sinrdl_15 int,
sinrdl_16 int,
sinrdl_17 int,
sinrdl_18 int,
sinrdl_19 int,
sinrdl_20 int,
sinrdl_21 int,
sinrdl_22 int,
sinrdl_23 int,
sinrdl_24 int,
sinrdl_25 int,
sinrdl_26 int,
sinrdl_27 int,
sinrdl_28 int,
sinrdl_29 int,
sinrdl_30 int,
sinrdl_31 int,
sinrdl_32 int,
sinrdl_33 int,
sinrdl_34 int,
sinrdl_35 int,
sinrdl_36 int,
sinrdl_37 int,
sinrdl_38 int,
sinrdl_39 int,
sinrdl_40 int,
sinrdl_41 int,
sinrdl_42 int,
sinrdl_43 int,
sinrdl_44 int,
sinrdl_45 int,
sinrdl_46 int,
sinrdl_47 int,
sinrdl_48 int,
sinrdl_49 int,
sinrdl_50 int,
sinrdl_51 int,
sinrdl_52 int,
sinrdl_53 int,
sinrdl_54 int,
sinrdl_55 int,
sinrdl_56 int,
sinrdl_sum float,
sinrdl_count int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create  table if not exists tpl_mro_sinrul_day 
(
int_id    bigint,
omc_id    int,
vendor_id    int,
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
ne_type    int,
sum_level    int,
related_enodeb    bigint,
enodeb_name    string,
enodeb_id    int,
eutrancell_id    int,
sinrul_00    int,
sinrul_01    int,
sinrul_02    int,
sinrul_03    int,
sinrul_04    int,
sinrul_05    int,
sinrul_06    int,
sinrul_07    int,
sinrul_08    int,
sinrul_09    int,
sinrul_10    int,
sinrul_11    int,
sinrul_12    int,
sinrul_13    int,
sinrul_14    int,
sinrul_15    int,
sinrul_16    int,
sinrul_17    int,
sinrul_18    int,
sinrul_19    int,
sinrul_20    int,
sinrul_21    int,
sinrul_22    int,
sinrul_23    int,
sinrul_24    int,
sinrul_25    int,
sinrul_26    int,
sinrul_27    int,
sinrul_28    int,
sinrul_29    int,
sinrul_30    int,
sinrul_31    int,
sinrul_32    int,
sinrul_33    int,
sinrul_34    int,
sinrul_35    int,
sinrul_36    int,
sinrul_sum    float,
sinrul_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists tpl_mro_rsrprssi_day
(
int_id bigint,
m_int_id bigint,
n_int_id bigint,
m_name string,
n_name string,
enodeb_name string,
related_enodeb bigint,
omc_id int,
enb_id int,
vendor_id int,
m_eutrancell_id string,
m_celllocalid int,
n_lac int,
n_ci int,
n_cgi string,
scan_start_time string,
ncc int,
bcc int,
bcch int,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
distince float,
defined_ncell int,
error_flag int,
sc0rssi0 int,
sc0rssi1 int,
sc0rssi2 int,
sc0rssi3 int,
sc0rssi4 int,
sc0rssi5 int,
sc0rssi6 int,
sc0rssi7 int,
sc0rssi8 int,
sc0rssi9 int,
sc1rssi0 int,
sc1rssi1 int,
sc1rssi2 int,
sc1rssi3 int,
sc1rssi4 int,
sc1rssi5 int,
sc1rssi6 int,
sc1rssi7 int,
sc1rssi8 int,
sc1rssi9 int,
sc2rssi0 int,
sc2rssi1 int,
sc2rssi2 int,
sc2rssi3 int,
sc2rssi4 int,
sc2rssi5 int,
sc2rssi6 int,
sc2rssi7 int,
sc2rssi8 int,
sc2rssi9 int,
sc3rssi0 int,
sc3rssi1 int,
sc3rssi2 int,
sc3rssi3 int,
sc3rssi4 int,
sc3rssi5 int,
sc3rssi6 int,
sc3rssi7 int,
sc3rssi8 int,
sc3rssi9 int,
sc4rssi0 int,
sc4rssi1 int,
sc4rssi2 int,
sc4rssi3 int,
sc4rssi4 int,
sc4rssi5 int,
sc4rssi6 int,
sc4rssi7 int,
sc4rssi8 int,
sc4rssi9 int,
sc5rssi0 int,
sc5rssi1 int,
sc5rssi2 int,
sc5rssi3 int,
sc5rssi4 int,
sc5rssi5 int,
sc5rssi6 int,
sc5rssi7 int,
sc5rssi8 int,
sc5rssi9 int,
sc6rssi0 int,
sc6rssi1 int,
sc6rssi2 int,
sc6rssi3 int,
sc6rssi4 int,
sc6rssi5 int,
sc6rssi6 int,
sc6rssi7 int,
sc6rssi8 int,
sc6rssi9 int,
sc7rssi0 int,
sc7rssi1 int,
sc7rssi2 int,
sc7rssi3 int,
sc7rssi4 int,
sc7rssi5 int,
sc7rssi6 int,
sc7rssi7 int,
sc7rssi8 int,
sc7rssi9 int,
sc8rssi0 int,
sc8rssi1 int,
sc8rssi2 int,
sc8rssi3 int,
sc8rssi4 int,
sc8rssi5 int,
sc8rssi6 int,
sc8rssi7 int,
sc8rssi8 int,
sc8rssi9 int,
sc9rssi0 int,
sc9rssi1 int,
sc9rssi2 int,
sc9rssi3 int,
sc9rssi4 int,
sc9rssi5 int,
sc9rssi6 int,
sc9rssi7 int,
sc9rssi8 int,
sc9rssi9 int,
sc10rssi0 int,
sc10rssi1 int,
sc10rssi2 int,
sc10rssi3 int,
sc10rssi4 int,
sc10rssi5 int,
sc10rssi6 int,
sc10rssi7 int,
sc10rssi8 int,
sc10rssi9 int,
ncrssi0   int, 
ncrssi1   int, 
ncrssi2   int, 
ncrssi3   int, 
ncrssi4   int, 
ncrssi5   int, 
ncrssi6   int, 
ncrssi7   int, 
ncrssi8   int, 
ncrssi9   int, 
total_num int,
nc_total_num int,
total_num_85 int,
total_num_90 int,
total_num_95 int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists tpl_mro_rsrpdiff_eutr_day
(
omc_id            int,
int_id          bigint,
related_enodeb  bigint,
enodeb_name     string,
vendor_id       bigint,
enb_id          bigint,
m_eutrancell_id string,
m_celllocalid   int,
scan_start_time string,
scan_stop_time  string,
insert_time    string ,
ne_type         int,
sum_level       int,
rsrpdiff_0  int ,
rsrpdiff_1  int ,
rsrpdiff_2  int ,
rsrpdiff_3  int ,
rsrpdiff_4  int ,
rsrpdiff_5  int ,
rsrpdiff_6  int ,
rsrpdiff_7  int ,
rsrpdiff_8  int ,
rsrpdiff_9  int ,
rsrpdiff_10 int ,
rsrpdiff_11 int ,
rsrpdiff_12 int ,
rsrpdiff_13 int ,
rsrpdiff_14 int ,
rsrpdiff_15 int ,
rsrpdiff_16 int ,
rsrpdiff_17 int ,
rsrpdiff_18 int ,
rsrpdiff_19 int ,
rsrpdiff_20 int ,
rsrpdiff_21 int ,
rsrpdiff_22 int ,
rsrpdiff_23 int ,
rsrpdiff_24 int ,
rsrpdiff_25 int ,
rsrpdiff_26 int 
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists tpl_mro_rsrp_day
(
int_id  bigint,
omc_id int,
vendor_id int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
related_enodeb  bigint,
enodeb_name string,
enodeb_id int,
eutrancell_id int,
RSRP_0  INT,
RSRP_1  INT,
RSRP_2  INT,
RSRP_3  INT,
RSRP_4  INT,
RSRP_5  INT,
RSRP_6  INT,
RSRP_7  INT,
RSRP_8  INT,
RSRP_9  INT,
RSRP_10 INT,
RSRP_11 INT,
rsrp_sum float,
rsrp_count  int,
rsrp_avg float,
rsrp_lt_f110 int,
rsrp_lt_f113 int,
rsrp_lt_f115 int,
un_maxRSRP_0  INT,
un_maxRSRP_1  INT,
un_maxRSRP_2  INT,
un_maxRSRP_3  INT,
un_maxRSRP_4  INT,
un_maxRSRP_5  INT,
un_maxRSRP_6  INT,
un_maxRSRP_7  INT,
un_maxRSRP_8  INT,
un_maxRSRP_9  INT,
un_maxRSRP_10 INT,
un_maxRSRP_11 INT,
un_maxrsrp_sum    float,
un_maxrsrp_count    int,
un_maxrsrp_avg  float,
un_maxrsrp_lt_f110 int,
un_maxrsrp_lt_f113 int,
un_maxrsrp_lt_f115 int,
te_maxRSRP_0  INT,
te_maxRSRP_1  INT,
te_maxRSRP_2  INT,
te_maxRSRP_3  INT,
te_maxRSRP_4  INT,
te_maxRSRP_5  INT,
te_maxRSRP_6  INT,
te_maxRSRP_7  INT,
te_maxRSRP_8  INT,
te_maxRSRP_9  INT,
te_maxRSRP_10 INT,
te_maxRSRP_11 INT,
te_maxrsrp_sum    float,
te_maxrsrp_count    int,
te_maxrsrp_avg  float,
te_maxrsrp_lt_f110 int,
te_maxrsrp_lt_f113 int,
te_maxrsrp_lt_f115 int,
inter_maxRSRP_0  INT,
inter_maxRSRP_1  INT,
inter_maxRSRP_2  INT,
inter_maxRSRP_3  INT,
inter_maxRSRP_4  INT,
inter_maxRSRP_5  INT,
inter_maxRSRP_6  INT,
inter_maxRSRP_7  INT,
inter_maxRSRP_8  INT,
inter_maxRSRP_9  INT,
inter_maxRSRP_10 INT,
inter_maxRSRP_11 INT,
inter_maxrsrp_sum    float,
inter_maxrsrp_count    int,
inter_maxrsrp_avg  float,
inter_maxrsrp_lt_f110 int,
inter_maxrsrp_lt_f113 int,
inter_maxrsrp_lt_f115 int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create  table if not exists tpl_mro_rip_day
(
int_id    bigint,
omc_id    int,
vendor_id    int,
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
ne_type    int,
sum_level    int,
related_enodeb    bigint,
enodeb_name    string,
enodeb_id    int,
eutrancell_id    int,
rip_00    int,
rip_01    int,
rip_02    int,
rip_03    int,
rip_04    int,
rip_05    int,
rip_06    int,
rip_07    int,
rip_08    int,
rip_09    int,
rip_10    int,
rip_11    int,
rip_12    int,
rip_13    int,
rip_14    int,
rip_15    int,
rip_16    int,
rip_17    int,
rip_18    int,
rip_19    int,
rip_20    int,
rip_21    int,
rip_22    int,
rip_23    int,
rip_24    int,
rip_25    int,
rip_26    int,
rip_27    int,
rip_28    int,
rip_29    int,
rip_30    int,
rip_31    int,
rip_32    int,
rip_33    int,
rip_34    int,
rip_35    int,
rip_36    int,
rip_37    int,
rip_38    int,
rip_39    int,
rip_40    int,
rip_41    int,
rip_42    int,
rip_43    int,
rip_44    int,
rip_45    int,
rip_46    int,
rip_47    int,
rip_48    int,
rip_49    int,
rip_50    int,
rip_51    int,
rip_52    int,
rip_53    int,
rip_54    int,
rip_55    int,
rip_56    int,
rip_57    int,
rip_58    int,
rip_59    int,
rip_60    int,
rip_61    int,
rip_62    int,
rip_63    int,
rip_64    int,
rip_65    int,
rip_66    int,
rip_67    int,
rip_68    int,
rip_69    int,
rip_70    int,
rip_71    int,
rip_72    int,
rip_73    int,
rip_74    int,
rip_75    int,
rip_76    int,
rip_77    int,
rip_78    int,
rip_79    int,
rip_80    int,
rip_81    int,
rip_82    int,
rip_83    int,
rip_84    int,
rip_85    int,
rip_86    int,
rip_87    int,
rip_88    int,
rip_89    int,
rip_90    int,
rip_91    int,
rip_92    int,
rip_93    int,
rip_94    int,
rip_95    int,
rip_96    int,
rip_97    int,
rip_98    int,
rip_99    int,
rip_100    int,
rip_101    int,
rip_102    int,
rip_103    int,
rip_sum    float,
rip_count    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists tpl_mro_pol_adj_day
(
int_id        bigint,
omc_id        string,
vendor_id        int,
m_name        string,
m_int_id        bigint,
m_celllocalid        int,
enodeb_name        string,
related_enodeb        int,
n_name        string,
n_int_id        bigint,
n_celllocalid        int,
enb_id        int,
n_enb_id        int,
scan_start_time        string,
scan_stop_time        string,
scearfcn        int,
scpci        int,
ncearfcn        int,
ncpci        int,
insert_time    string,
ne_type      int,
sum_level    int,
city_id bigint,
region_id bigint,
defined_ncell        int,
tdl_ave_rscp_sc        float,
tdl_ave_rsrp_sc_all    float,
tdl_tim        int,
tdl_ave_rscp_nc        float,
tdl_tim_alone        int,
nrsrp_threshold_count        int,
tdl_tim_max        int,
tdl_tim_ncrsrp        int,
tdl_tim1        int,
tdl_tim2        int,
tdl_tim3        int,
tdl_tim4        int,
tdl_tim5        int,
tdl_tim6        int,
tdl_tim1_ncrsrp        float,
tdl_tim2_ncrsrp        float,
tdl_tim3_ncrsrp        float,
tdl_tim4_ncrsrp        float,
tdl_tim5_ncrsrp        float,
tdl_tim6_ncrsrp        float,
overlap_count1        int,
overlap_count2        int,
tdl_ave_rscp_nc_overlap_condi1        float,
tdl_tim1_overlap_condi1        int,
tdl_tim2_overlap_condi1        int,
tdl_tim3_overlap_condi1        int,
tdl_tim4_overlap_condi1        int,
tdl_tim5_overlap_condi1        int,
tdl_tim6_overlap_condi1        int,
tdl_tim1_overlap_condi1_ncrsrp        float,
tdl_tim2_overlap_condi1_ncrsrp        float,
tdl_tim3_overlap_condi1_ncrsrp        float,
tdl_tim4_overlap_condi1_ncrsrp        float,
tdl_tim5_overlap_condi1_ncrsrp        float,
tdl_tim6_overlap_condi1_ncrsrp        float,
tdl_ave_rscp_nc_overlap_condi2        float,
tdl_tim1_overlap_condi2        int,
tdl_tim2_overlap_condi2        int,
tdl_tim3_overlap_condi2        int,
tdl_tim4_overlap_condi2        int,
tdl_tim5_overlap_condi2        int,
tdl_tim6_overlap_condi2        int,
tdl_tim1_overlap_condi2_ncrsrp        float,
tdl_tim2_overlap_condi2_ncrsrp        float,
tdl_tim3_overlap_condi2_ncrsrp        float,
tdl_tim4_overlap_condi2_ncrsrp        float,
tdl_tim5_overlap_condi2_ncrsrp        float,
tdl_tim6_overlap_condi2_ncrsrp        float,
scrsrp_sum int,
total_num int,
rsrpdiff_abssum int,
rsrpdiff_absavg float,
ncrsrp_0    int,
ncrsrp_1    int,
ncrsrp_2    int,
ncrsrp_3    int,
ncrsrp_4    int,
ncrsrp_5    int,
ncrsrp_6    int,
ncrsrp_7    int,
ncrsrp_8    int,
ncrsrp_9    int,
ncrsrp_10    int,
ncrsrp_11    int,
ncrsrp_12    int,
ncrsrp_13    int,
ncrsrp_14    int,
ncrsrp_15    int,
ncrsrp_16    int,
ncrsrp_17    int,
ncrsrp_18    int,
ncrsrp_19    int,
ncrsrp_20    int,
ncrsrp_21    int,
ncrsrp_22    int,
ncrsrp_23    int,
ncrsrp_24    int,
ncrsrp_25    int,
ncrsrp_26    int,
ncrsrp_27    int,
ncrsrp_28    int,
ncrsrp_29    int,
ncrsrp_30    int,
ncrsrp_31    int,
ncrsrp_32    int,
ncrsrp_33    int,
ncrsrp_34    int,
ncrsrp_35    int,
ncrsrp_36    int,
ncrsrp_37    int,
ncrsrp_38    int,
ncrsrp_39    int,
ncrsrp_40    int,
ncrsrp_41    int,
ncrsrp_42    int,
ncrsrp_43    int,
ncrsrp_44    int,
ncrsrp_45    int,
ncrsrp_46    int,
ncrsrp_47    int,
ncrsrp_48    int,
ncrsrp_49    int,
ncrsrp_50    int,
ncrsrp_51    int,
ncrsrp_52    int,
ncrsrp_53    int,
ncrsrp_54    int,
ncrsrp_55    int,
ncrsrp_56    int,
ncrsrp_57    int,
ncrsrp_58    int,
ncrsrp_59    int,
ncrsrp_60    int,
ncrsrp_61    int,
ncrsrp_62    int,
ncrsrp_63    int,
ncrsrp_64    int,
ncrsrp_65    int,
ncrsrp_66    int,
ncrsrp_67    int,
ncrsrp_68    int,
ncrsrp_69    int,
ncrsrp_70    int,
ncrsrp_71    int,
ncrsrp_72    int,
ncrsrp_73    int,
ncrsrp_74    int,
ncrsrp_75    int,
ncrsrp_76    int,
ncrsrp_77    int,
ncrsrp_78    int,
ncrsrp_79    int,
ncrsrp_80    int,
ncrsrp_81    int,
ncrsrp_82    int,
ncrsrp_83    int,
ncrsrp_84    int,
ncrsrp_85    int,
ncrsrp_86    int,
ncrsrp_87    int,
ncrsrp_88    int,
ncrsrp_89    int,
ncrsrp_90    int,
ncrsrp_91    int,
ncrsrp_92    int,
ncrsrp_93    int,
ncrsrp_94    int,
ncrsrp_95    int,
ncrsrp_96    int,
ncrsrp_97    int,
ncrsrp_sum    float,
ncrsrp_count    int,
nc_netype    int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists tpl_mro_overlap_day
(
omc_id         int,
int_id          bigint,
related_enodeb    bigint,
enodeb_name string,
vendor_id  bigint,
enb_id          bigint,
m_eutrancell_id         string,
m_celllocalid      string,
scan_start_time string,
scan_stop_time  string,
insert_time string,
ne_type     int,
sum_level   int,
diffdbm_0  int ,
diffdbm_1  int ,
diffdbm_2  int ,
diffdbm_3  int ,
diffdbm_4  int ,
diffdbm_5  int ,
diffdbm_6  int ,
diffdbm_7  int ,
diffdbm_8  int ,
diffdbm_9  int ,
diffdbm_10 int ,
diffdbm_11 int ,
diffdbm_12 int ,
diffdbm_13 int ,
diffdbm_14 int ,
diffdbm_15 int ,
diffdbm_16 int ,
diffdbm_17 int ,
diffdbm_18 int ,
diffdbm_19 int ,
diffdbm_20 int ,
diffdbm_21 int ,
diffdbm_22 int ,
diffdbm_23 int ,
diffdbm_24 int ,
diffdbm_25 int ,
diffdbm_26 int ,
diffdbm_27 int ,
diffdbm_28 int ,
diffdbm_29 int ,
diffdbm_30 int ,
diffdbm_31 int ,
diffdbm_32 int ,
diffdbm_33 int ,
diffdbm_34 int ,
diffdbm_35 int ,
diffdbm_36 int ,
diffdbm_37 int ,
diffdbm_38 int ,
diffdbm_39 int ,
diffdbm_40 int ,
diffdbm_41 int ,
diffdbm_42 int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';



create table if not exists tpl_mro_mgrs_sinru_eutr_u_day
(
int_id  bigint,
omc_id  int,
vendor_id  int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
city_id bigint,
region_id  bigint,
related_enodeb  bigint,
enodeb_name string,
enodeb_id  int,
eutrancell_id  int,
ecgi string,
earfcn  int,
pci  int,
grid_id string,
gis_level int,
geohash string,
latitudeld  float,
longitudeld float,
latituderu  float,
longituderu float,
sinrul_0 int,
sinrul_1 int,
sinrul_2 int,
sinrul_3 int,
sinrul_4 int,
sinrul_5 int,
sinrul_6 int,
sinrul_sum float,
sinrul_count int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|'; 


create  table if not exists tpl_mro_mgrs_user_maxrsrp_day
(
int_id    bigint,
omc_id    int,
vendor_id    int,
m_name    string,
m_int_id    bigint,
m_celllocalid    int,  
m_enb_id    int,
m_ecgi    string,
m_enodeb_name    string,
m_related_enodeb    int,
enodeb_name  string,
Related_enodeb   int,
n_name    string,
n_int_id    bigint,
n_celllocalid    int,
enb_id int,
n_enb_id    int,
n_ecgi    string,
n_enodeb_name    string,
n_related_enodeb    int,
scan_start_time    string,
scan_stop_time    string,
scearfcn    int,
scpci    int,
ncearfcn    int,
ncpci    int,
insert_time    string,
ne_type    int,
sum_level    int,
city_id    bigint,
region_id    bigint,
defined_ncell    int,
grid_id    string,
GIS_level int,
GeoHash string,
user_type    int,
latitudeld    float,
longitudeld    float,
latituderu    float,
longituderu    float,
RSRP_0  INT,
RSRP_1  INT,
RSRP_2  INT,
RSRP_3  INT,
RSRP_4  INT,
RSRP_5  INT,
RSRP_6  INT,
RSRP_7  INT,
RSRP_8  INT,
RSRP_9  INT,
RSRP_10 INT,
RSRP_11 INT,
RSRP_SUM FLOAT,
RSRP_count INT,
Rsrp_weak INT,
NC_neType INT
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create  table if not exists tpl_mro_mgrs_user_phr_day
(
int_id  bigint,
omc_id  int,
vendor_id  int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
city_id           bigint, 
region_id         bigint,
related_enodeb  bigint,
enodeb_name string,
enodeb_id  int,
eutrancell_id  int,
ecgi string,
earfcn  int,
pci  int,
grid_id string,
GIS_level int,
GeoHash string,
user_type  int,
latitudeld float,
longitudeld float,
latituderu  float,
longituderu float,
phr_00 int,
phr_01 int,
phr_02 int,
phr_03 int,
phr_04 int,
phr_05 int,
phr_sum float,
phr_count int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create  table if not exists tpl_mro_mgrs_user_rsrp_day
(
int_id  bigint,
omc_id  int,
vendor_id  int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type  int,
sum_level  int,
city_id bigint,
region_id bigint,
related_enodeb  bigint,
enodeb_name string,
enodeb_id  int,
eutrancell_id  int,
ecgi string,
earfcn  int,
pci  int,
grid_id string,
GIS_level int,
GeoHash  string,
user_type  int,
latitudeld  float,
longitudeld  float,
latituderu  float,
longituderu  float,
RSRP_0  INT,
RSRP_1  INT,
RSRP_2  INT,
RSRP_3  INT,
RSRP_4  INT,
RSRP_5  INT,
RSRP_6  INT,
RSRP_7  INT,
RSRP_8  INT,
RSRP_9  INT,
RSRP_10 INT,
RSRP_11 INT,
RSRP_SUM FLOAT,
RSRP_count INT,
Rsrp_weak INT,
maxRSRP_0  INT,
maxRSRP_1  INT,
maxRSRP_2  INT,
maxRSRP_3  INT,
maxRSRP_4  INT,
maxRSRP_5  INT,
maxRSRP_6  INT,
maxRSRP_7  INT,
maxRSRP_8  INT,
maxRSRP_9  INT,
maxRSRP_10 INT,
maxRSRP_11 INT,
MAXRSRP_SUM FLOAT,
MAXRSRP_count INT,
MAXRSRP_weak INT,
un_maxRSRP_0  INT,
un_maxRSRP_1  INT,
un_maxRSRP_2  INT,
un_maxRSRP_3  INT,
un_maxRSRP_4  INT,
un_maxRSRP_5  INT,
un_maxRSRP_6  INT,
un_maxRSRP_7  INT,
un_maxRSRP_8  INT,
un_maxRSRP_9  INT,
un_maxRSRP_10 INT,
un_maxRSRP_11 INT,
UN_MAXRSRP_SUM FLOAT,
UN_MAXRSRP_count INT,
UN_MAXRSRP_weak INT,
te_maxRSRP_0  INT,
te_maxRSRP_1  INT,
te_maxRSRP_2  INT,
te_maxRSRP_3  INT,
te_maxRSRP_4  INT,
te_maxRSRP_5  INT,
te_maxRSRP_6  INT,
te_maxRSRP_7  INT,
te_maxRSRP_8  INT,
te_maxRSRP_9  INT,
te_maxRSRP_10 INT,
te_maxRSRP_11 INT,
TE_MAXRSRP_SUM FLOAT,
TE_MAXRSRP_count INT,
TE_MAXRSRP_weak INT,
inter_maxRSRP_0  INT,
inter_maxRSRP_1  INT,
inter_maxRSRP_2  INT,
inter_maxRSRP_3  INT,
inter_maxRSRP_4  INT,
inter_maxRSRP_5  INT,
inter_maxRSRP_6  INT,
inter_maxRSRP_7  INT,
inter_maxRSRP_8  INT,
inter_maxRSRP_9  INT,
inter_maxRSRP_10 INT,
inter_maxRSRP_11 INT,
INTER_MAXRSRP_SUM FLOAT,
INTER_MAXRSRP_count INT,
INTER_MAXRSRP_weak INT,
Rsrp_weak_l2    INT,
MAXRSRP_weak_l2    INT,
UN_MAXRSRP_weak_l2    INT,
TE_MAXRSRP_weak_l2    INT,
INTER_MAXRSRP_weak_l2    INT
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create  table if not exists tpl_mro_mgrs_user_rsrq_day
(
int_id                  bigint,
omc_id                  int,
vendor_id               int,
scan_start_time         string,
scan_stop_time          string,
insert_time             string,
ne_type                 int,
sum_level               int,
city_id          bigint, 
region_id        bigint,
related_enodeb          bigint,
enodeb_name             string,
enodeb_id               int,
eutrancell_id           int,
ecgi                    string,
earfcn                  int,
pci                     int,
grid_id                 string,
GIS_level int,
GeoHash string,
user_type               int,
latitudeld              float,
longitudeld             float,
latituderu              float,
longituderu             float,
rsrq_00                 int,
rsrq_01                 int,
rsrq_02                 int,
rsrq_03                 int,
rsrq_04                 int,
rsrq_05                 int,
rsrq_06                 int,
rsrq_07                 int,
rsrq_sum                float,
rsrq_count              int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create  table if not exists tpl_mro_mgrs_user_sinrd_day
(
int_id  bigint,
omc_id  int,
vendor_id  int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
city_id          bigint, 
region_id        bigint,
related_enodeb  bigint,
enodeb_name string,
enodeb_id  int,
eutrancell_id  int,
ecgi string,
earfcn  int,
pci  int,
grid_id string,
GIS_level  int,
GeoHash string,
user_type  int,
latitudeld  float,
longitudeld float,
latituderu  float,
longituderu float,
sinrdl_0 int,
sinrdl_1 int,
sinrdl_2 int,
sinrdl_3 int,
sinrdl_4 int,
sinrdl_5 int,
sinrdl_6 int,
sinrdl_7 int,
sinrdl_8 int,
sinrdl_9 int,
sinrdl_10 int,
sinrdl_11 int,
sinrdl_12 int,
sinrdl_13 int,
sinrdl_14 int,
sinrdl_15 int,
sinrdl_16 int,
sinrdl_17 int,
sinrdl_18 int,
sinrdl_19 int,
sinrdl_20 int,
sinrdl_21 int,
sinrdl_22 int,
sinrdl_23 int,
sinrdl_24 int,
sinrdl_25 int,
sinrdl_26 int,
sinrdl_27 int,
sinrdl_28 int,
sinrdl_29 int,
sinrdl_30 int,
sinrdl_31 int,
sinrdl_32 int,
sinrdl_33 int,
sinrdl_34 int,
sinrdl_35 int,
sinrdl_36 int,
sinrdl_37 int,
sinrdl_38 int,
sinrdl_39 int,
sinrdl_40 int,
sinrdl_41 int,
sinrdl_42 int,
sinrdl_43 int,
sinrdl_44 int,
sinrdl_45 int,
sinrdl_46 int,
sinrdl_47 int,
sinrdl_48 int,
sinrdl_49 int,
sinrdl_50 int,
sinrdl_51 int,
sinrdl_52 int,
sinrdl_53 int,
sinrdl_54 int,
sinrdl_55 int,
sinrdl_56 int,
sinrdl_sum float,
sinrdl_count int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create table if not exists tpl_mro_mgrs_user_sinru_day
(
int_id  bigint,
omc_id  int,
vendor_id  int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
city_id bigint,
region_id  bigint,
related_enodeb  bigint,
enodeb_name string,
enodeb_id  int,
eutrancell_id  int,
ecgi string,
earfcn  int,
pci  int,
grid_id string,
GIS_level int,
GeoHash string,
user_type  int,
latitudeld float,
longitudeld float,
latituderu float,
longituderu float,
sinrul_0 int,
sinrul_1 int,
sinrul_2 int,
sinrul_3 int,
sinrul_4 int,
sinrul_5 int,
sinrul_6 int,
sinrul_sum float,
sinrul_count int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|'; 

create table if not exists tpl_mro_numofadj_eutr_day
(
int_id bigint,
vendor_id int,
name string,
related_enodeb bigint,
enodeb_name string,
enb_id int,
eutrancell_id string,
celllocalid int,
omc_id int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
num0diff0 int,
num1diff0 int,
num2diff0 int,
num3diff0 int,
num4diff0 int,
num5diff0 int,
num6diff0 int,
num7diff0 int,
num8diff0 int,
num9diff0 int,
num10diff0 int,
num11diff0 int,
num12diff0 int,
num13diff0 int,
num14diff0 int,
num15diff0 int,
num16diff0 int,
num17diff0 int,
num18diff0 int,
num19diff0 int,
num20diff0 int,
num0diff1 int,
num1diff1 int,
num2diff1 int,
num3diff1 int,
num4diff1 int,
num5diff1 int,
num6diff1 int,
num7diff1 int,
num8diff1 int,
num9diff1 int,
num10diff1 int,
num11diff1 int,
num12diff1 int,
num13diff1 int,
num14diff1 int,
num15diff1 int,
num16diff1 int,
num17diff1 int,
num18diff1 int,
num19diff1 int,
num20diff1 int,
total_num int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|'; 

create  table if not exists tpl_mro_mgrs_maxrsrp_eutr_u_day
(
int_id    bigint,
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
ne_type    int,
sum_level    int,
city_id    bigint,
region_id    bigint,
related_enodeb    bigint,
enodeb_name    string,
enodeb_id    int,
eutrancell_id    int,
ecgi   string,
earfcn    int,
pci    int,
grid_id    string,
gis_level string,
geohash int,
latitudeld    float,
longitudeld    float,
latituderu    float,
longituderu    float,
RSRP_0  INT,
RSRP_1  INT,
RSRP_2  INT,
RSRP_3  INT,
RSRP_4  INT,
RSRP_5  INT,
RSRP_6  INT,
RSRP_7  INT,
RSRP_8  INT,
RSRP_9  INT,
RSRP_10 INT,
RSRP_11 INT,
rsrp_sum    float,
rsrp_count    int,
rsrp_weak    int,
rsrp_avg    float,
rsrp_weak_rate    float,
rsrp_weak_l2    int,
rsrp_weak_rate_l2   float
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create  table if not exists tpl_mro_un_mgrs_maxrsrp_eutr_u_day
(
int_id    bigint,
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
ne_type    int,
sum_level    int,
city_id    bigint,
region_id    bigint,
related_enodeb    bigint,
enodeb_name    string,
enodeb_id    int,
eutrancell_id    int,
ecgi   string,
earfcn    int,
pci    int,
grid_id    string,
gis_level string,
geohash int,
latitudeld    float,
longitudeld    float,
latituderu    float,
longituderu    float,
RSRP_0  INT,
RSRP_1  INT,
RSRP_2  INT,
RSRP_3  INT,
RSRP_4  INT,
RSRP_5  INT,
RSRP_6  INT,
RSRP_7  INT,
RSRP_8  INT,
RSRP_9  INT,
RSRP_10 INT,
RSRP_11 INT,
rsrp_sum    float,
rsrp_count    int,
rsrp_weak    int,
rsrp_avg    float,
rsrp_weak_rate    float,
rsrp_weak_l2    int,
rsrp_weak_rate_l2   float
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create  table if not exists tpl_mro_te_mgrs_maxrsrp_eutr_u_day
(
int_id    bigint,
scan_start_time    string,
scan_stop_time    string,
insert_time    string,
ne_type    int,
sum_level    int,
city_id    bigint,
region_id    bigint,
related_enodeb    bigint,
enodeb_name    string,
enodeb_id    int,
eutrancell_id    int,
ecgi   string,
earfcn    int,
pci    int,
grid_id    string,
gis_level string,
geohash int,
latitudeld    float,
longitudeld    float,
latituderu    float,
longituderu    float,
RSRP_0  INT,
RSRP_1  INT,
RSRP_2  INT,
RSRP_3  INT,
RSRP_4  INT,
RSRP_5  INT,
RSRP_6  INT,
RSRP_7  INT,
RSRP_8  INT,
RSRP_9  INT,
RSRP_10 INT,
RSRP_11 INT,
rsrp_sum    float,
rsrp_count    int,
rsrp_weak    int,
rsrp_avg    float,
rsrp_weak_rate    float,
rsrp_weak_l2    int,
rsrp_weak_rate_l2   float
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create table if not exists tpl_mro_mgrs_numofadj_u_day
(
scan_start_time  string,
scan_stop_time  string,
insert_time  string,
ne_type  int,
sum_level  int,
city_id    bigint,
region_id  bigint,
grid_id  string,
latitudeld  float,
longitudeld  float,
latituderu  float,
longituderu  float,
num0diff0  int,
num1diff0  int,
num2diff0  int,
num3diff0  int,
num4diff0  int,
num5diff0  int,
num6diff0  int,
num7diff0  int,
num8diff0  int,
num9diff0  int,
num10diff0  int,
num11diff0  int,
num12diff0  int,
num13diff0  int,
num14diff0  int,
num15diff0  int,
num16diff0  int,
num17diff0  int,
num18diff0  int,
num19diff0  int,
num20diff0  int,
num0diff1  int,
num1diff1  int,
num2diff1  int,
num3diff1  int,
num4diff1  int,
num5diff1  int,
num6diff1  int,
num7diff1  int,
num8diff1  int,
num9diff1  int,
num10diff1  int,
num11diff1  int,
num12diff1  int,
num13diff1  int,
num14diff1  int,
num15diff1  int,
num16diff1  int,
num17diff1  int,
num18diff1  int,
num19diff1  int,
num20diff1  int,
total_num  int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';


create table if not exists tpl_mro_numofadj_freqband_day
(
int_id bigint,
vendor_id int,
name string,
related_enodeb bigint,
enodeb_name string,
enb_id int,
eutrancell_id string,
celllocalid int,
omc_id int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
freqtype int,
num0diff0 int,
num1diff0 int,
num2diff0 int,
num3diff0 int,
num4diff0 int,
num5diff0 int,
num6diff0 int,
num7diff0 int,
num8diff0 int,
num9diff0 int,
num10diff0 int,
num11diff0 int,
num12diff0 int,
num13diff0 int,
num14diff0 int,
num15diff0 int,
num16diff0 int,
num17diff0 int,
num18diff0 int,
num19diff0 int,
num20diff0 int,
num0diff1 int,
num1diff1 int,
num2diff1 int,
num3diff1 int,
num4diff1 int,
num5diff1 int,
num6diff1 int,
num7diff1 int,
num8diff1 int,
num9diff1 int,
num10diff1 int,
num11diff1 int,
num12diff1 int,
num13diff1 int,
num14diff1 int,
num15diff1 int,
num16diff1 int,
num17diff1 int,
num18diff1 int,
num19diff1 int,
num20diff1 int,
total_num int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|'; 

create table if not exists tpl_mro_numofadj_freq_day
(
int_id bigint,
vendor_id int,
name string,
related_enodeb bigint,
enodeb_name string,
enb_id int,
eutrancell_id string,
celllocalid int,
omc_id int,
scan_start_time string,
scan_stop_time string,
insert_time string,
ne_type int,
sum_level int,
freqtype int,
num0diff0 int,
num1diff0 int,
num2diff0 int,
num3diff0 int,
num4diff0 int,
num5diff0 int,
num6diff0 int,
num7diff0 int,
num8diff0 int,
num9diff0 int,
num10diff0 int,
num11diff0 int,
num12diff0 int,
num13diff0 int,
num14diff0 int,
num15diff0 int,
num16diff0 int,
num17diff0 int,
num18diff0 int,
num19diff0 int,
num20diff0 int,
num0diff1 int,
num1diff1 int,
num2diff1 int,
num3diff1 int,
num4diff1 int,
num5diff1 int,
num6diff1 int,
num7diff1 int,
num8diff1 int,
num9diff1 int,
num10diff1 int,
num11diff1 int,
num12diff1 int,
num13diff1 int,
num14diff1 int,
num15diff1 int,
num16diff1 int,
num17diff1 int,
num18diff1 int,
num19diff1 int,
num20diff1 int,
total_num int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|'; 

create  table if not exists tpl_mro_mgrs_rsrp_u_day
(
scan_start_time  string,
scan_stop_time  string,
insert_time  string,
ne_type    int,
sum_level    int,
city_id  bigint,
region_id  bigint,
grid_id  string,
gis_level string,
geohash int,
latitudeld  float,
longitudeld  float,
latituderu  float,
longituderu  float,
rsrp_0  int,
rsrp_1  int,
rsrp_2  int,
rsrp_3  int,
rsrp_4  int,
rsrp_5  int,
rsrp_6  int,
rsrp_7  int,
rsrp_8  int,
rsrp_9  int,
rsrp_10 int,
rsrp_11 int,
rsrp_sum float,
rsrp_count int,
rsrp_weak int,
rsrp_avg  float,
rsrp_weak_rate  float,
rsrp_count_type0    int,
rsrp_weak_type0    int,
rsrp_count_type1    int,
rsrp_weak_type1    int,
rsrp_count_type2    int,
rsrp_weak_type2    int,
rsrp_count_type3    int,
rsrp_weak_type3    int,
rsrp_avg_type0  float,
rsrp_avg_type1  float,
rsrp_avg_type2  float,
rsrp_avg_type3  float,
maxrsrp_0  int,
maxrsrp_1  int,
maxrsrp_2  int,
maxrsrp_3  int,
maxrsrp_4  int,
maxrsrp_5  int,
maxrsrp_6  int,
maxrsrp_7  int,
maxrsrp_8  int,
maxrsrp_9  int,
maxrsrp_10 int,
maxrsrp_11 int,
maxrsrp_sum float,
maxrsrp_count int,
maxrsrp_weak int,
maxrsrp_avg  float,
maxrsrp_weak_rate  float,
maxrsrp_count_type0  int,
maxrsrp_weak_type0  int,
maxrsrp_count_type1  int,
maxrsrp_weak_type1  int,
maxrsrp_count_type2  int,
maxrsrp_weak_type2  int,
maxrsrp_count_type3  int,
maxrsrp_weak_type3  int,
maxrsrp_avg_type0  float,
maxrsrp_avg_type1  float,
maxrsrp_avg_type2  float,
maxrsrp_avg_type3  float,
un_maxrsrp_0  int,
un_maxrsrp_1  int,
un_maxrsrp_2  int,
un_maxrsrp_3  int,
un_maxrsrp_4  int,
un_maxrsrp_5  int,
un_maxrsrp_6  int,
un_maxrsrp_7  int,
un_maxrsrp_8  int,
un_maxrsrp_9  int,
un_maxrsrp_10 int,
un_maxrsrp_11 int,
un_maxrsrp_sum float,
un_maxrsrp_count int,
un_maxrsrp_weak int,
un_maxrsrp_avg  float,
un_maxrsrp_weak_rate  float,
un_maxrsrp_count_type0  int,
un_maxrsrp_weak_type0  int,
un_maxrsrp_count_type1  int,
un_maxrsrp_weak_type1  int,
un_maxrsrp_count_type2  int,
un_maxrsrp_weak_type2  int,
un_maxrsrp_count_type3  int,
un_maxrsrp_weak_type3  int,
un_maxrsrp_avg_type0  float,
un_maxrsrp_avg_type1  float,
un_maxrsrp_avg_type2  float,
un_maxrsrp_avg_type3  float,
te_maxrsrp_0  int,
te_maxrsrp_1  int,
te_maxrsrp_2  int,
te_maxrsrp_3  int,
te_maxrsrp_4  int,
te_maxrsrp_5  int,
te_maxrsrp_6  int,
te_maxrsrp_7  int,
te_maxrsrp_8  int,
te_maxrsrp_9  int,
te_maxrsrp_10 int,
te_maxrsrp_11 int,
te_maxrsrp_sum float,
te_maxrsrp_count int,
te_maxrsrp_weak int,
te_maxrsrp_avg  float,
te_maxrsrp_weak_rate  float,
te_maxrsrp_count_type0  int,
te_maxrsrp_weak_type0  int,
te_maxrsrp_count_type1  int,
te_maxrsrp_weak_type1  int,
te_maxrsrp_count_type2  int,
te_maxrsrp_weak_type2  int,
te_maxrsrp_count_type3  int,
te_maxrsrp_weak_type3  int,
te_maxrrsrp_avg_type0  float,
te_maxrrsrp_avg_type1  float,
te_maxrrsrp_avg_type2  float,
te_maxrrsrp_avg_type3  float,
inter_maxrsrp_0  int,
inter_maxrsrp_1  int,
inter_maxrsrp_2  int,
inter_maxrsrp_3  int,
inter_maxrsrp_4  int,
inter_maxrsrp_5  int,
inter_maxrsrp_6  int,
inter_maxrsrp_7  int,
inter_maxrsrp_8  int,
inter_maxrsrp_9  int,
inter_maxrsrp_10 int,
inter_maxrsrp_11 int,
inter_maxrsrp_sum float,
inter_maxrsrp_count int,
inter_maxrsrp_weak int,
inter_maxrsrp_avg  float,
inter_maxrsrp_weak_rainter  float,
inter_maxrsrp_count_type0  int,
inter_maxrsrp_weak_type0  int,
inter_maxrsrp_count_type1  int,
inter_maxrsrp_weak_type1  int,
inter_maxrsrp_count_type2  int,
inter_maxrsrp_weak_type2  int,
inter_maxrsrp_count_type3  int,
inter_maxrsrp_weak_type3  int,
inter_maxrsrp_avg_type0  float,
inter_maxrsrp_avg_type1  float,
inter_maxrsrp_avg_type2  float,
inter_maxrsrp_avg_type3  float,
rsrp_weak_l2  int,
rsrp_weak_rate_l2  float,
maxrsrp_weak_l2  int,
maxrsrp_weak_rate_l2  float,
un_maxrsrp_weak_l2  int,
un_maxrsrp_weak_rate_l2  float,
te_maxrsrp_weak_l2  int,
te_maxrsrp_weak_rate_l2  float,
inter_maxrsrp_weak_l2  int,
inter_maxrsrp_weak_rate_l2  float,
rsrp_sum_type0     float,
rsrp_sum_type1     float,
rsrp_sum_type2     float,
rsrp_sum_type3      float,
maxrsrp_sum_type0     float,
maxrsrp_sum_type1     float,
maxrsrp_sum_type2     float,
maxrsrp_sum_type3     float,
un_maxrsrp_sum_type0     float,
un_maxrsrp_sum_type1     float,
un_maxrsrp_sum_type2     float,
un_maxrsrp_sum_type3     float,
te_maxrsrp_sum_type0     float,
te_maxrsrp_sum_type1     float,
te_maxrsrp_sum_type2     float,
te_maxrsrp_sum_type3     float,
inter_maxrsrp_sum_type0     float,
inter_maxrsrp_sum_type1     float,
inter_maxrsrp_sum_type2     float,
inter_maxrsrp_sum_type3    float
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists tpl_mro_mgrs_rsrp_sum_day
(
int_id     bigint,
vendor_id     int,
scan_start_time      string,
scan_stop_time      string,
insert_time      string,
ne_type     int,
sum_level     int,
gis_level    int,
rsrp_0     int,
rsrp_1     int,
rsrp_2     int,
rsrp_3     int,
rsrp_4     int,
rsrp_5     int,
rsrp_6     int,
rsrp_7     int,
rsrp_8     int,
rsrp_9     int,
rsrp_10     int,
rsrp_11     int,
rsrp_sum    float,
rsrp_count     bigint,
rsrp_weak     int,
rsrp_avg     float,
rsrp_weak_rate     float,
total_gridnum     int,
effective_gridnum     int,
weak_cover_gridnum     int,
total_eutrnum     int,
weak_grid_eutrnum     int,
weak_eutrnum     int,
maxrsrp_0     int,
maxrsrp_1     int,
maxrsrp_2     int,
maxrsrp_3     int,
maxrsrp_4     int,
maxrsrp_5     int,
maxrsrp_6     int,
maxrsrp_7     int,
maxrsrp_8     int,
maxrsrp_9     int,
maxrsrp_10     int,
maxrsrp_11     int,
maxrsrp_sum    float,
maxrsrp_count     bigint,
maxrsrp_weak     int,
maxrsrp_avg     float,
maxrsrp_weak_rate     float,
maxrsrp_effective_gridnum     int,
maxrsrp_weak_cover_gridnum     int,
maxrsrp_weak_grid_eutrnum     int,
un_maxrsrp_0     int,
un_maxrsrp_1     int,
un_maxrsrp_2     int,
un_maxrsrp_3     int,
un_maxrsrp_4     int,
un_maxrsrp_5     int,
un_maxrsrp_6     int,
un_maxrsrp_7     int,
un_maxrsrp_8     int,
un_maxrsrp_9     int,
un_maxrsrp_10     int,
un_maxrsrp_11     int,
un_maxrsrp_sum    float,
un_maxrsrp_count     bigint,
un_maxrsrp_weak     int,
un_maxrsrp_avg     float,
un_maxrsrp_weak_rate     float,
un_maxrsrp_effective_gridnum     int,
un_maxrsrp_weak_cover_gridnum     int,
un_maxrsrp_weak_grid_eutrnum     int,
te_maxrsrp_0     int,
te_maxrsrp_1     int,
te_maxrsrp_2     int,
te_maxrsrp_3     int,
te_maxrsrp_4     int,
te_maxrsrp_5     int,
te_maxrsrp_6     int,
te_maxrsrp_7     int,
te_maxrsrp_8     int,
te_maxrsrp_9     int,
te_maxrsrp_10     int,
te_maxrsrp_11     int,
te_maxrsrp_sum    float,
te_maxrsrp_count     bigint,
te_maxrsrp_weak     int,
te_maxrsrp_avg     float,
te_maxrsrp_weak_rate     float,
te_maxrsrp_effective_gridnum     int,
te_maxrsrp_weak_cover_gridnum     int,
te_maxrsrp_weak_grid_eutrnum     int,
inter_maxrsrp_0    int,
inter_maxrsrp_1    int,
inter_maxrsrp_2    int,
inter_maxrsrp_3    int,
inter_maxrsrp_4    int,
inter_maxrsrp_5    int,
inter_maxrsrp_6    int,
inter_maxrsrp_7    int,
inter_maxrsrp_8    int,
inter_maxrsrp_9    int,
inter_maxrsrp_10    int,
inter_maxrsrp_11    int,
inter_maxrsrp_sum    int,
inter_maxrsrp_count    bigint,
inter_maxrsrp_weak    int,
inter_maxrsrp_avg     float,
inter_maxrsrp_weak_rate     float,
inter_maxrsrp_effective_gridnum     int,
inter_maxrsrp_weak_cover_gridnum     int,
inter_maxrsrp_weak_grid_eutrnum     int,
rsrp_weak_l2     int,
rsrp_weak_rate_l2     float,
weak_cover_gridnum_l2     int,
weak_grid_eutrnum_l2     int,
weak_eutrnum_l2     int,
maxrsrp_weak_l2     int,
maxrsrp_weak_rate_l2     float,
maxrsrp_weak_cover_gridnum_l2     int,
maxrsrp_weak_grid_eutrnum_l2     int,
un_maxrsrp_weak_l2     int,
un_maxrsrp_weak_rate_l2     float,
un_maxrsrp_effective_gridnum_l2     int,
un_maxrsrp_weak_grid_eutrnum_l2     int,
te_maxrsrp_weak_l2     int,
te_maxrsrp_weak_rate_l2     float,
te_maxrsrp_weak_cover_gridnum_l2     int,
te_maxrsrp_weak_grid_eutrnum_l2     int,
inter_maxrsrp_weak_l2     int,
inter_maxrsrp_weak_rate_l2     float,
inter_maxrsrp_weak_cover_gridnum_l2     int,
inter_maxrsrp_weak_grid_eutrnum_l2     int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

create table if not exists tpl_mro_intefere_day_hn
(
int_id	bigint,
omc_id	int,
vendor_id	int,
m_name	string,
m_int_id	bigint,
m_celllocalid	int,
enodeb_name	string,
related_enodeb	int,
n_name	string,
n_int_id	bigint,
n_celllocalid	int,
enb_id	int,
n_enb_id	int,
scan_start_time	string,
scan_stop_time	string,
scearfcn	int,
scpci	int,
ncearfcn	int,
ncpci	int,
insert_time	string,
ne_type	int,
sum_level	int,
defined_ncell	int,
distince	float,
sc_freq_type	int,
nc_freq_type	int,
interfere_up	float,
interfere_down	float,
nc_interfere_up	float,
nc_interfere_down	float,
nc_interfere_up_freq	float,
nc_interfere_down_freq	float,
sc_total_num	int,
nc_total_num	int
)partitioned by (datepart bigint) row format delimited fields terminated by '\|';

alter table   tpl_mro_adjtdl_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_adjtdl_freq_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_adjtdl_freqband_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_adjtdl_gsm_day   set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_aoa_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_basetable_hour   set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_diff_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_diff_freq_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_diff_freqband_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_grid_ue_hour  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_maxrsrp_eutr_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_numofadj_e_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_phr_eutr_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_rsrp_eutr_day     set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_rsrp_eutr_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_rsrq_eutr_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_sinrd_eutr_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_sinrul_day   set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_rsrprssi_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_rsrpdiff_eutr_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_rsrp_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_rip_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_pol_adj_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_overlap_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_sinru_eutr_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_user_maxrsrp_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_user_phr_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_user_rsrp_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_user_rsrq_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_user_sinrd_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_user_sinru_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_numofadj_eutr_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_maxrsrp_eutr_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_un_mgrs_maxrsrp_eutr_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_te_mgrs_maxrsrp_eutr_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_numofadj_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_numofadj_freqband_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_numofadj_freq_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_rsrp_u_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_rsrp_sum_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_sinrd_user_u_day        set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_sinrd_u_day             set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_phr_user_u_day          set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_phr_u_day               set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_sinru_user_u_day        set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_sinru_u_day             set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_rsrp_user_u_day         set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_rsrq_u_day              set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_mgrs_rsrq_user_u_day         set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_ncrsrp_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_un_ncrsrp_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_te_ncrsrp_day  set serdeproperties ('serialization.null.format' = '');
alter table   tpl_mro_intefere_day_hn  set serdeproperties ('serialization.null.format' = '');






drop table ${houroozie};
drop table if exists tdl_mro_basetable_${seq_id};
drop table if exists tdl_mro_grid_ue_${seq_id};
drop table if exists tdl_mro_maxrsrp_eutr_${seq_id};
drop table if exists tdl_mro_rsrpdiff_eutr_${seq_id};
drop table if exists tdl_mro_overlap_${seq_id};
drop table if exists tdl_mro_numofadj_eutr_${seq_id};
drop table if exists tdl_mro_numofadj_freq_${seq_id};
drop table if exists tdl_mro_numofadj_freqband_${seq_id};
drop table if exists tdl_mro_rsrp_${seq_id};
drop table if exists tdl_mro_rip_${seq_id};
drop table if exists tdl_mro_sinrul_${seq_id};
drop table if exists tdl_mro_aoa_${seq_id};
drop table if exists tdl_mro_diff_${seq_id};
drop table if exists tdl_mro_diff_freq_${seq_id};
drop table if exists tdl_mro_diff_freqband_${seq_id};
drop table if exists tdl_mro_adjtdl_${seq_id};
drop table if exists tdl_mro_adjtdl_freq_${seq_id};
drop table if exists tdl_mro_adjtdl_freqband_${seq_id};
drop table if exists tdl_mro_pol_adj_${seq_id};
drop table if exists tdl_mro_rsrprssi_${seq_id};
drop table if exists tdl_mro_adjtdl_gsm_${seq_id};
drop table if exists tdl_mro_mgrs_numofadj_eutr_${seq_id};
drop table if exists tdl_mro_mgrs_user_rsrp_${seq_id};
drop table if exists tdl_mro_mgrs_user_rsrq_${seq_id};
drop table if exists tdl_mro_mgrs_user_sinrul_${seq_id};
drop table if exists tdl_mro_mgrs_user_phr_${seq_id};
drop table if exists tdl_mro_mgrs_user_sinrdl_${seq_id};
drop table if exists tdl_mro_mgrs_user_maxrsrp_${seq_id};
drop table if exists tdl_mro_mgrs_rsrp_eutr_${seq_id};
drop table if exists tdl_mro_mgrs_rsrp_eutr_u_${seq_id};
drop table if exists tdl_mro_mgrs_rsrq_eutr_u_${seq_id};
drop table if exists tdl_mro_mgrs_sinru_eutr_u_${seq_id};
drop table if exists tdl_mro_mgrs_phr_eutr_u_${seq_id};
drop table if exists tdl_mro_mgrs_sinrd_eutr_u_${seq_id};



set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_adjtdl_day
partition(datepart)
select
null,
omc_id,
vendor_id,
m_name,
m_int_id,
m_celllocalid,
enodeb_name,
related_enodeb,
n_name,
n_int_id,
n_celllocalid,
enb_id,
n_enb_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8122,
1,
distince,
null,
null,
diff0,
diff1,
diff2,
diff3,
diff4,
diff5,
diff6,
diff7,
diff8,
diff9,
diff10,
total_num,
nc_total_num,
nc_sc_overf6,
nc_sc_overf3,
nc_sc_overf12,
nc_sc_overf6_rate,
ncrsrp0,
ncrsrp1,
ncrsrp2,
ncrsrp3,
ncrsrp4,
ncrsrp5,
ncrsrp6,
ncrsrp7,
ncrsrp8,
ncrsrp9,
ncrsrp10,
datepart
from tdl_mro_adjtdl_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_adjtdl_freqband_day
partition(datepart)
select
null,
omc_id,
vendor_id,
m_name,
m_int_id,
m_celllocalid,
enodeb_name,
related_enodeb,
n_name,
n_int_id,
n_celllocalid,
enb_id,
n_enb_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8122,
1,
distince,
null,
null,
diff0,
diff1,
diff2,
diff3,
diff4,
diff5,
diff6,
diff7,
diff8,
diff9,
diff10,
freqtype,
total_num,
nc_total_num,
nc_sc_overf6,
nc_sc_overf3,
nc_sc_overf12,
nc_sc_overf6_rate,
ncrsrp0,
ncrsrp1,
ncrsrp2,
ncrsrp3,
ncrsrp4,
ncrsrp5,
ncrsrp6,
ncrsrp7,
ncrsrp8,
ncrsrp9,
ncrsrp10,
datepart
from tdl_mro_adjtdl_freqband_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_adjtdl_freq_day
partition(datepart)
select
null,
omc_id,
vendor_id,
m_name,
m_int_id,
m_celllocalid,
enodeb_name,
related_enodeb,
n_name,
n_int_id,
n_celllocalid,
enb_id,
n_enb_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8122,
1,
distince,
null,
null,
diff0,
diff1,
diff2,
diff3,
diff4,
diff5,
diff6,
diff7,
diff8,
diff9,
diff10,
freqtype,
total_num,
nc_total_num,
nc_sc_overf6,
nc_sc_overf3,
nc_sc_overf12,
nc_sc_overf6_rate,
ncrsrp0,
ncrsrp1,
ncrsrp2,
ncrsrp3,
ncrsrp4,
ncrsrp5,
ncrsrp6,
ncrsrp7,
ncrsrp8,
ncrsrp9,
ncrsrp10,
datepart
from tdl_mro_adjtdl_freq_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_adjtdl_gsm_day
partition(datepart)
select
null,
omc_id,
vendor_id,
m_name,
m_int_id,
m_celllocalid,
enodeb_name,
related_enodeb,
n_name,
n_int_id,
n_lac,
n_ci,
concat("460-00-",n_lac,"-",n_ci),
ncc,
bcc,
bcch,
enb_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8120,
1,
distince,
null,
null,
rssiov85_rsrpls85,
rssiov90_rsrpls90,
rssiov95_rsrpls95,
total_num,
nc_total_num,
total_num_85,
total_num_90,
total_num_95,
correlation_85,
correlation_90,
correlation_95,
gsm_ave_rsrp_sc,
gsm_ave_rsrp_sc_all,
ncrssi0,
ncrssi1,
ncrssi2,
ncrssi3,
ncrssi4,
ncrssi5,
ncrssi6,
ncrssi7,
ncrssi8,
ncrssi9,
datepart
from tdl_mro_adjtdl_gsm_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_aoa_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
related_enodeb,
enodeb_name,
enb_id,
eutrancell_id,
aoa_000,
aoa_001,
aoa_002,
aoa_003,
aoa_004,
aoa_005,
aoa_006,
aoa_007,
aoa_008,
aoa_009,
aoa_010,
aoa_011,
aoa_012,
aoa_013,
aoa_014,
aoa_015,
aoa_016,
aoa_017,
aoa_018,
aoa_019,
aoa_020,
aoa_021,
aoa_022,
aoa_023,
aoa_024,
aoa_025,
aoa_026,
aoa_027,
aoa_028,
aoa_029,
aoa_030,
aoa_031,
aoa_032,
aoa_033,
aoa_034,
aoa_035,
aoa_036,
aoa_037,
aoa_038,
aoa_039,
aoa_040,
aoa_041,
aoa_042,
aoa_043,
aoa_044,
aoa_045,
aoa_046,
aoa_047,
aoa_048,
aoa_049,
aoa_050,
aoa_051,
aoa_052,
aoa_053,
aoa_054,
aoa_055,
aoa_056,
aoa_057,
aoa_058,
aoa_059,
aoa_060,
aoa_061,
aoa_062,
aoa_063,
aoa_064,
aoa_065,
aoa_066,
aoa_067,
aoa_068,
aoa_069,
aoa_070,
aoa_071,
aoa_072,
aoa_073,
aoa_074,
aoa_075,
aoa_076,
aoa_077,
aoa_078,
aoa_079,
aoa_080,
aoa_081,
aoa_082,
aoa_083,
aoa_084,
aoa_085,
aoa_086,
aoa_087,
aoa_088,
aoa_089,
aoa_090,
aoa_091,
aoa_092,
aoa_093,
aoa_094,
aoa_095,
aoa_096,
aoa_097,
aoa_098,
aoa_099,
aoa_100,
aoa_101,
aoa_102,
aoa_103,
aoa_104,
aoa_105,
aoa_106,
aoa_107,
aoa_108,
aoa_109,
aoa_110,
aoa_111,
aoa_112,
aoa_113,
aoa_114,
aoa_115,
aoa_116,
aoa_117,
aoa_118,
aoa_119,
aoa_120,
aoa_121,
aoa_122,
aoa_123,
aoa_124,
aoa_125,
aoa_126,
aoa_127,
aoa_128,
aoa_129,
aoa_130,
aoa_131,
aoa_132,
aoa_133,
aoa_134,
aoa_135,
aoa_136,
aoa_137,
aoa_138,
aoa_139,
aoa_140,
aoa_141,
aoa_142,
aoa_143,
aoa_144,
aoa_145,
aoa_146,
aoa_147,
aoa_148,
aoa_149,
aoa_150,
aoa_151,
aoa_152,
aoa_153,
aoa_154,
aoa_155,
aoa_156,
aoa_157,
aoa_158,
aoa_159,
aoa_160,
aoa_161,
aoa_162,
aoa_163,
aoa_164,
aoa_165,
aoa_166,
aoa_167,
aoa_168,
aoa_169,
aoa_170,
aoa_171,
aoa_172,
aoa_173,
aoa_174,
aoa_175,
aoa_176,
aoa_177,
aoa_178,
aoa_179,
aoa_180,
aoa_181,
aoa_182,
aoa_183,
aoa_184,
aoa_185,
aoa_186,
aoa_187,
aoa_188,
aoa_189,
aoa_190,
aoa_191,
aoa_192,
aoa_193,
aoa_194,
aoa_195,
aoa_196,
aoa_197,
aoa_198,
aoa_199,
aoa_200,
aoa_201,
aoa_202,
aoa_203,
aoa_204,
aoa_205,
aoa_206,
aoa_207,
aoa_208,
aoa_209,
aoa_210,
aoa_211,
aoa_212,
aoa_213,
aoa_214,
aoa_215,
aoa_216,
aoa_217,
aoa_218,
aoa_219,
aoa_220,
aoa_221,
aoa_222,
aoa_223,
aoa_224,
aoa_225,
aoa_226,
aoa_227,
aoa_228,
aoa_229,
aoa_230,
aoa_231,
aoa_232,
aoa_233,
aoa_234,
aoa_235,
aoa_236,
aoa_237,
aoa_238,
aoa_239,
aoa_240,
aoa_241,
aoa_242,
aoa_243,
aoa_244,
aoa_245,
aoa_246,
aoa_247,
aoa_248,
aoa_249,
aoa_250,
aoa_251,
aoa_252,
aoa_253,
aoa_254,
aoa_255,
aoa_256,
aoa_257,
aoa_258,
aoa_259,
aoa_260,
aoa_261,
aoa_262,
aoa_263,
aoa_264,
aoa_265,
aoa_266,
aoa_267,
aoa_268,
aoa_269,
aoa_270,
aoa_271,
aoa_272,
aoa_273,
aoa_274,
aoa_275,
aoa_276,
aoa_277,
aoa_278,
aoa_279,
aoa_280,
aoa_281,
aoa_282,
aoa_283,
aoa_284,
aoa_285,
aoa_286,
aoa_287,
aoa_288,
aoa_289,
aoa_290,
aoa_291,
aoa_292,
aoa_293,
aoa_294,
aoa_295,
aoa_296,
aoa_297,
aoa_298,
aoa_299,
aoa_300,
aoa_301,
aoa_302,
aoa_303,
aoa_304,
aoa_305,
aoa_306,
aoa_307,
aoa_308,
aoa_309,
aoa_310,
aoa_311,
aoa_312,
aoa_313,
aoa_314,
aoa_315,
aoa_316,
aoa_317,
aoa_318,
aoa_319,
aoa_320,
aoa_321,
aoa_322,
aoa_323,
aoa_324,
aoa_325,
aoa_326,
aoa_327,
aoa_328,
aoa_329,
aoa_330,
aoa_331,
aoa_332,
aoa_333,
aoa_334,
aoa_335,
aoa_336,
aoa_337,
aoa_338,
aoa_339,
aoa_340,
aoa_341,
aoa_342,
aoa_343,
aoa_344,
aoa_345,
aoa_346,
aoa_347,
aoa_348,
aoa_349,
aoa_350,
aoa_351,
aoa_352,
aoa_353,
aoa_354,
aoa_355,
aoa_356,
aoa_357,
aoa_358,
aoa_359,
aoa_360,
aoa_361,
aoa_362,
aoa_363,
aoa_364,
aoa_365,
aoa_366,
aoa_367,
aoa_368,
aoa_369,
aoa_370,
aoa_371,
aoa_372,
aoa_373,
aoa_374,
aoa_375,
aoa_376,
aoa_377,
aoa_378,
aoa_379,
aoa_380,
aoa_381,
aoa_382,
aoa_383,
aoa_384,
aoa_385,
aoa_386,
aoa_387,
aoa_388,
aoa_389,
aoa_390,
aoa_391,
aoa_392,
aoa_393,
aoa_394,
aoa_395,
aoa_396,
aoa_397,
aoa_398,
aoa_399,
aoa_400,
aoa_401,
aoa_402,
aoa_403,
aoa_404,
aoa_405,
aoa_406,
aoa_407,
aoa_408,
aoa_409,
aoa_410,
aoa_411,
aoa_412,
aoa_413,
aoa_414,
aoa_415,
aoa_416,
aoa_417,
aoa_418,
aoa_419,
aoa_420,
aoa_421,
aoa_422,
aoa_423,
aoa_424,
aoa_425,
aoa_426,
aoa_427,
aoa_428,
aoa_429,
aoa_430,
aoa_431,
aoa_432,
aoa_433,
aoa_434,
aoa_435,
aoa_436,
aoa_437,
aoa_438,
aoa_439,
aoa_440,
aoa_441,
aoa_442,
aoa_443,
aoa_444,
aoa_445,
aoa_446,
aoa_447,
aoa_448,
aoa_449,
aoa_450,
aoa_451,
aoa_452,
aoa_453,
aoa_454,
aoa_455,
aoa_456,
aoa_457,
aoa_458,
aoa_459,
aoa_460,
aoa_461,
aoa_462,
aoa_463,
aoa_464,
aoa_465,
aoa_466,
aoa_467,
aoa_468,
aoa_469,
aoa_470,
aoa_471,
aoa_472,
aoa_473,
aoa_474,
aoa_475,
aoa_476,
aoa_477,
aoa_478,
aoa_479,
aoa_480,
aoa_481,
aoa_482,
aoa_483,
aoa_484,
aoa_485,
aoa_486,
aoa_487,
aoa_488,
aoa_489,
aoa_490,
aoa_491,
aoa_492,
aoa_493,
aoa_494,
aoa_495,
aoa_496,
aoa_497,
aoa_498,
aoa_499,
aoa_500,
aoa_501,
aoa_502,
aoa_503,
aoa_504,
aoa_505,
aoa_506,
aoa_507,
aoa_508,
aoa_509,
aoa_510,
aoa_511,
aoa_512,
aoa_513,
aoa_514,
aoa_515,
aoa_516,
aoa_517,
aoa_518,
aoa_519,
aoa_520,
aoa_521,
aoa_522,
aoa_523,
aoa_524,
aoa_525,
aoa_526,
aoa_527,
aoa_528,
aoa_529,
aoa_530,
aoa_531,
aoa_532,
aoa_533,
aoa_534,
aoa_535,
aoa_536,
aoa_537,
aoa_538,
aoa_539,
aoa_540,
aoa_541,
aoa_542,
aoa_543,
aoa_544,
aoa_545,
aoa_546,
aoa_547,
aoa_548,
aoa_549,
aoa_550,
aoa_551,
aoa_552,
aoa_553,
aoa_554,
aoa_555,
aoa_556,
aoa_557,
aoa_558,
aoa_559,
aoa_560,
aoa_561,
aoa_562,
aoa_563,
aoa_564,
aoa_565,
aoa_566,
aoa_567,
aoa_568,
aoa_569,
aoa_570,
aoa_571,
aoa_572,
aoa_573,
aoa_574,
aoa_575,
aoa_576,
aoa_577,
aoa_578,
aoa_579,
aoa_580,
aoa_581,
aoa_582,
aoa_583,
aoa_584,
aoa_585,
aoa_586,
aoa_587,
aoa_588,
aoa_589,
aoa_590,
aoa_591,
aoa_592,
aoa_593,
aoa_594,
aoa_595,
aoa_596,
aoa_597,
aoa_598,
aoa_599,
aoa_600,
aoa_601,
aoa_602,
aoa_603,
aoa_604,
aoa_605,
aoa_606,
aoa_607,
aoa_608,
aoa_609,
aoa_610,
aoa_611,
aoa_612,
aoa_613,
aoa_614,
aoa_615,
aoa_616,
aoa_617,
aoa_618,
aoa_619,
aoa_620,
aoa_621,
aoa_622,
aoa_623,
aoa_624,
aoa_625,
aoa_626,
aoa_627,
aoa_628,
aoa_629,
aoa_630,
aoa_631,
aoa_632,
aoa_633,
aoa_634,
aoa_635,
aoa_636,
aoa_637,
aoa_638,
aoa_639,
aoa_640,
aoa_641,
aoa_642,
aoa_643,
aoa_644,
aoa_645,
aoa_646,
aoa_647,
aoa_648,
aoa_649,
aoa_650,
aoa_651,
aoa_652,
aoa_653,
aoa_654,
aoa_655,
aoa_656,
aoa_657,
aoa_658,
aoa_659,
aoa_660,
aoa_661,
aoa_662,
aoa_663,
aoa_664,
aoa_665,
aoa_666,
aoa_667,
aoa_668,
aoa_669,
aoa_670,
aoa_671,
aoa_672,
aoa_673,
aoa_674,
aoa_675,
aoa_676,
aoa_677,
aoa_678,
aoa_679,
aoa_680,
aoa_681,
aoa_682,
aoa_683,
aoa_684,
aoa_685,
aoa_686,
aoa_687,
aoa_688,
aoa_689,
aoa_690,
aoa_691,
aoa_692,
aoa_693,
aoa_694,
aoa_695,
aoa_696,
aoa_697,
aoa_698,
aoa_699,
aoa_700,
aoa_701,
aoa_702,
aoa_703,
aoa_704,
aoa_705,
aoa_706,
aoa_707,
aoa_708,
aoa_709,
aoa_710,
aoa_711,
aoa_712,
aoa_713,
aoa_714,
aoa_715,
aoa_716,
aoa_717,
aoa_718,
aoa_719,
aoa_sum,
aoa_count,
datepart
from tdl_mro_aoa_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_basetable_hour
partition(datepart,omcpart)
select
omc_id,
vendor_id,
concat("460-00-",enb_id,"-",cid),
m_int_id,
concat("460-00-",n_enb_id,"-",n_cid),
n_int_id,
reporttime,
starttime,
endtime,
enb_id,
cid,
userlabel,
ltescrsrp,
ltencrsrp,
ltescrsrq,
ltencrsrq,
ltescearfcn,
ltescpci,
ltencearfcn,
ltencpci,
ltescrttd,
ltesctadv,
ltescphr,
ltescrip,
ltescaoa,
ltescplrulqci1,
ltescplrulqci2,
ltescplrulqci3,
ltescplrulqci4,
ltescplrulqci5,
ltescplrulqci6,
ltescplrulqci7,
ltescplrulqci8,
ltescplrulqci9,
ltescplrdlqci1,
ltescplrdlqci2,
ltescplrdlqci3,
ltescplrdlqci4,
ltescplrdlqci5,
ltescplrdlqci6,
ltescplrdlqci7,
ltescplrdlqci8,
ltescplrdlqci9,
ltescsinrul,
ltescri1,
ltescri2,
ltescri4,
ltescri8,
ltescpuschprbnum,
ltescpdschprbnum,
ltescbsr,
ltescenbrxtxtimediff,
gsmncellbcch,
gsmncellcarrierrssi,
gsmncellncc,
gsmncellbcc,
tdspccpchrscp,
tdsncelluarfcn,
tdscellparameterid,
mmecode,
mmegroupid,
mmeues1apid,
time_stamp,
concat(enb_id,"-",cid),
overlap_condi1,
overlap_condi2,
is_nrsrp_threshold,
is_effective,
scfreq_type,
ncfreq_type,
datepart,
omcpart
from tdl_mro_basetable_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_diff_day
partition(datepart)
select
m_int_id,
n_int_id,
m_name,
n_name,
enodeb_name,
related_enodeb,
omc_id,
enb_id,
vendor_id,
n_enb_id,
concat(enb_id,"-",m_celllocalid),
m_celllocalid,
concat(n_enb_id,"-",n_celllocalid),
n_celllocalid,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8122,
1,
distince,
null,
null,
sc0diff0,
sc1diff0,
sc2diff0,
sc3diff0,
sc4diff0,
sc5diff0,
sc6diff0,
sc7diff0,
sc8diff0,
sc9diff0,
sc10diff0,
sc0diff1,
sc1diff1,
sc2diff1,
sc3diff1,
sc4diff1,
sc5diff1,
sc6diff1,
sc7diff1,
sc8diff1,
sc9diff1,
sc10diff1,
sc0diff2,
sc1diff2,
sc2diff2,
sc3diff2,
sc4diff2,
sc5diff2,
sc6diff2,
sc7diff2,
sc8diff2,
sc9diff2,
sc10diff2,
sc0diff3,
sc1diff3,
sc2diff3,
sc3diff3,
sc4diff3,
sc5diff3,
sc6diff3,
sc7diff3,
sc8diff3,
sc9diff3,
sc10diff3,
sc0diff4,
sc1diff4,
sc2diff4,
sc3diff4,
sc4diff4,
sc5diff4,
sc6diff4,
sc7diff4,
sc8diff4,
sc9diff4,
sc10diff4,
sc0diff5,
sc1diff5,
sc2diff5,
sc3diff5,
sc4diff5,
sc5diff5,
sc6diff5,
sc7diff5,
sc8diff5,
sc9diff5,
sc10diff5,
sc0diff6,
sc1diff6,
sc2diff6,
sc3diff6,
sc4diff6,
sc5diff6,
sc6diff6,
sc7diff6,
sc8diff6,
sc9diff6,
sc10diff6,
sc0diff7,
sc1diff7,
sc2diff7,
sc3diff7,
sc4diff7,
sc5diff7,
sc6diff7,
sc7diff7,
sc8diff7,
sc9diff7,
sc10diff7,
sc0diff8,
sc1diff8,
sc2diff8,
sc3diff8,
sc4diff8,
sc5diff8,
sc6diff8,
sc7diff8,
sc8diff8,
sc9diff8,
sc10diff8,
sc0diff9,
sc1diff9,
sc2diff9,
sc3diff9,
sc4diff9,
sc5diff9,
sc6diff9,
sc7diff9,
sc8diff9,
sc9diff9,
sc10diff9,
sc0diff10,
sc1diff10,
sc2diff10,
sc3diff10,
sc4diff10,
sc5diff10,
sc6diff10,
sc7diff10,
sc8diff10,
sc9diff10,
sc10diff10,
ncrsrp0,
ncrsrp1,
ncrsrp2,
ncrsrp3,
ncrsrp4,
ncrsrp5,
ncrsrp6,
ncrsrp7,
ncrsrp8,
ncrsrp9,
ncrsrp10,
total_num,
nc_total_num,
datepart
from tdl_mro_diff_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_diff_freqband_day
partition(datepart)
select
m_int_id,
n_int_id,
m_name,
n_name,
enodeb_name,
related_enodeb,
omc_id,
enb_id,
vendor_id,
n_enb_id,
concat(enb_id,"-",m_celllocalid),
m_celllocalid,
concat(n_enb_id,"-",n_celllocalid),
n_celllocalid,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8122,
1,
distince,
null,
null,
freqtype,
sc0diff0,
sc1diff0,
sc2diff0,
sc3diff0,
sc4diff0,
sc5diff0,
sc6diff0,
sc7diff0,
sc8diff0,
sc9diff0,
sc10diff0,
sc0diff1,
sc1diff1,
sc2diff1,
sc3diff1,
sc4diff1,
sc5diff1,
sc6diff1,
sc7diff1,
sc8diff1,
sc9diff1,
sc10diff1,
sc0diff2,
sc1diff2,
sc2diff2,
sc3diff2,
sc4diff2,
sc5diff2,
sc6diff2,
sc7diff2,
sc8diff2,
sc9diff2,
sc10diff2,
sc0diff3,
sc1diff3,
sc2diff3,
sc3diff3,
sc4diff3,
sc5diff3,
sc6diff3,
sc7diff3,
sc8diff3,
sc9diff3,
sc10diff3,
sc0diff4,
sc1diff4,
sc2diff4,
sc3diff4,
sc4diff4,
sc5diff4,
sc6diff4,
sc7diff4,
sc8diff4,
sc9diff4,
sc10diff4,
sc0diff5,
sc1diff5,
sc2diff5,
sc3diff5,
sc4diff5,
sc5diff5,
sc6diff5,
sc7diff5,
sc8diff5,
sc9diff5,
sc10diff5,
sc0diff6,
sc1diff6,
sc2diff6,
sc3diff6,
sc4diff6,
sc5diff6,
sc6diff6,
sc7diff6,
sc8diff6,
sc9diff6,
sc10diff6,
sc0diff7,
sc1diff7,
sc2diff7,
sc3diff7,
sc4diff7,
sc5diff7,
sc6diff7,
sc7diff7,
sc8diff7,
sc9diff7,
sc10diff7,
sc0diff8,
sc1diff8,
sc2diff8,
sc3diff8,
sc4diff8,
sc5diff8,
sc6diff8,
sc7diff8,
sc8diff8,
sc9diff8,
sc10diff8,
sc0diff9,
sc1diff9,
sc2diff9,
sc3diff9,
sc4diff9,
sc5diff9,
sc6diff9,
sc7diff9,
sc8diff9,
sc9diff9,
sc10diff9,
sc0diff10,
sc1diff10,
sc2diff10,
sc3diff10,
sc4diff10,
sc5diff10,
sc6diff10,
sc7diff10,
sc8diff10,
sc9diff10,
sc10diff10,
ncrsrp0,
ncrsrp1,
ncrsrp2,
ncrsrp3,
ncrsrp4,
ncrsrp5,
ncrsrp6,
ncrsrp7,
ncrsrp8,
ncrsrp9,
ncrsrp10,
total_num,
nc_total_num,
datepart
from tdl_mro_diff_freqband_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_diff_freq_day
partition(datepart)
select
m_int_id,
n_int_id,
m_name,
n_name,
enodeb_name,
related_enodeb,
omc_id,
enb_id,
vendor_id,
n_enb_id,
concat(enb_id,"-",m_celllocalid),
m_celllocalid,
concat(n_enb_id,"-",n_celllocalid),
n_celllocalid,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8122,
1,
distince,
null,
null,
freqtype,
sc0diff0,
sc1diff0,
sc2diff0,
sc3diff0,
sc4diff0,
sc5diff0,
sc6diff0,
sc7diff0,
sc8diff0,
sc9diff0,
sc10diff0,
sc0diff1,
sc1diff1,
sc2diff1,
sc3diff1,
sc4diff1,
sc5diff1,
sc6diff1,
sc7diff1,
sc8diff1,
sc9diff1,
sc10diff1,
sc0diff2,
sc1diff2,
sc2diff2,
sc3diff2,
sc4diff2,
sc5diff2,
sc6diff2,
sc7diff2,
sc8diff2,
sc9diff2,
sc10diff2,
sc0diff3,
sc1diff3,
sc2diff3,
sc3diff3,
sc4diff3,
sc5diff3,
sc6diff3,
sc7diff3,
sc8diff3,
sc9diff3,
sc10diff3,
sc0diff4,
sc1diff4,
sc2diff4,
sc3diff4,
sc4diff4,
sc5diff4,
sc6diff4,
sc7diff4,
sc8diff4,
sc9diff4,
sc10diff4,
sc0diff5,
sc1diff5,
sc2diff5,
sc3diff5,
sc4diff5,
sc5diff5,
sc6diff5,
sc7diff5,
sc8diff5,
sc9diff5,
sc10diff5,
sc0diff6,
sc1diff6,
sc2diff6,
sc3diff6,
sc4diff6,
sc5diff6,
sc6diff6,
sc7diff6,
sc8diff6,
sc9diff6,
sc10diff6,
sc0diff7,
sc1diff7,
sc2diff7,
sc3diff7,
sc4diff7,
sc5diff7,
sc6diff7,
sc7diff7,
sc8diff7,
sc9diff7,
sc10diff7,
sc0diff8,
sc1diff8,
sc2diff8,
sc3diff8,
sc4diff8,
sc5diff8,
sc6diff8,
sc7diff8,
sc8diff8,
sc9diff8,
sc10diff8,
sc0diff9,
sc1diff9,
sc2diff9,
sc3diff9,
sc4diff9,
sc5diff9,
sc6diff9,
sc7diff9,
sc8diff9,
sc9diff9,
sc10diff9,
sc0diff10,
sc1diff10,
sc2diff10,
sc3diff10,
sc4diff10,
sc5diff10,
sc6diff10,
sc7diff10,
sc8diff10,
sc9diff10,
sc10diff10,
ncrsrp0,
ncrsrp1,
ncrsrp2,
ncrsrp3,
ncrsrp4,
ncrsrp5,
ncrsrp6,
ncrsrp7,
ncrsrp8,
ncrsrp9,
ncrsrp10,
total_num,
nc_total_num,
datepart
from tdl_mro_diff_freq_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_grid_ue_hour
partition(datepart)
select
uuid,
grid_id1,
latitude_gridld1,
longitude_gridld1,
latitude_gridru1,
longitude_gridru1,
latitude_gridrd1,
longitude_gridrd1,
latitude_gridlu1,
longitude_gridlu1,
geohash1,
grid_id2,
latitude_gridld2,
longitude_gridld2,
latitude_gridru2,
longitude_gridru2,
latitude_gridrd2,
longitude_gridrd2,
latitude_gridlu2,
longitude_gridlu2,
geohash2,
grid_id3,
latitude_gridld3,
longitude_gridld3,
latitude_gridru3,
longitude_gridru3,
latitude_gridrd3,
longitude_gridrd3,
latitude_gridlu3,
longitude_gridlu3,
geohash3,
grid_id4,
latitude_gridld4,
longitude_gridld4,
latitude_gridru4,
longitude_gridru4,
latitude_gridrd4,
longitude_gridrd4,
latitude_gridlu4,
longitude_gridlu4,
geohash4,
grid_id5,
latitude_gridld5,
longitude_gridld5,
latitude_gridru5,
longitude_gridru5,
latitude_gridrd5,
longitude_gridrd5,
latitude_gridlu5,
longitude_gridlu5,
geohash5,
grid_id6,
latitude_gridld6,
longitude_gridld6,
latitude_gridru6,
longitude_gridru6,
latitude_gridrd6,
longitude_gridrd6,
latitude_gridlu6,
longitude_gridlu6,
geohash6,
grid_id7,
latitude_gridld7,
longitude_gridld7,
latitude_gridru7,
longitude_gridru7,
latitude_gridrd7,
longitude_gridrd7,
latitude_gridlu7,
longitude_gridlu7,
geohash7,
grid_id8,
latitude_gridld8,
longitude_gridld8,
latitude_gridru8,
longitude_gridru8,
latitude_gridrd8,
longitude_gridrd8,
latitude_gridlu8,
longitude_gridlu8,
geohash8,
omc_id,
vendor_id,
reporttime,
starttime,
endtime,
enodebid,
userlabel,
mmecode,
mmegroupid,
mmeues1apid,
time_stamp,
enodebid,
celllocalid,
m_int_id,
ltescrsrp,
ltescrsrq,
null,
null,
ltesctadv,
ltescaoa,
ltescearfcn,
ltescpci,
ltencearfcn1,
ltencpci1,
ltencearfcn2,
ltencpci2,
ltencearfcn3,
ltencpci3,
ltencearfcn4,
ltencpci4,
ltencearfcn5,
ltencpci5,
ltencearfcn6,
ltencpci6,
null,
null,
null,
null,
null,
latitude,
longitude,
null,
null,
null,
null,
null,
maxrsrp,
un_maxrsrp,
te_maxrsrp,
ltescsinrul,
ltescphr,
diff_6_num,
diff_10_num,
max_rsrp_earfcn,
max_rsrp_pci,
un_max_rsrp_earfcn,
un_max_rsrp_pci,
te_max_rsrp_earfcn,
te_max_rsrp_pci,
ltescearfcn,
ltescpci,
user_type,
locate_category,
null,
rsrp1,
rsrp2,
rsrp3,
rsrp4,
rsrp5,
rsrp6,
datepart
from tdl_mro_grid_ue_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_intefere_day_hn
partition(datepart)
int_id,  
omc_id,
vendor_id,
m_name,
m_int_id,
m_celllocalid,
enodeb_name,
related_enodeb,
n_name,
n_int_id,
n_celllocalid,
enb_id,
n_enb_id,
scan_start_time,
scan_stop_time,
scearfcn,
scpci,
ncearfcn,
ncpci,
from_unixtime(unix_timestamp()),
8120,
0,
defined_ncell,
distince,
sc_freq_type,
nc_freq_type,
interfere_up,
interfere_down,
nc_interfere_up,
nc_interfere_down,
nc_interfere_up_freq,
nc_interfere_down_freq,
sc_total_num,
nc_total_num,
datepart
from tdl_mro_intefere_${seq_id};set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_maxrsrp_eutr_day
partition(datepart)
select
omc_id,
int_id,
related_enodeb,
enodeb_name,
vendor_id,
enb_id,
concat(enb_id,"-",m_celllocalid),
m_celllocalid,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
maxrsrp_0,
maxrsrp_1,
maxrsrp_2,
maxrsrp_3,
maxrsrp_4,
maxrsrp_5,
maxrsrp_6,
maxrsrp_7,
maxrsrp_8,
maxrsrp_9,
maxrsrp_10,
total_num,
datepart
from tdl_mro_maxrsrp_eutr_${seq_id};
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_maxrsrp_eutr_u_day  
partition( datepart )  
select 
n_int_id,
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time),
from_unixtime(unix_timestamp()),
8105,
1,
max(a.city_id),
max(a.region_id),
null,
null,
max(a.n_enb_id),
max(a.n_celllocalid),
null,
max(a.ncearfcn),
max(a.ncpci),
a.grid_id,
max(a.gis_level),
max(a.geohash),
max(a.latitudeld),
max(a.longitudeld),
max(a.latituderu),
max(a.longituderu),
sum(a.rsrp_0),
sum(a.rsrp_1),
sum(a.rsrp_2),
sum(a.rsrp_3),
sum(a.rsrp_4),
sum(a.rsrp_5),
sum(a.rsrp_6),
sum(a.rsrp_7),
sum(a.rsrp_8),
sum(a.rsrp_9),
sum(a.rsrp_10),
sum(a.rsrp_11),
sum(a.rsrp_sum),
sum(a.rsrp_count),
sum(a.rsrp_weak),
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_sum)/sum(a.rsrp_count) end,
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_weak)/sum(a.rsrp_count) end,
sum(a.rsrp_0+rsrp_1+rsrp_2+rsrp_3),
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_0+rsrp_1+rsrp_2+rsrp_3)/sum(a.rsrp_count) end,
max(a.datepart)
from tdl_mro_mgrs_user_maxrsrp_${seq_id} a 
where nc_netype = 0  
group by a.n_int_id, a.grid_id;    
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_numofadj_e_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
latitudeld,
longitudeld,
latituderu,
longituderu,
num0diff0,
num1diff0,
num2diff0,
num3diff0,
num4diff0,
num5diff0,
num6diff0,
num7diff0,
num8diff0,
num9diff0,
num10diff0,
num11diff0,
num12diff0,
num13diff0,
num14diff0,
num15diff0,
num16diff0,
num17diff0,
num18diff0,
num19diff0,
num20diff0,
num0diff1,
num1diff1,
num2diff1,
num3diff1,
num4diff1,
num5diff1,
num6diff1,
num7diff1,
num8diff1,
num9diff1,
num10diff1,
num11diff1,
num12diff1,
num13diff1,
num14diff1,
num15diff1,
num16diff1,
num17diff1,
num18diff1,
num19diff1,
num20diff1,
total_num,
datepart
from tdl_mro_mgrs_numofadj_eutr_${seq_id};
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;


insert overwrite table tpl_mro_mgrs_numofadj_u_day  
partition(datepart)  
select
concat(substr(min(a.scan_start_time),0,10),' 00:00:00'),
max(a.scan_stop_time),
from_unixtime(unix_timestamp()),
8105,
1,
max(a.city_id),
max(a.region_id),
a.grid_id,
max(a.latitudeld),
max(a.longitudeld),
max(a.latituderu),
max(a.longituderu),
sum(a.num0diff0 ),
sum(a.num1diff0 ),
sum(a.num2diff0 ),
sum(a.num3diff0 ),
sum(a.num4diff0 ),
sum(a.num5diff0 ),
sum(a.num6diff0 ),
sum(a.num7diff0 ),
sum(a.num8diff0 ),
sum(a.num9diff0 ),
sum(a.num10diff0),
sum(a.num11diff0),
sum(a.num12diff0),
sum(a.num13diff0),
sum(a.num14diff0),
sum(a.num15diff0),
sum(a.num16diff0),
sum(a.num17diff0),
sum(a.num18diff0),
sum(a.num19diff0),
sum(a.num20diff0),
sum(a.num0diff1 ),
sum(a.num1diff1 ),
sum(a.num2diff1 ),
sum(a.num3diff1 ),
sum(a.num4diff1 ),
sum(a.num5diff1 ),
sum(a.num6diff1 ),
sum(a.num7diff1 ),
sum(a.num8diff1 ),
sum(a.num9diff1 ),
sum(a.num10diff1),
sum(a.num11diff1),
sum(a.num12diff1),
sum(a.num13diff1),
sum(a.num14diff1),
sum(a.num15diff1),
sum(a.num16diff1),
sum(a.num17diff1),
sum(a.num18diff1),
sum(a.num19diff1),
sum(a.num20diff1),
sum(a.total_num ),
a.datepart
from tdl_mro_mgrs_numofadj_eutr_${seq_id}  a 
group by  a.grid_id,a.datepart;set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_phr_eutr_u_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
latitudeld,
longitudeld,
latituderu,
longituderu,
phr_00,
phr_01,
phr_02,
phr_03,
phr_04,
phr_05,
phr_sum,
phr_count,
datepart
from tdl_mro_mgrs_phr_eutr_u_${seq_id};

set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_phr_user_u_day
partition(datepart)
select 
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
max(GIS_level),
max(GeoHash),
a.User_type,
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(PHR_00)    ,
sum(PHR_01)    ,
sum(PHR_02)    ,
sum(PHR_03)    ,
sum(PHR_04)    ,
sum(PHR_05)    ,
sum(PHR_SUM)    ,
sum(PHR_count),
a.datepart
from tdl_mro_mgrs_user_phr_${seq_id} a
group by a.grid_id,a.User_type,a.datepart ;
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_phr_u_day
partition(datepart)
select 
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
max(GIS_level),
max(GeoHash),
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(PHR_00)    ,
sum(PHR_01)    ,
sum(PHR_02)    ,
sum(PHR_03)    ,
sum(PHR_04)    ,
sum(PHR_05)    ,
sum(PHR_SUM)    ,
sum(PHR_count),
a.datepart
from tdl_mro_mgrs_user_phr_${seq_id}  a
group by a.grid_id,a.datepart ;    set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_rsrp_eutr_day
partition(datepart)
select
int_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
null,
rsrp_0,
rsrp_1,
rsrp_2,
rsrp_3,
rsrp_4,
rsrp_5,
rsrp_6,
rsrp_7,
rsrp_8,
rsrp_9,
rsrp_10,
rsrp_11,
rsrp_sum,
rsrp_count,
rsrp_weak,
rsrp_avg,
rsrp_weak_rate,
total_gridnum,
effective_gridnum,
weak_cover_gridnum,
maxrsrp_0,
maxrsrp_1,
maxrsrp_2,
maxrsrp_3,
maxrsrp_4,
maxrsrp_5,
maxrsrp_6,
maxrsrp_7,
maxrsrp_8,
maxrsrp_9,
maxrsrp_10,
maxrsrp_11,
maxrsrp_sum,
maxrsrp_count,
maxrsrp_weak,
maxrsrp_avg,
maxrsrp_weak_rate,
maxrsrp_effective_gridnum,
maxrsrp_weak_cover_gridnum,
un_maxrsrp_0,
un_maxrsrp_1,
un_maxrsrp_2,
un_maxrsrp_3,
un_maxrsrp_4,
un_maxrsrp_5,
un_maxrsrp_6,
un_maxrsrp_7,
un_maxrsrp_8,
un_maxrsrp_9,
un_maxrsrp_10,
un_maxrsrp_11,
un_maxrsrp_sum,
un_maxrsrp_count,
un_maxrsrp_weak,
un_maxrsrp_avg,
un_maxrsrp_weak_rate,
un_maxrsrp_effective_gridnum,
un_maxrsrp_weak_cover_gridnum,
te_maxrsrp_0,
te_maxrsrp_1,
te_maxrsrp_2,
te_maxrsrp_3,
te_maxrsrp_4,
te_maxrsrp_5,
te_maxrsrp_6,
te_maxrsrp_7,
te_maxrsrp_8,
te_maxrsrp_9,
te_maxrsrp_10,
te_maxrsrp_11,
te_maxrsrp_sum,
te_maxrsrp_count,
te_maxrsrp_weak,
te_maxrsrp_avg,
te_maxrsrp_weak_rate,
te_maxrsrp_effective_gridnum,
te_maxrsrp_weak_cover_gridnum,
inter_maxrsrp_0,
inter_maxrsrp_1,
inter_maxrsrp_2,
inter_maxrsrp_3,
inter_maxrsrp_4,
inter_maxrsrp_5,
inter_maxrsrp_6,
inter_maxrsrp_7,
inter_maxrsrp_8,
inter_maxrsrp_9,
inter_maxrsrp_10,
inter_maxrsrp_11,
inter_maxrsrp_sum,
inter_maxrsrp_count,
inter_maxrsrp_weak,
inter_maxrsrp_avg,
inter_maxrsrp_weak_rate,
inter_maxrsrp_effective_gridnum,
inter_maxrsrp_weak_cover_gridnum,
rsrp_weak_l2,
rsrp_weak_rate_l2,
weak_cover_gridnum_l2,
maxrsrp_weak_l2,
maxrsrp_weak_rate_l2,
maxrsrp_weak_cover_gridnum_l2,
un_maxrsrp_weak_l2,
un_maxrsrp_weak_rate_l2,
un_maxrsrp_weak_cover_gridnum_l2,
te_maxrsrp_weak_l2,
te_maxrsrp_weak_rate_l2,
te_maxrsrp_weak_cover_gridnum_l2,
inter_maxrsrp_weak_l2,
inter_maxrsrp_weak_rate_l2,
inter_maxrsrp_weak_cover_gridnum_l2,
datepart
from tdl_mro_mgrs_rsrp_eutr_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_rsrp_eutr_u_day
partition(datepart)
select
int_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
latitudeld,
longitudeld,
latituderu,
longituderu,
rsrp_0,
rsrp_1,
rsrp_2,
rsrp_3,
rsrp_4,
rsrp_5,
rsrp_6,
rsrp_7,
rsrp_8,
rsrp_9,
rsrp_10,
rsrp_11,
rsrp_sum,
rsrp_count,
rsrp_weak,
rsrp_avg,
rsrp_weak_rate,
rsrp_count_type0,
rsrp_weak_type0,
rsrp_count_type1,
rsrp_weak_type1,
rsrp_count_type2,
rsrp_weak_type2,
rsrp_count_type3,
rsrp_weak_type3,
maxrsrp_0,
maxrsrp_1,
maxrsrp_2,
maxrsrp_3,
maxrsrp_4,
maxrsrp_5,
maxrsrp_6,
maxrsrp_7,
maxrsrp_8,
maxrsrp_9,
maxrsrp_10,
maxrsrp_11,
maxrsrp_sum,
maxrsrp_count,
maxrsrp_weak,
maxrsrp_avg,
maxrsrp_weak_rate,
maxrsrp_count_type0,
maxrsrp_weak_type0,
maxrsrp_count_type1,
maxrsrp_weak_type1,
maxrsrp_count_type2,
maxrsrp_weak_type2,
maxrsrp_count_type3,
maxrsrp_weak_type3,
un_maxrsrp_0,
un_maxrsrp_1,
un_maxrsrp_2,
un_maxrsrp_3,
un_maxrsrp_4,
un_maxrsrp_5,
un_maxrsrp_6,
un_maxrsrp_7,
un_maxrsrp_8,
un_maxrsrp_9,
un_maxrsrp_10,
un_maxrsrp_11,
un_maxrsrp_sum,
un_maxrsrp_count,
un_maxrsrp_weak,
un_maxrsrp_avg,
un_maxrsrp_weak_rate,
un_maxrsrp_count_type0,
un_maxrsrp_weak_type0,
un_maxrsrp_count_type1,
un_maxrsrp_weak_type1,
un_maxrsrp_count_type2,
un_maxrsrp_weak_type2,
un_maxrsrp_count_type3,
un_maxrsrp_weak_type3,
te_maxrsrp_0,
te_maxrsrp_1,
te_maxrsrp_2,
te_maxrsrp_3,
te_maxrsrp_4,
te_maxrsrp_5,
te_maxrsrp_6,
te_maxrsrp_7,
te_maxrsrp_8,
te_maxrsrp_9,
te_maxrsrp_10,
te_maxrsrp_11,
te_maxrsrp_sum,
te_maxrsrp_count,
te_maxrsrp_weak,
te_maxrsrp_avg,
te_maxrsrp_weak_rate,
te_maxrsrp_count_type0,
te_maxrsrp_weak_type0,
te_maxrsrp_count_type1,
te_maxrsrp_weak_type1,
te_maxrsrp_count_type2,
te_maxrsrp_weak_type2,
te_maxrsrp_count_type3,
te_maxrsrp_weak_type3,
inter_maxrsrp_0,
inter_maxrsrp_1,
inter_maxrsrp_2,
inter_maxrsrp_3,
inter_maxrsrp_4,
inter_maxrsrp_5,
inter_maxrsrp_6,
inter_maxrsrp_7,
inter_maxrsrp_8,
inter_maxrsrp_9,
inter_maxrsrp_10,
inter_maxrsrp_11,
inter_maxrsrp_sum,
inter_maxrsrp_count,
inter_maxrsrp_weak,
inter_maxrsrp_avg,
inter_maxrsrp_weak_rate,
inter_maxrsrp_count_type0,
inter_maxrsrp_weak_type0,
inter_maxrsrp_count_type1,
inter_maxrsrp_weak_type1,
inter_maxrsrp_count_type2,
inter_maxrsrp_weak_type2,
inter_maxrsrp_count_type3,
inter_maxrsrp_weak_type3,
rsrp_weak_l2,
rsrp_weak_rate_l2,
maxrsrp_weak_l2,
maxrsrp_weak_rate_l2,
un_maxrsrp_weak_l2,
un_maxrsrp_weak_rate_l2,
te_maxrsrp_weak_l2,
te_maxrsrp_weak_rate_l2,
inter_maxrsrp_weak_l2,
inter_maxrsrp_weak_rate_l2,
datepart
from tdl_mro_mgrs_rsrp_eutr_u_${seq_id};
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_rsrp_user_u_day
partition(datepart)
select
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
a.User_type,
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(a.rsrp_0), 
sum(a.rsrp_1), 
sum(a.rsrp_2), 
sum(a.rsrp_3), 
sum(a.rsrp_4), 
sum(a.rsrp_5), 
sum(a.rsrp_6), 
sum(a.rsrp_7), 
sum(a.rsrp_8), 
sum(a.rsrp_9), 
sum(a.rsrp_10),
sum(a.rsrp_11),
sum(a.rsrp_sum) ,
sum(a.rsrp_count) ,
sum(a.rsrp_weak) ,
a.datepart
from tdl_mro_mgrs_user_rsrp_${seq_id} a
group by a.grid_id,a.User_type,a.datepart ;set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_rsrp_u_day
partition(datepart)
select 
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
max(GIS_level),
max(GeoHash),
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(a.rsrp_0), 
sum(a.rsrp_1), 
sum(a.rsrp_2), 
sum(a.rsrp_3), 
sum(a.rsrp_4), 
sum(a.rsrp_5), 
sum(a.rsrp_6), 
sum(a.rsrp_7), 
sum(a.rsrp_8), 
sum(a.rsrp_9), 
sum(a.rsrp_10),
sum(a.rsrp_11),
sum(a.rsrp_sum) ,
sum(a.rsrp_count) ,
sum(a.rsrp_weak) ,
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_sum)/sum(a.rsrp_count) end ,
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_weak)/sum(a.rsrp_count) end ,
sum(case when a.user_type = 0 then a.rsrp_count else 0 end),
sum(case when a.user_type = 0 then a.rsrp_weak else 0 end),
sum(case when a.user_type = 1 then a.rsrp_count else 0 end),
sum(case when a.user_type = 1 then a.rsrp_weak else 0 end),
sum(case when a.user_type = 2 then a.rsrp_count else 0 end),
sum(case when a.user_type = 2 then a.rsrp_weak else 0 end),
sum(case when a.user_type = 3 then a.rsrp_count else 0 end),
sum(case when a.user_type = 3 then a.rsrp_weak else 0 end),
sum(case when a.user_type = 0 then a.rsrp_count else 0 end)/sum(case when a.user_type = 0 then a.rsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.rsrp_count else 0 end)/sum(case when a.user_type = 1 then a.rsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.rsrp_count else 0 end)/sum(case when a.user_type = 2 then a.rsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.rsrp_count else 0 end)/sum(case when a.user_type = 3 then a.rsrp_sum else 0 end),
sum(a.maxrsrp_0), 
sum(a.maxrsrp_1), 
sum(a.maxrsrp_2), 
sum(a.maxrsrp_3), 
sum(a.maxrsrp_4), 
sum(a.maxrsrp_5), 
sum(a.maxrsrp_6), 
sum(a.maxrsrp_7), 
sum(a.maxrsrp_8), 
sum(a.maxrsrp_9), 
sum(a.maxrsrp_10),
sum(a.maxrsrp_11),
sum(a.maxrsrp_sum) ,
sum(a.maxrsrp_count) ,
sum(a.maxrsrp_weak) ,
case when sum(a.maxrsrp_count)=0 then 0 else sum(a.maxrsrp_sum)/sum(a.maxrsrp_count) end ,
case when sum(a.maxrsrp_count)=0 then 0 else sum(a.maxrsrp_weak)/sum(a.maxrsrp_count) end ,
sum(case when a.user_type = 0 then a.maxrsrp_count else 0 end),
sum(case when a.user_type = 0 then a.maxrsrp_weak else 0 end),
sum(case when a.user_type = 1 then a.maxrsrp_count else 0 end),
sum(case when a.user_type = 1 then a.maxrsrp_weak else 0 end),
sum(case when a.user_type = 2 then a.maxrsrp_count else 0 end),
sum(case when a.user_type = 2 then a.maxrsrp_weak else 0 end),
sum(case when a.user_type = 3 then a.maxrsrp_count else 0 end),
sum(case when a.user_type = 3 then a.maxrsrp_weak else 0 end),
sum(case when a.user_type = 0 then a.maxrsrp_count else 0 end)/sum(case when a.user_type = 0 then a.maxrsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.maxrsrp_count else 0 end)/sum(case when a.user_type = 1 then a.maxrsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.maxrsrp_count else 0 end)/sum(case when a.user_type = 2 then a.maxrsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.maxrsrp_count else 0 end)/sum(case when a.user_type = 3 then a.maxrsrp_sum else 0 end),
sum(a.un_maxrsrp_0), 
sum(a.un_maxrsrp_1), 
sum(a.un_maxrsrp_2), 
sum(a.un_maxrsrp_3), 
sum(a.un_maxrsrp_4), 
sum(a.un_maxrsrp_5), 
sum(a.un_maxrsrp_6), 
sum(a.un_maxrsrp_7), 
sum(a.un_maxrsrp_8), 
sum(a.un_maxrsrp_9), 
sum(a.un_maxrsrp_10),
sum(a.un_maxrsrp_11),
sum(a.un_maxrsrp_sum) ,
sum(a.un_maxrsrp_count) ,
sum(a.un_maxrsrp_weak) ,
case when sum(a.un_maxrsrp_count)=0 then 0 else sum(a.un_maxrsrp_sum)/sum(a.un_maxrsrp_count) end ,
case when sum(a.un_maxrsrp_count)=0 then 0 else sum(a.un_maxrsrp_weak)/sum(a.un_maxrsrp_count) end ,
sum(case when a.user_type = 0 then a.un_maxrsrp_count else 0 end),
sum(case when a.user_type = 0 then a.un_maxrsrp_weak else 0 end),
sum(case when a.user_type = 1 then a.un_maxrsrp_count else 0 end),
sum(case when a.user_type = 1 then a.un_maxrsrp_weak else 0 end),
sum(case when a.user_type = 2 then a.un_maxrsrp_count else 0 end),
sum(case when a.user_type = 2 then a.un_maxrsrp_weak else 0 end),
sum(case when a.user_type = 3 then a.un_maxrsrp_count else 0 end),
sum(case when a.user_type = 3 then a.un_maxrsrp_weak else 0 end),
sum(case when a.user_type = 0 then a.un_maxrsrp_count else 0 end)/sum(case when a.user_type = 0 then a.un_maxrsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.un_maxrsrp_count else 0 end)/sum(case when a.user_type = 1 then a.un_maxrsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.un_maxrsrp_count else 0 end)/sum(case when a.user_type = 2 then a.un_maxrsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.un_maxrsrp_count else 0 end)/sum(case when a.user_type = 3 then a.un_maxrsrp_sum else 0 end),
sum(a.te_maxrsrp_0), 
sum(a.te_maxrsrp_1), 
sum(a.te_maxrsrp_2), 
sum(a.te_maxrsrp_3), 
sum(a.te_maxrsrp_4), 
sum(a.te_maxrsrp_5), 
sum(a.te_maxrsrp_6), 
sum(a.te_maxrsrp_7), 
sum(a.te_maxrsrp_8), 
sum(a.te_maxrsrp_9), 
sum(a.te_maxrsrp_10),
sum(a.te_maxrsrp_11),
sum(a.te_maxrsrp_sum) ,
sum(a.te_maxrsrp_count) ,
sum(a.te_maxrsrp_weak) ,
case when sum(a.te_maxrsrp_count)=0 then 0 else sum(a.te_maxrsrp_sum)/sum(a.te_maxrsrp_count) end ,
case when sum(a.te_maxrsrp_count)=0 then 0 else sum(a.te_maxrsrp_weak)/sum(a.te_maxrsrp_count) end ,
sum(case when a.user_type = 0 then a.te_maxrsrp_count else 0 end),
sum(case when a.user_type = 0 then a.te_maxrsrp_weak else 0 end),
sum(case when a.user_type = 1 then a.te_maxrsrp_count else 0 end),
sum(case when a.user_type = 1 then a.te_maxrsrp_weak else 0 end),
sum(case when a.user_type = 2 then a.te_maxrsrp_count else 0 end),
sum(case when a.user_type = 2 then a.te_maxrsrp_weak else 0 end),
sum(case when a.user_type = 3 then a.te_maxrsrp_count else 0 end),
sum(case when a.user_type = 3 then a.te_maxrsrp_weak else 0 end),
sum(case when a.user_type = 0 then a.te_maxrsrp_count else 0 end)/sum(case when a.user_type = 0 then a.te_maxrsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.te_maxrsrp_count else 0 end)/sum(case when a.user_type = 1 then a.te_maxrsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.te_maxrsrp_count else 0 end)/sum(case when a.user_type = 2 then a.te_maxrsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.te_maxrsrp_count else 0 end)/sum(case when a.user_type = 3 then a.te_maxrsrp_sum else 0 end),
sum(a.inter_maxrsrp_0), 
sum(a.inter_maxrsrp_1), 
sum(a.inter_maxrsrp_2), 
sum(a.inter_maxrsrp_3), 
sum(a.inter_maxrsrp_4), 
sum(a.inter_maxrsrp_5), 
sum(a.inter_maxrsrp_6), 
sum(a.inter_maxrsrp_7), 
sum(a.inter_maxrsrp_8), 
sum(a.inter_maxrsrp_9), 
sum(a.inter_maxrsrp_10),
sum(a.inter_maxrsrp_11),
sum(a.inter_maxrsrp_sum) ,
sum(a.inter_maxrsrp_count) ,
sum(a.inter_maxrsrp_weak) ,
case when sum(a.inter_maxrsrp_count)=0 then 0 else sum(a.inter_maxrsrp_sum)/sum(a.inter_maxrsrp_count) end ,
case when sum(a.inter_maxrsrp_count)=0 then 0 else sum(a.inter_maxrsrp_weak)/sum(a.inter_maxrsrp_count) end ,
sum(case when a.user_type = 0 then a.inter_maxrsrp_count else 0 end),
sum(case when a.user_type = 0 then a.inter_maxrsrp_weak else 0 end),
sum(case when a.user_type = 1 then a.inter_maxrsrp_count else 0 end),
sum(case when a.user_type = 1 then a.inter_maxrsrp_weak else 0 end),
sum(case when a.user_type = 2 then a.inter_maxrsrp_count else 0 end),
sum(case when a.user_type = 2 then a.inter_maxrsrp_weak else 0 end),
sum(case when a.user_type = 3 then a.inter_maxrsrp_count else 0 end),
sum(case when a.user_type = 3 then a.inter_maxrsrp_weak else 0 end),
sum(case when a.user_type = 0 then a.inter_maxrsrp_count else 0 end)/sum(case when a.user_type = 0 then a.inter_maxrsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.inter_maxrsrp_count else 0 end)/sum(case when a.user_type = 1 then a.inter_maxrsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.inter_maxrsrp_count else 0 end)/sum(case when a.user_type = 2 then a.inter_maxrsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.inter_maxrsrp_count else 0 end)/sum(case when a.user_type = 3 then a.inter_maxrsrp_sum else 0 end),
sum(a.rsrp_0+a.rsrp_1+a.rsrp_2+a.rsrp_3) ,
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_0+a.rsrp_1+a.rsrp_2+a.rsrp_3)/sum(a.rsrp_count) end ,
sum(a.maxrsrp_0+a.maxrsrp_1+a.maxrsrp_2+a.maxrsrp_3) ,
case when sum(a.maxrsrp_count)=0 then 0 else sum(a.maxrsrp_0+a.maxrsrp_1+a.maxrsrp_2+a.maxrsrp_3)/sum(a.maxrsrp_count) end ,
sum(a.un_maxrsrp_0+a.un_maxrsrp_1+a.un_maxrsrp_2+a.un_maxrsrp_3) ,
case when sum(a.un_maxrsrp_count)=0 then 0 else sum(a.un_maxrsrp_0+a.un_maxrsrp_1+a.un_maxrsrp_2+a.un_maxrsrp_3)/sum(a.un_maxrsrp_count) end ,
sum(a.te_maxrsrp_0+a.te_maxrsrp_1+a.te_maxrsrp_2+a.te_maxrsrp_3) ,
case when sum(a.te_maxrsrp_count)=0 then 0 else sum(a.te_maxrsrp_0+a.te_maxrsrp_1+a.te_maxrsrp_2+a.te_maxrsrp_3)/sum(a.te_maxrsrp_count) end ,
sum(a.inter_maxrsrp_0+a.inter_maxrsrp_1+a.inter_maxrsrp_2+a.inter_maxrsrp_3) ,
case when sum(a.inter_maxrsrp_count)=0 then 0 else sum(a.inter_maxrsrp_0+a.inter_maxrsrp_1+a.inter_maxrsrp_2+a.inter_maxrsrp_3)/sum(a.inter_maxrsrp_count) end ,
sum(case when a.user_type = 0 then a.rsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.rsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.rsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.rsrp_sum else 0 end),
sum(case when a.user_type = 0 then a.maxrsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.maxrsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.maxrsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.maxrsrp_sum else 0 end),
sum(case when a.user_type = 0 then a.un_maxrsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.un_maxrsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.un_maxrsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.un_maxrsrp_sum else 0 end),
sum(case when a.user_type = 0 then a.te_maxrsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.te_maxrsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.te_maxrsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.te_maxrsrp_sum else 0 end),
sum(case when a.user_type = 0 then a.inter_maxrsrp_sum else 0 end),
sum(case when a.user_type = 1 then a.inter_maxrsrp_sum else 0 end),
sum(case when a.user_type = 2 then a.inter_maxrsrp_sum else 0 end),
sum(case when a.user_type = 3 then a.inter_maxrsrp_sum else 0 end),
a.datepart
from tdl_mro_mgrs_user_rsrp_${seq_id} a
group by a.grid_id,a.datepart ;
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_rsrq_eutr_u_day
partition(datepart)
select
int_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
latitudeld,
longitudeld,
latituderu,
longituderu,
rsrq_00,
rsrq_01,
rsrq_02,
rsrq_03,
rsrq_04,
rsrq_05,
rsrq_06,
rsrq_07,
rsrq_sum,
rsrq_count,
datepart
from tdl_mro_mgrs_rsrq_eutr_u_${seq_id};
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_rsrq_user_u_day
partition(datepart)
select
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
max(GIS_level),
max(GeoHash),
a.User_type,
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(a.rsrq_00), 
sum(a.rsrq_01), 
sum(a.rsrq_02), 
sum(a.rsrq_03), 
sum(a.rsrq_04), 
sum(a.rsrq_05), 
sum(a.rsrq_06), 
sum(a.rsrq_07), 
sum(a.rsrq_sum) ,
sum(a.rsrq_count) ,
a.datepart
from tdl_mro_mgrs_user_rsrq_${seq_id} a
group by a.grid_id,a.User_type,a.datepart ;set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_rsrq_u_day
partition(datepart)
select 
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
max(GIS_level),
max(GeoHash),
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(a.rsrq_00), 
sum(a.rsrq_01), 
sum(a.rsrq_02), 
sum(a.rsrq_03), 
sum(a.rsrq_04), 
sum(a.rsrq_05), 
sum(a.rsrq_06), 
sum(a.rsrq_07), 
sum(a.rsrq_sum) ,
sum(a.rsrq_count) ,
case when sum(a.rsrq_count)=0 then 0 else sum(a.rsrq_sum)/sum(a.rsrq_count) end ,
sum(case when a.user_type = 0 then a.rsrq_count else 0 end),
sum(case when a.user_type = 0 then a.rsrq_sum else 0 end),
sum(case when a.user_type = 0 then a.rsrq_count else 0 end)/sum(case when a.user_type = 0 then a.rsrq_sum else 0 end),
sum(case when a.user_type = 1 then a.rsrq_count else 0 end),
sum(case when a.user_type = 1 then a.rsrq_sum else 0 end),
sum(case when a.user_type = 1 then a.rsrq_count else 0 end)/sum(case when a.user_type = 0 then a.rsrq_sum else 0 end),
sum(case when a.user_type = 2 then a.rsrq_count else 0 end),
sum(case when a.user_type = 2 then a.rsrq_sum else 0 end),
sum(case when a.user_type = 2 then a.rsrq_count else 0 end)/sum(case when a.user_type = 0 then a.rsrq_sum else 0 end),
sum(case when a.user_type = 3 then a.rsrq_count else 0 end),
sum(case when a.user_type = 3 then a.rsrq_sum else 0 end),
sum(case when a.user_type = 3 then a.rsrq_count else 0 end)/sum(case when a.user_type = 0 then a.rsrq_sum else 0 end),
a.datepart
from tdl_mro_mgrs_user_rsrq_${seq_id} a
group by a.grid_id,a.datepart ;set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_sinrd_eutr_u_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id, 
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
latitudeld,
longitudeld,
latituderu,
longituderu,
sinrdl_0,
sinrdl_1,
sinrdl_2,
sinrdl_3,
sinrdl_4,
sinrdl_5,
sinrdl_6,
sinrdl_7,
sinrdl_8,
sinrdl_9,
sinrdl_10,
sinrdl_11,
sinrdl_12,
sinrdl_13,
sinrdl_14,
sinrdl_15,
sinrdl_16,
sinrdl_17,
sinrdl_18,
sinrdl_19,
sinrdl_20,
sinrdl_21,
sinrdl_22,
sinrdl_23,
sinrdl_24,
sinrdl_25,
sinrdl_26,
sinrdl_27,
sinrdl_28,
sinrdl_29,
sinrdl_30,
sinrdl_31,
sinrdl_32,
sinrdl_33,
sinrdl_34,
sinrdl_35,
sinrdl_36,
sinrdl_37,
sinrdl_38,
sinrdl_39,
sinrdl_40,
sinrdl_41,
sinrdl_42,
sinrdl_43,
sinrdl_44,
sinrdl_45,
sinrdl_46,
sinrdl_47,
sinrdl_48,
sinrdl_49,
sinrdl_50,
sinrdl_51,
sinrdl_52,
sinrdl_53,
sinrdl_54,
sinrdl_55,
sinrdl_56,
sinrdl_sum,
sinrdl_count,
datepart
from tdl_mro_mgrs_sinrd_eutr_u_${seq_id};
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_sinrd_user_u_day
partition(datepart)
select 
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
max(GIS_level),
max(GeoHash),
a.User_type,
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(sinrdl_0),
sum(sinrdl_1),
sum(sinrdl_2),
sum(sinrdl_3),
sum(sinrdl_4),
sum(sinrdl_5),
sum(sinrdl_6),
sum(sinrdl_7),
sum(sinrdl_8),
sum(sinrdl_9),
sum(sinrdl_10),
sum(sinrdl_11),
sum(sinrdl_12),
sum(sinrdl_13),
sum(sinrdl_14),
sum(sinrdl_15),
sum(sinrdl_16),
sum(sinrdl_17),
sum(sinrdl_18),
sum(sinrdl_19),
sum(sinrdl_20),
sum(sinrdl_21),
sum(sinrdl_22),
sum(sinrdl_23),
sum(sinrdl_24),
sum(sinrdl_25),
sum(sinrdl_26),
sum(sinrdl_27),
sum(sinrdl_28),
sum(sinrdl_29),
sum(sinrdl_30),
sum(sinrdl_31),
sum(sinrdl_32),
sum(sinrdl_33),
sum(sinrdl_34),
sum(sinrdl_35),
sum(sinrdl_36),
sum(sinrdl_37),
sum(sinrdl_38),
sum(sinrdl_39),
sum(sinrdl_40),
sum(sinrdl_41),
sum(sinrdl_42),
sum(sinrdl_43),
sum(sinrdl_44),
sum(sinrdl_45),
sum(sinrdl_46),
sum(sinrdl_47),
sum(sinrdl_48),
sum(sinrdl_49),
sum(sinrdl_50),
sum(sinrdl_51),
sum(sinrdl_52),
sum(sinrdl_53),
sum(sinrdl_54),
sum(sinrdl_55),
sum(sinrdl_56),
sum(sinrdl_sum),
sum(sinrdl_count),
a.datepart
from tdl_mro_mgrs_user_sinrdl_${seq_id}  a
group by a.grid_id,a.User_type,a.datepart ;  

set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_sinrd_u_day
partition(datepart)
select 
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
max(GIS_level),
max(GeoHash),
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(sinrdl_0),
sum(sinrdl_1),
sum(sinrdl_2),
sum(sinrdl_3),
sum(sinrdl_4),
sum(sinrdl_5),
sum(sinrdl_6),
sum(sinrdl_7),
sum(sinrdl_8),
sum(sinrdl_9),
sum(sinrdl_10),
sum(sinrdl_11),
sum(sinrdl_12),
sum(sinrdl_13),
sum(sinrdl_14),
sum(sinrdl_15),
sum(sinrdl_16),
sum(sinrdl_17),
sum(sinrdl_18),
sum(sinrdl_19),
sum(sinrdl_20),
sum(sinrdl_21),
sum(sinrdl_22),
sum(sinrdl_23),
sum(sinrdl_24),
sum(sinrdl_25),
sum(sinrdl_26),
sum(sinrdl_27),
sum(sinrdl_28),
sum(sinrdl_29),
sum(sinrdl_30),
sum(sinrdl_31),
sum(sinrdl_32),
sum(sinrdl_33),
sum(sinrdl_34),
sum(sinrdl_35),
sum(sinrdl_36),
sum(sinrdl_37),
sum(sinrdl_38),
sum(sinrdl_39),
sum(sinrdl_40),
sum(sinrdl_41),
sum(sinrdl_42),
sum(sinrdl_43),
sum(sinrdl_44),
sum(sinrdl_45),
sum(sinrdl_46),
sum(sinrdl_47),
sum(sinrdl_48),
sum(sinrdl_49),
sum(sinrdl_50),
sum(sinrdl_51),
sum(sinrdl_52),
sum(sinrdl_53),
sum(sinrdl_54),
sum(sinrdl_55),
sum(sinrdl_56),
sum(sinrdl_sum),
sum(sinrdl_count),
a.datepart
from tdl_mro_mgrs_user_sinrdl_${seq_id}  a
group by a.grid_id,a.datepart ;    set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_sinru_eutr_u_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
latitudeld,
longitudeld,
latituderu,
longituderu,
sinrul_0,
sinrul_1,
sinrul_2,
sinrul_3,
sinrul_4,
sinrul_5,
sinrul_6,
sinrul_sum,
sinrul_count,
datepart
from tdl_mro_mgrs_sinru_eutr_u_${seq_id};
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_sinru_user_u_day
partition(datepart)
select 
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
max(GIS_level),
max(GeoHash),
a.User_type,
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(sinrul_0),
sum(sinrul_1),
sum(sinrul_2),
sum(sinrul_3),
sum(sinrul_4),
sum(sinrul_5),
sum(sinrul_6),
sum(sinrul_sum),
sum(sinrul_count),
a.datepart
from tdl_mro_mgrs_user_sinrul_${seq_id} a
group by a.grid_id,a.User_type,a.datepart ;
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_mgrs_sinru_u_day
partition(datepart)
select 
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()) ,
8105,
1,
max(a.city_id) ,
max(region_id) ,
a.grid_id ,
max(GIS_level),
max(GeoHash),
max(a.latitudeld) ,
max(a.longitudeld) ,
max(a.latituderu) ,
max(a.longituderu) ,
sum(sinrul_0),
sum(sinrul_1),
sum(sinrul_2),
sum(sinrul_3),
sum(sinrul_4),
sum(sinrul_5),
sum(sinrul_6),
sum(sinrul_sum),
sum(sinrul_count),
case when sum(a.sinrul_count)=0 then 0 else sum(a.sinrul_sum)/sum(a.sinrul_count) end ,
sum(case when a.user_type = 0 then a.sinrul_count else 0 end),
sum(case when a.user_type = 0 then a.sinrul_sum else 0 end),
sum(case when a.user_type = 0 then a.sinrul_count else 0 end)/sum(case when a.user_type = 0 then a.sinrul_sum else 0 end),
sum(case when a.user_type = 1 then a.sinrul_count else 0 end),
sum(case when a.user_type = 1 then a.sinrul_sum else 0 end),
sum(case when a.user_type = 1 then a.sinrul_count else 0 end)/sum(case when a.user_type = 0 then a.sinrul_sum else 0 end),
sum(case when a.user_type = 2 then a.sinrul_count else 0 end),
sum(case when a.user_type = 2 then a.sinrul_sum else 0 end),
sum(case when a.user_type = 2 then a.sinrul_count else 0 end)/sum(case when a.user_type = 0 then a.sinrul_sum else 0 end),
sum(case when a.user_type = 3 then a.sinrul_count else 0 end),
sum(case when a.user_type = 3 then a.sinrul_sum else 0 end),
sum(case when a.user_type = 3 then a.sinrul_count else 0 end)/sum(case when a.user_type = 0 then a.sinrul_sum else 0 end),
a.datepart
from tdl_mro_mgrs_user_sinrul_${seq_id} a
group by a.grid_id,a.datepart ;

set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_user_maxrsrp_day
partition(datepart)
select
null,
omc_id,
vendor_id,
m_name,
m_int_id,
m_celllocalid,
enb_id,
concat("460-00-",enb_id,"-",m_celllocalid),
m_enodeb_name,
m_related_enodeb,
null,
null,
n_name,
n_int_id,
n_celllocalid,
enb_id,
n_enb_id,
concat("460-00-",n_enb_id,"-",n_celllocalid),
n_enodeb_name,
n_related_enodeb,
scan_start_time,
scan_stop_time,
scearfcn,
scpci,
ncearfcn,
ncpci,
from_unixtime(unix_timestamp()),
8122,
1,
city_id,
region_id,
null,
grid_id,
gis_level,
geohash,
user_type,
latitudeld,
longitudeld,
latituderu,
longituderu,
rsrp_0,
rsrp_1,
rsrp_2,
rsrp_3,
rsrp_4,
rsrp_5,
rsrp_6,
rsrp_7,
rsrp_8,
rsrp_9,
rsrp_10,
rsrp_11,
rsrp_sum,
rsrp_count,
rsrp_weak,
nc_netype,
datepart
from tdl_mro_mgrs_user_maxrsrp_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_user_phr_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
user_type,
latitudeld,
longitudeld,
latituderu,
longituderu,
phr_00,
phr_01,
phr_02,
phr_03,
phr_04,
phr_05,
phr_sum,
phr_count,
datepart
from tdl_mro_mgrs_user_phr_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_user_rsrp_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
user_type,
latitudeld,
longitudeld,
latituderu,
longituderu,
rsrp_0,
rsrp_1,
rsrp_2,
rsrp_3,
rsrp_4,
rsrp_5,
rsrp_6,
rsrp_7,
rsrp_8,
rsrp_9,
rsrp_10,
rsrp_11,
rsrp_sum,
rsrp_count,
rsrp_weak,
maxrsrp_0,
maxrsrp_1,
maxrsrp_2,
maxrsrp_3,
maxrsrp_4,
maxrsrp_5,
maxrsrp_6,
maxrsrp_7,
maxrsrp_8,
maxrsrp_9,
maxrsrp_10,
maxrsrp_11,
maxrsrp_sum,
maxrsrp_count,
maxrsrp_weak,
un_maxrsrp_0,
un_maxrsrp_1,
un_maxrsrp_2,
un_maxrsrp_3,
un_maxrsrp_4,
un_maxrsrp_5,
un_maxrsrp_6,
un_maxrsrp_7,
un_maxrsrp_8,
un_maxrsrp_9,
un_maxrsrp_10,
un_maxrsrp_11,
un_maxrsrp_sum,
un_maxrsrp_count,
un_maxrsrp_weak,
te_maxrsrp_0,
te_maxrsrp_1,
te_maxrsrp_2,
te_maxrsrp_3,
te_maxrsrp_4,
te_maxrsrp_5,
te_maxrsrp_6,
te_maxrsrp_7,
te_maxrsrp_8,
te_maxrsrp_9,
te_maxrsrp_10,
te_maxrsrp_11,
te_maxrsrp_sum,
te_maxrsrp_count,
te_maxrsrp_weak,
inter_maxrsrp_0,
inter_maxrsrp_1,
inter_maxrsrp_2,
inter_maxrsrp_3,
inter_maxrsrp_4,
inter_maxrsrp_5,
inter_maxrsrp_6,
inter_maxrsrp_7,
inter_maxrsrp_8,
inter_maxrsrp_9,
inter_maxrsrp_10,
inter_maxrsrp_11,
inter_maxrsrp_sum,
inter_maxrsrp_count,
inter_maxrsrp_weak,
rsrp_0+rsrp_1+rsrp_2+rsrp_3,
maxrsrp_0+maxrsrp_1+maxrsrp_2+maxrsrp_3,
un_maxrsrp_0+un_maxrsrp_1+un_maxrsrp_2+un_maxrsrp_3,
te_maxrsrp_0+te_maxrsrp_1+te_maxrsrp_2+te_maxrsrp_3,
inter_maxrsrp_0+inter_maxrsrp_1+inter_maxrsrp_2+inter_maxrsrp_3,
datepart
from tdl_mro_mgrs_user_rsrp_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_user_rsrq_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
user_type,
latitudeld,
longitudeld,
latituderu,
longituderu,
rsrq_00,
rsrq_01,
rsrq_02,
rsrq_03,
rsrq_04,
rsrq_05,
rsrq_06,
rsrq_07,
rsrq_sum,
rsrq_count,
datepart
from tdl_mro_mgrs_user_rsrq_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_user_sinrd_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
user_type,
latitudeld,
longitudeld,
latituderu,
longituderu,
sinrdl_0,
sinrdl_1,
sinrdl_2,
sinrdl_3,
sinrdl_4,
sinrdl_5,
sinrdl_6,
sinrdl_7,
sinrdl_8,
sinrdl_9,
sinrdl_10,
sinrdl_11,
sinrdl_12,
sinrdl_13,
sinrdl_14,
sinrdl_15,
sinrdl_16,
sinrdl_17,
sinrdl_18,
sinrdl_19,
sinrdl_20,
sinrdl_21,
sinrdl_22,
sinrdl_23,
sinrdl_24,
sinrdl_25,
sinrdl_26,
sinrdl_27,
sinrdl_28,
sinrdl_29,
sinrdl_30,
sinrdl_31,
sinrdl_32,
sinrdl_33,
sinrdl_34,
sinrdl_35,
sinrdl_36,
sinrdl_37,
sinrdl_38,
sinrdl_39,
sinrdl_40,
sinrdl_41,
sinrdl_42,
sinrdl_43,
sinrdl_44,
sinrdl_45,
sinrdl_46,
sinrdl_47,
sinrdl_48,
sinrdl_49,
sinrdl_50,
sinrdl_51,
sinrdl_52,
sinrdl_53,
sinrdl_54,
sinrdl_55,
sinrdl_56,
sinrdl_sum,
sinrdl_count,
datepart
from tdl_mro_mgrs_user_sinrdl_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_mgrs_user_sinru_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
city_id,
region_id,
related_enodeb,
enodeb_name,
enodeb_id,
eutrancell_id,
concat("460-00-",enodeb_id,"-",eutrancell_id),
earfcn,
pci,
grid_id,
gis_level,
geohash,
user_type,
latitudeld,
longitudeld,
latituderu,
longituderu,
sinrul_0,
sinrul_1,
sinrul_2,
sinrul_3,
sinrul_4,
sinrul_5,
sinrul_6,
sinrul_sum,
sinrul_count,
datepart
from tdl_mro_mgrs_user_sinrul_${seq_id};
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_ncrsrp_day   
partition( datepart )  
select  
max(a.n_int_id),
max(a.omc_id),
max(a.vendor_id),
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()),
8105,
1,
max(a.city_id),
max(a.region_id),
max(a.enb_id),
max(a.m_celllocalid),
sum(a.ncrsrp_0),
sum(a.ncrsrp_1),
sum(a.ncrsrp_2),
sum(a.ncrsrp_3),
sum(a.ncrsrp_4),
sum(a.ncrsrp_5),
sum(a.ncrsrp_6),
sum(a.ncrsrp_7),
sum(a.ncrsrp_8),
sum(a.ncrsrp_9),
sum(a.ncrsrp_10),
sum(a.ncrsrp_11),
sum(a.ncrsrp_12),
sum(a.ncrsrp_13),
sum(a.ncrsrp_14),
sum(a.ncrsrp_15),
sum(a.ncrsrp_16),
sum(a.ncrsrp_17),
sum(a.ncrsrp_18),
sum(a.ncrsrp_19),
sum(a.ncrsrp_20),
sum(a.ncrsrp_21),
sum(a.ncrsrp_22),
sum(a.ncrsrp_23),
sum(a.ncrsrp_24),
sum(a.ncrsrp_25),
sum(a.ncrsrp_26),
sum(a.ncrsrp_27),
sum(a.ncrsrp_28),
sum(a.ncrsrp_29),
sum(a.ncrsrp_30),
sum(a.ncrsrp_31),
sum(a.ncrsrp_32),
sum(a.ncrsrp_33),
sum(a.ncrsrp_34),
sum(a.ncrsrp_35),
sum(a.ncrsrp_36),
sum(a.ncrsrp_37),
sum(a.ncrsrp_38),
sum(a.ncrsrp_39),
sum(a.ncrsrp_40),
sum(a.ncrsrp_41),
sum(a.ncrsrp_42),
sum(a.ncrsrp_43),
sum(a.ncrsrp_44),
sum(a.ncrsrp_45),
sum(a.ncrsrp_46),
sum(a.ncrsrp_47),
sum(a.ncrsrp_48),
sum(a.ncrsrp_49),
sum(a.ncrsrp_50),
sum(a.ncrsrp_51),
sum(a.ncrsrp_52),
sum(a.ncrsrp_53),
sum(a.ncrsrp_54),
sum(a.ncrsrp_55),
sum(a.ncrsrp_56),
sum(a.ncrsrp_57),
sum(a.ncrsrp_58),
sum(a.ncrsrp_59),
sum(a.ncrsrp_60),
sum(a.ncrsrp_61),
sum(a.ncrsrp_62),
sum(a.ncrsrp_63),
sum(a.ncrsrp_64),
sum(a.ncrsrp_65),
sum(a.ncrsrp_66),
sum(a.ncrsrp_67),
sum(a.ncrsrp_68),
sum(a.ncrsrp_69),
sum(a.ncrsrp_70),
sum(a.ncrsrp_71),
sum(a.ncrsrp_72),
sum(a.ncrsrp_73),
sum(a.ncrsrp_74),
sum(a.ncrsrp_75),
sum(a.ncrsrp_76),
sum(a.ncrsrp_77),
sum(a.ncrsrp_78),
sum(a.ncrsrp_79),
sum(a.ncrsrp_80),
sum(a.ncrsrp_81),
sum(a.ncrsrp_82),
sum(a.ncrsrp_83),
sum(a.ncrsrp_84),
sum(a.ncrsrp_85),
sum(a.ncrsrp_86),
sum(a.ncrsrp_87),
sum(a.ncrsrp_88),
sum(a.ncrsrp_89),
sum(a.ncrsrp_90),
sum(a.ncrsrp_91),
sum(a.ncrsrp_92),
sum(a.ncrsrp_93),
sum(a.ncrsrp_94),
sum(a.ncrsrp_95),
sum(a.ncrsrp_96),
sum(a.ncrsrp_97),
sum(a.ncrsrp_sum),
sum(a.ncrsrp_count),
datepart  
from tdl_mro_pol_adj_${seq_id}  a  
where   a.nc_netype = 0  
group by a.n_int_id, a.datepart;
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_numofadj_eutr_day
partition(datepart)
select
int_id,
vendor_id,
name,
related_enodeb,
enodeb_name,
enb_id,
concat(enb_id,"-",celllocalid),
celllocalid,
omc_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
num0diff0,
num1diff0,
num2diff0,
num3diff0,
num4diff0,
num5diff0,
num6diff0,
num7diff0,
num8diff0,
num9diff0,
num10diff0,
num11diff0,
num12diff0,
num13diff0,
num14diff0,
num15diff0,
num16diff0,
num17diff0,
num18diff0,
num19diff0,
num20diff0,
num0diff1,
num1diff1,
num2diff1,
num3diff1,
num4diff1,
num5diff1,
num6diff1,
num7diff1,
num8diff1,
num9diff1,
num10diff1,
num11diff1,
num12diff1,
num13diff1,
num14diff1,
num15diff1,
num16diff1,
num17diff1,
num18diff1,
num19diff1,
num20diff1,
total_num,
datepart
from tdl_mro_numofadj_eutr_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_numofadj_freqband_day
partition(datepart)
select
int_id,
vendor_id,
name,
related_enodeb,
enodeb_name,
enb_id,
concat(enb_id,"-",celllocalid),
celllocalid,
omc_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
freqtype,
num0diff0,
num1diff0,
num2diff0,
num3diff0,
num4diff0,
num5diff0,
num6diff0,
num7diff0,
num8diff0,
num9diff0,
num10diff0,
num11diff0,
num12diff0,
num13diff0,
num14diff0,
num15diff0,
num16diff0,
num17diff0,
num18diff0,
num19diff0,
num20diff0,
num0diff1,
num1diff1,
num2diff1,
num3diff1,
num4diff1,
num5diff1,
num6diff1,
num7diff1,
num8diff1,
num9diff1,
num10diff1,
num11diff1,
num12diff1,
num13diff1,
num14diff1,
num15diff1,
num16diff1,
num17diff1,
num18diff1,
num19diff1,
num20diff1,
total_num,
datepart
from tdl_mro_numofadj_freqband_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_numofadj_freq_day
partition(datepart)
select
int_id,
vendor_id,
name,
related_enodeb,
enodeb_name,
enb_id,
concat(enb_id,"-",celllocalid),
celllocalid,
omc_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
freqtype,
num0diff0,
num1diff0,
num2diff0,
num3diff0,
num4diff0,
num5diff0,
num6diff0,
num7diff0,
num8diff0,
num9diff0,
num10diff0,
num11diff0,
num12diff0,
num13diff0,
num14diff0,
num15diff0,
num16diff0,
num17diff0,
num18diff0,
num19diff0,
num20diff0,
num0diff1,
num1diff1,
num2diff1,
num3diff1,
num4diff1,
num5diff1,
num6diff1,
num7diff1,
num8diff1,
num9diff1,
num10diff1,
num11diff1,
num12diff1,
num13diff1,
num14diff1,
num15diff1,
num16diff1,
num17diff1,
num18diff1,
num19diff1,
num20diff1,
total_num,
datepart
from tdl_mro_numofadj_freq_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_overlap_day
partition(datepart)
select
omc_id,
int_id,
related_enodeb,
enodeb_name,
vendor_id,
enb_id,
concat(enb_id,"-",m_celllocalid),
m_celllocalid,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
diffdbm_0,
diffdbm_1,
diffdbm_2,
diffdbm_3,
diffdbm_4,
diffdbm_5,
diffdbm_6,
diffdbm_7,
diffdbm_8,
diffdbm_9,
diffdbm_10,
diffdbm_11,
diffdbm_12,
diffdbm_13,
diffdbm_14,
diffdbm_15,
diffdbm_16,
diffdbm_17,
diffdbm_18,
diffdbm_19,
diffdbm_20,
diffdbm_21,
diffdbm_22,
diffdbm_23,
diffdbm_24,
diffdbm_25,
diffdbm_26,
diffdbm_27,
diffdbm_28,
diffdbm_29,
diffdbm_30,
diffdbm_31,
diffdbm_32,
diffdbm_33,
diffdbm_34,
diffdbm_35,
diffdbm_36,
diffdbm_37,
diffdbm_38,
diffdbm_39,
diffdbm_40,
diffdbm_41,
diffdbm_42,
datepart
from tdl_mro_overlap_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_pol_adj_day
partition(datepart)
select
null,
omc_id,
vendor_id,
m_name,
m_int_id,
m_celllocalid,
enodeb_name,
related_enodeb,
n_name,
n_int_id,
n_celllocalid,
enb_id,
n_enb_id,
scan_start_time,
scan_stop_time,
scearfcn,
scpci,
ncearfcn,
ncpci,
from_unixtime(unix_timestamp()),
8122,
1,
city_id,
region_id,
null,
tdl_ave_rscp_sc,
tdl_ave_rsrp_sc_all,
tdl_tim,
tdl_ave_rscp_nc,
tdl_tim_alone,
nrsrp_threshold_count,
tdl_tim_max,
tdl_tim_ncrsrp,
tdl_tim1,
tdl_tim2,
tdl_tim3,
tdl_tim4,
tdl_tim5,
tdl_tim6,
tdl_tim1_ncrsrp,
tdl_tim2_ncrsrp,
tdl_tim3_ncrsrp,
tdl_tim4_ncrsrp,
tdl_tim5_ncrsrp,
tdl_tim6_ncrsrp,
overlap_count1,
overlap_count2,
tdl_ave_rscp_nc_overlap_condi1,
tdl_tim1_overlap_condi1,
tdl_tim2_overlap_condi1,
tdl_tim3_overlap_condi1,
tdl_tim4_overlap_condi1,
tdl_tim5_overlap_condi1,
tdl_tim6_overlap_condi1,
tdl_tim1_overlap_condi1_ncrsrp,
tdl_tim2_overlap_condi1_ncrsrp,
tdl_tim3_overlap_condi1_ncrsrp,
tdl_tim4_overlap_condi1_ncrsrp,
tdl_tim5_overlap_condi1_ncrsrp,
tdl_tim6_overlap_condi1_ncrsrp,
tdl_ave_rscp_nc_overlap_condi2,
tdl_tim1_overlap_condi2,
tdl_tim2_overlap_condi2,
tdl_tim3_overlap_condi2,
tdl_tim4_overlap_condi2,
tdl_tim5_overlap_condi2,
tdl_tim6_overlap_condi2,
tdl_tim1_overlap_condi2_ncrsrp,
tdl_tim2_overlap_condi2_ncrsrp,
tdl_tim3_overlap_condi2_ncrsrp,
tdl_tim4_overlap_condi2_ncrsrp,
tdl_tim5_overlap_condi2_ncrsrp,
tdl_tim6_overlap_condi2_ncrsrp,
scrsrp_sum,
total_num,
rsrpdiff_abssum,
rsrpdiff_absavg,
ncrsrp_0,
ncrsrp_1,
ncrsrp_2,
ncrsrp_3,
ncrsrp_4,
ncrsrp_5,
ncrsrp_6,
ncrsrp_7,
ncrsrp_8,
ncrsrp_9,
ncrsrp_10,
ncrsrp_11,
ncrsrp_12,
ncrsrp_13,
ncrsrp_14,
ncrsrp_15,
ncrsrp_16,
ncrsrp_17,
ncrsrp_18,
ncrsrp_19,
ncrsrp_20,
ncrsrp_21,
ncrsrp_22,
ncrsrp_23,
ncrsrp_24,
ncrsrp_25,
ncrsrp_26,
ncrsrp_27,
ncrsrp_28,
ncrsrp_29,
ncrsrp_30,
ncrsrp_31,
ncrsrp_32,
ncrsrp_33,
ncrsrp_34,
ncrsrp_35,
ncrsrp_36,
ncrsrp_37,
ncrsrp_38,
ncrsrp_39,
ncrsrp_40,
ncrsrp_41,
ncrsrp_42,
ncrsrp_43,
ncrsrp_44,
ncrsrp_45,
ncrsrp_46,
ncrsrp_47,
ncrsrp_48,
ncrsrp_49,
ncrsrp_50,
ncrsrp_51,
ncrsrp_52,
ncrsrp_53,
ncrsrp_54,
ncrsrp_55,
ncrsrp_56,
ncrsrp_57,
ncrsrp_58,
ncrsrp_59,
ncrsrp_60,
ncrsrp_61,
ncrsrp_62,
ncrsrp_63,
ncrsrp_64,
ncrsrp_65,
ncrsrp_66,
ncrsrp_67,
ncrsrp_68,
ncrsrp_69,
ncrsrp_70,
ncrsrp_71,
ncrsrp_72,
ncrsrp_73,
ncrsrp_74,
ncrsrp_75,
ncrsrp_76,
ncrsrp_77,
ncrsrp_78,
ncrsrp_79,
ncrsrp_80,
ncrsrp_81,
ncrsrp_82,
ncrsrp_83,
ncrsrp_84,
ncrsrp_85,
ncrsrp_86,
ncrsrp_87,
ncrsrp_88,
ncrsrp_89,
ncrsrp_90,
ncrsrp_91,
ncrsrp_92,
ncrsrp_93,
ncrsrp_94,
ncrsrp_95,
ncrsrp_96,
ncrsrp_97,
ncrsrp_sum,
ncrsrp_count,
nc_netype,
datepart
from tdl_mro_pol_adj_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_rip_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
related_enodeb,
enodeb_name,
enb_id,
eutrancell_id,
rip_00,
rip_01,
rip_02,
rip_03,
rip_04,
rip_05,
rip_06,
rip_07,
rip_08,
rip_09,
rip_10,
rip_11,
rip_12,
rip_13,
rip_14,
rip_15,
rip_16,
rip_17,
rip_18,
rip_19,
rip_20,
rip_21,
rip_22,
rip_23,
rip_24,
rip_25,
rip_26,
rip_27,
rip_28,
rip_29,
rip_30,
rip_31,
rip_32,
rip_33,
rip_34,
rip_35,
rip_36,
rip_37,
rip_38,
rip_39,
rip_40,
rip_41,
rip_42,
rip_43,
rip_44,
rip_45,
rip_46,
rip_47,
rip_48,
rip_49,
rip_50,
rip_51,
rip_52,
rip_53,
rip_54,
rip_55,
rip_56,
rip_57,
rip_58,
rip_59,
rip_60,
rip_61,
rip_62,
rip_63,
rip_64,
rip_65,
rip_66,
rip_67,
rip_68,
rip_69,
rip_70,
rip_71,
rip_72,
rip_73,
rip_74,
rip_75,
rip_76,
rip_77,
rip_78,
rip_79,
rip_80,
rip_81,
rip_82,
rip_83,
rip_84,
rip_85,
rip_86,
rip_87,
rip_88,
rip_89,
rip_90,
rip_91,
rip_92,
rip_93,
rip_94,
rip_95,
rip_96,
rip_97,
rip_98,
rip_99,
rip_100,
rip_101,
rip_102,
rip_103,
rip_sum,
rip_count,
datepart
from tdl_mro_rip_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_rsrpdiff_eutr_day
partition(datepart)
select
omc_id,
int_id,
related_enodeb,
enodeb_name,
vendor_id,
enb_id,
concat(enb_id,"-",m_celllocalid),
m_celllocalid,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
rsrpdiff_0,
rsrpdiff_1,
rsrpdiff_2,
rsrpdiff_3,
rsrpdiff_4,
rsrpdiff_5,
rsrpdiff_6,
rsrpdiff_7,
rsrpdiff_8,
rsrpdiff_9,
rsrpdiff_10,
rsrpdiff_11,
rsrpdiff_12,
rsrpdiff_13,
rsrpdiff_14,
rsrpdiff_15,
rsrpdiff_16,
rsrpdiff_17,
rsrpdiff_18,
rsrpdiff_19,
rsrpdiff_20,
rsrpdiff_21,
rsrpdiff_22,
rsrpdiff_23,
rsrpdiff_24,
rsrpdiff_25,
rsrpdiff_26,
datepart
from tdl_mro_rsrpdiff_eutr_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_rsrprssi_day
partition(datepart)
select
null,
m_int_id,
n_int_id,
m_name,
n_name,
enodeb_name,
related_enodeb,
omc_id,
enb_id,
vendor_id,
concat(enb_id,"-",m_celllocalid),
m_celllocalid,
n_lac,
n_ci,
concat("460-00-",n_lac,"-",n_ci),
scan_start_time,
ncc,
bcc,
bcch,
scan_stop_time,
from_unixtime(unix_timestamp()),
8120,
1,
distince,
null,
null,
sc0rssi0,
sc0rssi1,
sc0rssi2,
sc0rssi3,
sc0rssi4,
sc0rssi5,
sc0rssi6,
sc0rssi7,
sc0rssi8,
sc0rssi9,
sc1rssi0,
sc1rssi1,
sc1rssi2,
sc1rssi3,
sc1rssi4,
sc1rssi5,
sc1rssi6,
sc1rssi7,
sc1rssi8,
sc1rssi9,
sc2rssi0,
sc2rssi1,
sc2rssi2,
sc2rssi3,
sc2rssi4,
sc2rssi5,
sc2rssi6,
sc2rssi7,
sc2rssi8,
sc2rssi9,
sc3rssi0,
sc3rssi1,
sc3rssi2,
sc3rssi3,
sc3rssi4,
sc3rssi5,
sc3rssi6,
sc3rssi7,
sc3rssi8,
sc3rssi9,
sc4rssi0,
sc4rssi1,
sc4rssi2,
sc4rssi3,
sc4rssi4,
sc4rssi5,
sc4rssi6,
sc4rssi7,
sc4rssi8,
sc4rssi9,
sc5rssi0,
sc5rssi1,
sc5rssi2,
sc5rssi3,
sc5rssi4,
sc5rssi5,
sc5rssi6,
sc5rssi7,
sc5rssi8,
sc5rssi9,
sc6rssi0,
sc6rssi1,
sc6rssi2,
sc6rssi3,
sc6rssi4,
sc6rssi5,
sc6rssi6,
sc6rssi7,
sc6rssi8,
sc6rssi9,
sc7rssi0,
sc7rssi1,
sc7rssi2,
sc7rssi3,
sc7rssi4,
sc7rssi5,
sc7rssi6,
sc7rssi7,
sc7rssi8,
sc7rssi9,
sc8rssi0,
sc8rssi1,
sc8rssi2,
sc8rssi3,
sc8rssi4,
sc8rssi5,
sc8rssi6,
sc8rssi7,
sc8rssi8,
sc8rssi9,
sc9rssi0,
sc9rssi1,
sc9rssi2,
sc9rssi3,
sc9rssi4,
sc9rssi5,
sc9rssi6,
sc9rssi7,
sc9rssi8,
sc9rssi9,
sc10rssi0,
sc10rssi1,
sc10rssi2,
sc10rssi3,
sc10rssi4,
sc10rssi5,
sc10rssi6,
sc10rssi7,
sc10rssi8,
sc10rssi9,
ncrssi0,
ncrssi1,
ncrssi2,
ncrssi3,
ncrssi4,
ncrssi5,
ncrssi6,
ncrssi7,
ncrssi8,
ncrssi9,
total_num,
nc_total_num,
total_num_85,
total_num_90,
total_num_95,
datepart
from tdl_mro_rsrprssi_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_rsrp_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
related_enodeb,
enodeb_name,
enb_id,
eutrancell_id,
rsrp_0,
rsrp_1,
rsrp_2,
rsrp_3,
rsrp_4,
rsrp_5,
rsrp_6,
rsrp_7,
rsrp_8,
rsrp_9,
rsrp_10,
rsrp_11,
rsrp_sum,
rsrp_count,
rsrp_avg,
rsrp_lt_f110,
rsrp_lt_f113,
rsrp_lt_f115,
un_maxrsrp_0,
un_maxrsrp_1,
un_maxrsrp_2,
un_maxrsrp_3,
un_maxrsrp_4,
un_maxrsrp_5,
un_maxrsrp_6,
un_maxrsrp_7,
un_maxrsrp_8,
un_maxrsrp_9,
un_maxrsrp_10,
un_maxrsrp_11,
un_maxrsrp_sum,
un_maxrsrp_count,
un_maxrsrp_avg,
un_maxrsrp_lt_f110,
un_maxrsrp_f113,
un_maxrsrp_f115,
te_maxrsrp_0,
te_maxrsrp_1,
te_maxrsrp_2,
te_maxrsrp_3,
te_maxrsrp_4,
te_maxrsrp_5,
te_maxrsrp_6,
te_maxrsrp_7,
te_maxrsrp_8,
te_maxrsrp_9,
te_maxrsrp_10,
te_maxrsrp_11,
te_maxrsrp_sum,
te_maxrsrp_count,
te_maxrsrp_avg,
te_maxrsrp_lt_f110,
te_maxrsrp_f113,
te_maxrsrp_f115,
inter_maxrsrp_0,
inter_maxrsrp_1,
inter_maxrsrp_2,
inter_maxrsrp_3,
inter_maxrsrp_4,
inter_maxrsrp_5,
inter_maxrsrp_6,
inter_maxrsrp_7,
inter_maxrsrp_8,
inter_maxrsrp_9,
inter_maxrsrp_10,
inter_maxrsrp_11,
inter_maxrsrp_sum,
inter_maxrsrp_count,
inter_maxrsrp_avg,
inter_maxrsrp_lt_f110,
inter_maxrsrp_f113,
inter_maxrsrp_f115,
datepart
from tdl_mro_rsrp_${seq_id};
set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partitions.pernode=50000;
set hive.exec.dynamic.partitions.partitions=50000;
set hive.exec.max.created.files=100000;
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000;

insert overwrite table tpl_mro_sinrul_day
partition(datepart)
select
int_id,
omc_id,
vendor_id,
scan_start_time,
scan_stop_time,
from_unixtime(unix_timestamp()),
8105,
1,
related_enodeb,
enodeb_name,
enb_id,
eutrancell_id,
sinrul_00,
sinrul_01,
sinrul_02,
sinrul_03,
sinrul_04,
sinrul_05,
sinrul_06,
sinrul_07,
sinrul_08,
sinrul_09,
sinrul_10,
sinrul_11,
sinrul_12,
sinrul_13,
sinrul_14,
sinrul_15,
sinrul_16,
sinrul_17,
sinrul_18,
sinrul_19,
sinrul_20,
sinrul_21,
sinrul_22,
sinrul_23,
sinrul_24,
sinrul_25,
sinrul_26,
sinrul_27,
sinrul_28,
sinrul_29,
sinrul_30,
sinrul_31,
sinrul_32,
sinrul_33,
sinrul_34,
sinrul_35,
sinrul_36,
sinrul_sum,
sinrul_count,
datepart
from tdl_mro_sinrul_${seq_id};
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_te_mgrs_maxrsrp_eutr_u_day  
partition( datepart )  
select 
n_int_id,
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time),
from_unixtime(unix_timestamp()),
8105,
1,
max(a.city_id),
max(a.region_id),
null,
null,
max(a.n_enb_id),
max(a.n_celllocalid),
null,
max(a.ncearfcn),
max(a.ncpci),
a.grid_id,
max(a.gis_level),
max(a.geohash),
max(a.latitudeld),
max(a.longitudeld),
max(a.latituderu),
max(a.longituderu),
sum(a.rsrp_0),
sum(a.rsrp_1),
sum(a.rsrp_2),
sum(a.rsrp_3),
sum(a.rsrp_4),
sum(a.rsrp_5),
sum(a.rsrp_6),
sum(a.rsrp_7),
sum(a.rsrp_8),
sum(a.rsrp_9),
sum(a.rsrp_10),
sum(a.rsrp_11),
sum(a.rsrp_sum),
sum(a.rsrp_count),
sum(a.rsrp_weak),
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_sum)/sum(a.rsrp_count) end,
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_weak)/sum(a.rsrp_count) end,
sum(a.rsrp_0+rsrp_1+rsrp_2+rsrp_3),
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_0+rsrp_1+rsrp_2+rsrp_3)/sum(a.rsrp_count) end,
a.datepart
from tdl_mro_mgrs_user_maxrsrp_${seq_id} a 
where nc_netype = 2  
group by a.n_int_id, a.grid_id, a.datepart;    
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_te_ncrsrp_day   
partition( datepart )  
select  
max(a.n_int_id),
max(a.omc_id),
max(a.vendor_id),
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()),
8105,
1,
max(a.city_id),
max(a.region_id),
max(a.enb_id),
max(a.m_celllocalid),
sum(a.ncrsrp_0),
sum(a.ncrsrp_1),
sum(a.ncrsrp_2),
sum(a.ncrsrp_3),
sum(a.ncrsrp_4),
sum(a.ncrsrp_5),
sum(a.ncrsrp_6),
sum(a.ncrsrp_7),
sum(a.ncrsrp_8),
sum(a.ncrsrp_9),
sum(a.ncrsrp_10),
sum(a.ncrsrp_11),
sum(a.ncrsrp_12),
sum(a.ncrsrp_13),
sum(a.ncrsrp_14),
sum(a.ncrsrp_15),
sum(a.ncrsrp_16),
sum(a.ncrsrp_17),
sum(a.ncrsrp_18),
sum(a.ncrsrp_19),
sum(a.ncrsrp_20),
sum(a.ncrsrp_21),
sum(a.ncrsrp_22),
sum(a.ncrsrp_23),
sum(a.ncrsrp_24),
sum(a.ncrsrp_25),
sum(a.ncrsrp_26),
sum(a.ncrsrp_27),
sum(a.ncrsrp_28),
sum(a.ncrsrp_29),
sum(a.ncrsrp_30),
sum(a.ncrsrp_31),
sum(a.ncrsrp_32),
sum(a.ncrsrp_33),
sum(a.ncrsrp_34),
sum(a.ncrsrp_35),
sum(a.ncrsrp_36),
sum(a.ncrsrp_37),
sum(a.ncrsrp_38),
sum(a.ncrsrp_39),
sum(a.ncrsrp_40),
sum(a.ncrsrp_41),
sum(a.ncrsrp_42),
sum(a.ncrsrp_43),
sum(a.ncrsrp_44),
sum(a.ncrsrp_45),
sum(a.ncrsrp_46),
sum(a.ncrsrp_47),
sum(a.ncrsrp_48),
sum(a.ncrsrp_49),
sum(a.ncrsrp_50),
sum(a.ncrsrp_51),
sum(a.ncrsrp_52),
sum(a.ncrsrp_53),
sum(a.ncrsrp_54),
sum(a.ncrsrp_55),
sum(a.ncrsrp_56),
sum(a.ncrsrp_57),
sum(a.ncrsrp_58),
sum(a.ncrsrp_59),
sum(a.ncrsrp_60),
sum(a.ncrsrp_61),
sum(a.ncrsrp_62),
sum(a.ncrsrp_63),
sum(a.ncrsrp_64),
sum(a.ncrsrp_65),
sum(a.ncrsrp_66),
sum(a.ncrsrp_67),
sum(a.ncrsrp_68),
sum(a.ncrsrp_69),
sum(a.ncrsrp_70),
sum(a.ncrsrp_71),
sum(a.ncrsrp_72),
sum(a.ncrsrp_73),
sum(a.ncrsrp_74),
sum(a.ncrsrp_75),
sum(a.ncrsrp_76),
sum(a.ncrsrp_77),
sum(a.ncrsrp_78),
sum(a.ncrsrp_79),
sum(a.ncrsrp_80),
sum(a.ncrsrp_81),
sum(a.ncrsrp_82),
sum(a.ncrsrp_83),
sum(a.ncrsrp_84),
sum(a.ncrsrp_85),
sum(a.ncrsrp_86),
sum(a.ncrsrp_87),
sum(a.ncrsrp_88),
sum(a.ncrsrp_89),
sum(a.ncrsrp_90),
sum(a.ncrsrp_91),
sum(a.ncrsrp_92),
sum(a.ncrsrp_93),
sum(a.ncrsrp_94),
sum(a.ncrsrp_95),
sum(a.ncrsrp_96),
sum(a.ncrsrp_97),
sum(a.ncrsrp_sum),
sum(a.ncrsrp_count),
datepart  
from tdl_mro_pol_adj_${seq_id}  a  
where   a.nc_netype = 2  
group by a.n_int_id, a.datepart;
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;
set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_un_mgrs_maxrsrp_eutr_u_day  
partition( datepart )  
select 
n_int_id,
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time),
from_unixtime(unix_timestamp()),
8105,
1,
max(a.city_id),
max(a.region_id),
null,
null,
max(a.n_enb_id),
max(a.n_celllocalid),
null,
max(a.ncearfcn),
max(a.ncpci),
a.grid_id,
max(a.gis_level),
max(a.geohash),
max(a.latitudeld),
max(a.longitudeld),
max(a.latituderu),
max(a.longituderu),
sum(a.rsrp_0),
sum(a.rsrp_1),
sum(a.rsrp_2),
sum(a.rsrp_3),
sum(a.rsrp_4),
sum(a.rsrp_5),
sum(a.rsrp_6),
sum(a.rsrp_7),
sum(a.rsrp_8),
sum(a.rsrp_9),
sum(a.rsrp_10),
sum(a.rsrp_11),
sum(a.rsrp_sum),
sum(a.rsrp_count),
sum(a.rsrp_weak),
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_sum)/sum(a.rsrp_count) end,
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_weak)/sum(a.rsrp_count) end,
sum(a.rsrp_0+rsrp_1+rsrp_2+rsrp_3),
case when sum(a.rsrp_count)=0 then 0 else sum(a.rsrp_0+rsrp_1+rsrp_2+rsrp_3)/sum(a.rsrp_count) end,
a.datepart
from tdl_mro_mgrs_user_maxrsrp_${seq_id} a 
where nc_netype = 1  
group by a.n_int_id, a.grid_id, a.datepart;    
set hive.exec.dynamic.partition=true;  
set hive.exec.dynamic.partition.mode=nonstrict;  
set hive.exec.dynamic.partitions.pernode=50000;  
set hive.exec.dynamic.partitions.partitions=50000;  
set hive.exec.max.created.files=100000; 
set hive.exec.max.dynamic.partitions.pernode=100000;
set hive.exec.max.dynamic.partitions=100000;
set hive.stats.jdbc.timeout=3000;
set hive.metastore.client.socket.timeout=600;
set hive.optimize.index.groupby=true;
set hive.optimize.index.filter=true;
set hive.optimize.sort.dynamic.partition=false;

set mapred.max.split.size=256000000;  
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;  
set hive.merge.mapfiles = true;
set hive.merge.mapredfiles = true;
set hive.merge.size.per.task = 256000000;
set hive.merge.smallfiles.avgsize=16000000 ;

insert overwrite table tpl_mro_un_ncrsrp_day   
partition( datepart )  
select  
max(a.n_int_id),
max(a.omc_id),
max(a.vendor_id),
concat(substr(min(a.scan_start_time),0,10), ' 00:00:00'),
max(a.scan_stop_time) ,
from_unixtime(unix_timestamp()),
8105,
1,
max(a.city_id),
max(a.region_id),
max(a.enb_id),
max(a.m_celllocalid),
sum(a.ncrsrp_0),
sum(a.ncrsrp_1),
sum(a.ncrsrp_2),
sum(a.ncrsrp_3),
sum(a.ncrsrp_4),
sum(a.ncrsrp_5),
sum(a.ncrsrp_6),
sum(a.ncrsrp_7),
sum(a.ncrsrp_8),
sum(a.ncrsrp_9),
sum(a.ncrsrp_10),
sum(a.ncrsrp_11),
sum(a.ncrsrp_12),
sum(a.ncrsrp_13),
sum(a.ncrsrp_14),
sum(a.ncrsrp_15),
sum(a.ncrsrp_16),
sum(a.ncrsrp_17),
sum(a.ncrsrp_18),
sum(a.ncrsrp_19),
sum(a.ncrsrp_20),
sum(a.ncrsrp_21),
sum(a.ncrsrp_22),
sum(a.ncrsrp_23),
sum(a.ncrsrp_24),
sum(a.ncrsrp_25),
sum(a.ncrsrp_26),
sum(a.ncrsrp_27),
sum(a.ncrsrp_28),
sum(a.ncrsrp_29),
sum(a.ncrsrp_30),
sum(a.ncrsrp_31),
sum(a.ncrsrp_32),
sum(a.ncrsrp_33),
sum(a.ncrsrp_34),
sum(a.ncrsrp_35),
sum(a.ncrsrp_36),
sum(a.ncrsrp_37),
sum(a.ncrsrp_38),
sum(a.ncrsrp_39),
sum(a.ncrsrp_40),
sum(a.ncrsrp_41),
sum(a.ncrsrp_42),
sum(a.ncrsrp_43),
sum(a.ncrsrp_44),
sum(a.ncrsrp_45),
sum(a.ncrsrp_46),
sum(a.ncrsrp_47),
sum(a.ncrsrp_48),
sum(a.ncrsrp_49),
sum(a.ncrsrp_50),
sum(a.ncrsrp_51),
sum(a.ncrsrp_52),
sum(a.ncrsrp_53),
sum(a.ncrsrp_54),
sum(a.ncrsrp_55),
sum(a.ncrsrp_56),
sum(a.ncrsrp_57),
sum(a.ncrsrp_58),
sum(a.ncrsrp_59),
sum(a.ncrsrp_60),
sum(a.ncrsrp_61),
sum(a.ncrsrp_62),
sum(a.ncrsrp_63),
sum(a.ncrsrp_64),
sum(a.ncrsrp_65),
sum(a.ncrsrp_66),
sum(a.ncrsrp_67),
sum(a.ncrsrp_68),
sum(a.ncrsrp_69),
sum(a.ncrsrp_70),
sum(a.ncrsrp_71),
sum(a.ncrsrp_72),
sum(a.ncrsrp_73),
sum(a.ncrsrp_74),
sum(a.ncrsrp_75),
sum(a.ncrsrp_76),
sum(a.ncrsrp_77),
sum(a.ncrsrp_78),
sum(a.ncrsrp_79),
sum(a.ncrsrp_80),
sum(a.ncrsrp_81),
sum(a.ncrsrp_82),
sum(a.ncrsrp_83),
sum(a.ncrsrp_84),
sum(a.ncrsrp_85),
sum(a.ncrsrp_86),
sum(a.ncrsrp_87),
sum(a.ncrsrp_88),
sum(a.ncrsrp_89),
sum(a.ncrsrp_90),
sum(a.ncrsrp_91),
sum(a.ncrsrp_92),
sum(a.ncrsrp_93),
sum(a.ncrsrp_94),
sum(a.ncrsrp_95),
sum(a.ncrsrp_96),
sum(a.ncrsrp_97),
sum(a.ncrsrp_sum),
sum(a.ncrsrp_count),
datepart  
from tdl_mro_pol_adj_${seq_id}  a  
where   a.nc_netype = 1  
group by a.n_int_id, a.datepart;
